Thank you for installing {{ .Chart.Name }}!

Your Signal desktop application has been deployed as a StatefulSet.

{{- if .Values.auth.enabled }}

üîí KEYCLOAK IAM DEPLOYED
========================
Keycloak is running and available for identity management.

To access Keycloak Admin Console:
  kubectl port-forward -n {{ .Release.Namespace }} svc/{{ .Release.Name }}-keycloak 8080:8080

  Then visit: http://localhost:8080

  Admin credentials:
    Username: {{ .Values.keycloak.auth.adminUser }}
    Password: {{ .Values.keycloak.auth.adminPassword }}

NOTE: Keycloak is NOT currently protecting VNC access.
      VNC is accessible without authentication.
      To add authentication: Deploy oauth2-proxy or similar OIDC proxy.

{{- end }}

To access Signal:

{{- if .Values.ingress.enabled }}

1. Via Ingress:
{{- range .Values.ingress.hosts }}
   http{{ if $.Values.ingress.tls }}s{{ end }}://{{ .host }}
{{- end }}
{{- else if eq .Values.service.type "LoadBalancer" }}

1. Get the LoadBalancer IP:
   kubectl get svc {{ include "ghostwire.fullname" . }} -n {{ .Release.Namespace }}

2. Access Signal VNC interface at:
   http://<EXTERNAL-IP>:{{ .Values.service.port }}

{{- else if eq .Values.service.type "NodePort" }}

1. Get the Node IP and Port:
   export NODE_PORT=$(kubectl get svc {{ include "ghostwire.fullname" . }} -n {{ .Release.Namespace }} -o jsonpath='{.spec.ports[0].nodePort}')
   export NODE_IP=$(kubectl get nodes -o jsonpath='{.items[0].status.addresses[0].address}')

2. Access Signal VNC interface at:
   http://$NODE_IP:$NODE_PORT

{{- else }}

1. Port forward to access locally:
   kubectl port-forward -n {{ .Release.Namespace }} svc/{{ include "ghostwire.fullname" . }} {{ .Values.service.port }}:{{ .Values.service.port }}

2. Access Signal VNC interface at:
   http://localhost:{{ .Values.service.port }}

{{- end }}

3. VNC login credentials:
   Username: kasm_user
   Password: {{ range .Values.env }}{{ if eq .name "VNC_PW" }}{{ .value }}{{ end }}{{ end }}

IMPORTANT NOTES:
{{- if .Values.auth.enabled }}
- ‚ö†Ô∏è  Keycloak admin password should be changed for production
- ‚ö†Ô∏è  PostgreSQL password should be changed for production
- Keycloak realm 'ghostwire' must be created manually or via automation
- VNC is currently NOT protected by Keycloak - add oauth2-proxy for OIDC authentication
{{- end }}
- Change the VNC password in values.yaml before deploying to production
- Signal will persist data to a PersistentVolume
- First time setup will require linking to your phone number
- The StatefulSet ensures your Signal data persists across pod restarts

To view logs:
  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name={{ include "ghostwire.name" . }} -f

To view the StatefulSet:
  kubectl get statefulset {{ include "ghostwire.fullname" . }} -n {{ .Release.Namespace }}

To view the PVC:
  kubectl get pvc -n {{ .Release.Namespace }} -l app.kubernetes.io/name={{ include "ghostwire.name" . }}
