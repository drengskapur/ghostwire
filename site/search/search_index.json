{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Ghostwire","text":"<p>Ghostwire runs Signal Desktop in Kubernetes with browser-based VNC access and persistent storage. It's designed to integrate with your existing infrastructure rather than duplicate it.</p>"},{"location":"#what-it-does","title":"What It Does","text":"<p>Deploy a StatefulSet that runs Signal Desktop in a container. Access it through your browser via VNC. Your conversations persist across pod restarts through a PVC.</p> <p>The chart handles the application runtime. Your platform handles authentication, TLS, and ingress\u2014the things it's already configured to do.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># Create a cluster\nk3d cluster create\n\n# Install the chart\nhelm install ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --version 0.0.0-latest \\\n  --create-namespace -n ghostwire\n\n# Wait for ready\nkubectl wait --for=condition=ready pod \\\n  -l app.kubernetes.io/name=ghostwire -n ghostwire --timeout=300s\n\n# Access via port-forward\nkubectl port-forward -n ghostwire svc/ghostwire 6901:6901\n</code></pre> <p>Open <code>http://localhost:6901?keyboard=1</code> in your browser.</p>"},{"location":"#why-this-approach","title":"Why This Approach","text":"<p>Most VNC-in-Kubernetes solutions bundle authentication, TLS termination, and security controls. This creates configuration overlap and conflicts with platform-level tools.</p> <p>Ghostwire delegates infrastructure concerns to infrastructure:</p> <ul> <li>Authentication through OAuth2-proxy or your identity provider</li> <li>TLS through cert-manager</li> <li>Routing through your existing ingress controller</li> </ul> <p>The result is less redundant configuration and cleaner integration with what you already run.</p>"},{"location":"#documentation","title":"Documentation","text":"<p>Getting Started</p> <ul> <li>Installation \u2014 Prerequisites and Helm installation</li> <li>Quick Start \u2014 First deployment walkthrough</li> <li>Configuration \u2014 Key Helm values and customization</li> </ul> <p>User Guide</p> <ul> <li>Deployment Strategies \u2014 StatefulSet behavior and rollouts</li> <li>Infrastructure Integration \u2014 OAuth2, ingress, cert-manager patterns</li> <li>Persistence \u2014 Volume configuration and data management</li> </ul> <p>Architecture</p> <ul> <li>Container Runtime \u2014 How Signal Desktop runs in the container</li> <li>Security Model \u2014 Security considerations and boundaries</li> </ul> <p>Operations</p> <ul> <li>Monitoring \u2014 Health checks and observability</li> <li>Troubleshooting \u2014 Common issues and debugging</li> <li>Upgrades \u2014 Version upgrades and rollbacks</li> </ul>"},{"location":"#license","title":"License","text":"<p>The Helm chart is Apache License 2.0. Signal Desktop is AGPLv3 (Signal Messenger LLC). Kasm container images are MIT License (Kasm Technologies Inc).</p> <p>Signal Messenger LLC and Kasm Technologies Inc do not endorse this project.</p>"},{"location":"brand/","title":"Ghostwire Brand Identity","text":"<p>\"The Stealth Wire\" - Professional minimalism with tactical edge.</p>"},{"location":"brand/#core-concept","title":"Core Concept","text":"<p>A single continuous glowing wire/line that forms an abstract ghost silhouette integrated with Signal's communication wave pattern, rendered in electric blue against pure black.</p> <p>Think: \"One-line drawing\" art style meets cybersecurity visualization.</p>"},{"location":"brand/#brand-philosophy","title":"Brand Philosophy","text":"<p>The best technical brands understand that constraint breeds memorability. Ghostwire is:</p> <ul> <li>Infrastructure (invisible by design)</li> <li>Security (trust through transparency)</li> <li>Cloud-native (elegance in simplicity)</li> </ul> <p>A single glowing wire forming a ghost is:</p> <ul> <li>Reductive (one element = infrastructure principle)</li> <li>Transparent (literally see-through = secure)</li> <li>Minimal (cloud-native elegance)</li> </ul> <p>This isn't just a logo. It's a visual theorem proving your architectural philosophy.</p>"},{"location":"brand/#why-this-works","title":"Why This Works","text":""},{"location":"brand/#1-open-source-positioning","title":"1. Open Source Positioning","text":"<ul> <li>GitHub's top OSS projects (Kubernetes, Docker, Terraform) use simple, bold, memorable icons</li> <li>Overly complex 3D renders don't scale well across contexts (favicon, terminal, docs)</li> <li>Single iconic shape = instant recognition at any size</li> </ul>"},{"location":"brand/#2-technical-credibility","title":"2. Technical Credibility","text":"<ul> <li>Minimalist geometric design signals engineering excellence (not marketing fluff)</li> <li>The DevOps/cloud-native community respects restraint and precision</li> <li>References Signal's established brand without copying it</li> </ul>"},{"location":"brand/#3-the-ghostwire-name-brilliance","title":"3. The \"Ghostwire\" Name Brilliance","text":"<ul> <li>A single wire that IS the ghost perfectly encapsulates the name</li> <li>\"Wire\" = network/communication infrastructure</li> <li>\"Ghost\" = invisible, ephemeral, secure</li> <li>The metaphor is literal and visual</li> </ul>"},{"location":"brand/#4-badass-factor","title":"4. Badass Factor","text":"<ul> <li>Tron-like glowing line aesthetic = inherently cool and technical</li> <li>Dark background = serious, no-nonsense, operator-grade</li> <li>Electric blue glow = energy, power, cutting-edge</li> <li>Simplicity = confidence (doesn't need to try hard)</li> </ul>"},{"location":"brand/#5-practical-execution","title":"5. Practical Execution","text":"<ul> <li>Works perfectly at 16x16px (favicon) and 4K (hero)</li> <li>Looks sharp on light mode (reverse to dark line) AND dark mode</li> <li>Easy to animate (line drawing animation, glow pulse)</li> <li>Can be SVG = scales infinitely, tiny file size</li> <li>Easy to reproduce/remix for community derivatives</li> </ul>"},{"location":"brand/#color-palette","title":"Color Palette","text":""},{"location":"brand/#primary-colors","title":"Primary Colors","text":"<ul> <li>Electric Blue: <code>#00D9FF</code> - The wire, primary brand color, icon glow</li> <li>Deep Black: <code>#000000</code> - Pure black background for maximum contrast</li> <li>Bright Cyan: <code>#00FFE5</code> - Title text, highlight accent (brighter than primary)</li> </ul>"},{"location":"brand/#secondary-brand-accents","title":"Secondary (Brand Accents)","text":"<ul> <li>Signal Blue: <code>#3A76F0</code> - For Signal messaging references, outer glow layers</li> <li>Kubernetes Blue: <code>#326CE5</code> - For infrastructure elements, subtle details</li> <li>Muted Cyan: <code>#5A8EA8</code> - Tagline/supporting text (50% darker than primary)</li> </ul>"},{"location":"brand/#atmospheric-depth","title":"Atmospheric &amp; Depth","text":"<ul> <li>Dark Navy: <code>#0A0E27</code> - Vignette backgrounds, radial gradient edges, subtle depth</li> <li>Charcoal: <code>#1A1A1A</code> - Text on light backgrounds (rarely used)</li> <li>Soft Cyan: <code>#88E5FF</code> - Secondary highlights, hover states, UI accents</li> </ul>"},{"location":"brand/#lighting-effects-professional-enhancement","title":"Lighting &amp; Effects (Professional Enhancement)","text":"<ul> <li>Pure White: <code>#FFFFFF</code> - Specular highlights, hotspot cores (15-20% opacity)</li> <li>Glow Blue: <code>#3A76F0</code> - Outer glow effect layers (60% opacity, 12-20px blur)</li> <li>Atmospheric Blue: <code>#001428</code> - Background fog/haze (5% opacity for depth)</li> </ul>"},{"location":"brand/#contrast-hierarchy-guidelines","title":"Contrast Hierarchy Guidelines","text":"<ul> <li>Focal points (icons, primary CTAs): Use <code>#00FFE5</code> (brightest)</li> <li>Primary text (titles, headers): Use <code>#00D9FF</code> (standard)</li> <li>Secondary text (taglines, body): Use <code>#5A8EA8</code> (muted, 40% contrast difference)</li> <li>Backgrounds: Use <code>#000000</code> \u2192 <code>#0A0E27</code> radial gradient for vignette effect</li> </ul>"},{"location":"brand/#visual-specifications","title":"Visual Specifications","text":""},{"location":"brand/#icon-512x512px-minimum","title":"Icon (512x512px minimum)","text":"<p>Composition:</p> <pre><code>Pure black background (#000000)\nSingle continuous electric blue wire (#00D9FF with bloom)\nLine weight: 3-4px, rounded caps/joins\n\nThe wire draws:\n- A simplified ghost silhouette (rounded head, flowing bottom)\n- Integrated Signal wave pattern (3 ascending dots/lines) in chest area\n- Subtle Kubernetes hexagon formed by negative space\n- Terminus: wire ends spark/fray into particles at bottom\n\nStyle: Clean vector line art with outer glow (20px, 60% opacity)\n</code></pre> <p>Technical specs:</p> <ul> <li>Format: SVG (primary), PNG with transparency (fallback)</li> <li>Minimum size: 512x512px</li> <li>Recognizable at: 16x16px (favicon)</li> <li>Works on: Both light and dark backgrounds</li> <li>Edge glow: 20px outer glow, 60% opacity, #3A76F0</li> </ul>"},{"location":"brand/#hero-banner-1280x640px","title":"Hero Banner (1280x640px)","text":"<p>Scene:</p> <pre><code>The wire ghost centered, larger scale\nBackground: Pure black with subtle radial gradient (dark blue #0A0E27 at edges)\n\nEffects:\n  - Wire has motion blur suggesting movement/energy\n  - Particle system where wire \"frays\" at bottom\n  - Faint grid floor (Kubernetes topology) barely visible below\n  - God ray from above catching the ghost form\n  - Chromatic aberration on the bright blue (subtle RGB split)\n  - Volumetric fog/atmospheric haze in dark blue\n\nComposition: Centered with plenty of negative space, breathes\n</code></pre> <p>Technical specs:</p> <ul> <li>Format: PNG (high-res), WebP (optimized)</li> <li>Resolution: Minimum 1280x640px, ideally 2560x1280px for retina</li> <li>GitHub social preview: 1280x640px exactly</li> <li>Use cases: README header, repo social card, documentation</li> </ul>"},{"location":"brand/#design-elements","title":"Design Elements","text":""},{"location":"brand/#the-wire","title":"The Wire","text":"<ul> <li>One continuous line - represents infrastructure connectivity</li> <li>Rounded caps and joins - smooth, professional</li> <li>3-4px stroke weight - visible at all sizes</li> <li>Electric blue glow - energy, technology, security</li> <li>Motion blur effect (optional) - suggests data flow</li> </ul>"},{"location":"brand/#the-ghost-form","title":"The Ghost Form","text":"<ul> <li>Abstract silhouette - not literal cartoon ghost</li> <li>Rounded head - approachable yet professional</li> <li>Flowing bottom - ethereal, dissolving into particles</li> <li>Translucent/wireframe - transparency = security principle</li> </ul>"},{"location":"brand/#signal-integration","title":"Signal Integration","text":"<ul> <li>3 ascending wave dots/lines - Signal's iconic pattern</li> <li>Integrated into chest area - heart of communication</li> <li>Same wire thickness - visual consistency</li> <li>Glows with same intensity - unified element</li> </ul>"},{"location":"brand/#kubernetes-elements","title":"Kubernetes Elements","text":"<ul> <li>Hexagon in negative space - subtle, not forced</li> <li>Grid topology background (hero only) - infrastructure context</li> <li>Barely visible - hint, not dominate</li> </ul>"},{"location":"brand/#particle-system","title":"Particle System","text":"<ul> <li>Wire frays into particles at terminus - ephemeral, ghost-like</li> <li>Cyan glowing particles (#00FFE5)</li> <li>Scattered, dissolving - suggests encryption/data decay</li> <li>Subtle - accent only, not overwhelming</li> </ul>"},{"location":"brand/#typography","title":"Typography","text":""},{"location":"brand/#headers","title":"Headers","text":"<ul> <li>Font: Modern geometric sans-serif (Inter, SF Pro, Manrope)</li> <li>Weight: Medium to Bold (500-700)</li> <li>Style: Clean, technical, professional</li> <li>Color: Electric blue (#00D9FF) on dark, charcoal (#1A1A1A) on light</li> </ul>"},{"location":"brand/#body-text","title":"Body Text","text":"<ul> <li>Font: Sans-serif (Inter, system-ui) or monospace for technical docs</li> <li>Weight: Regular (400), medium (500) for emphasis</li> <li>Line height: 1.6-1.8 for readability</li> <li>Color: White/light gray on dark, charcoal on light</li> </ul>"},{"location":"brand/#codetechnical","title":"Code/Technical","text":"<ul> <li>Font: Monospace (JetBrains Mono, Fira Code, SF Mono)</li> <li>Style: Syntax highlighting with blue accent colors</li> <li>Background: Dark navy (#0A0E27) with subtle borders</li> </ul>"},{"location":"brand/#visual-style-guidelines","title":"Visual Style Guidelines","text":""},{"location":"brand/#dos","title":"Do's \u2705","text":"<ul> <li>Use high contrast (deep blacks, brilliant blues)</li> <li>Employ transparency and glow effects strategically</li> <li>Keep designs scalable and legible at all sizes</li> <li>Maintain clean geometric precision</li> <li>Use motion/flow suggestions (particles, blur)</li> <li>Reference Signal blue but don't copy Signal's logo</li> <li>Embrace negative space and minimalism</li> <li>Add subtle atmospheric effects (fog, rays)</li> </ul>"},{"location":"brand/#donts","title":"Don'ts \u274c","text":"<ul> <li>No literal ghost cartoons or emoji-style graphics</li> <li>No overly complex gradients that don't scale</li> <li>No text/wordmarks embedded in icon versions</li> <li>No elements that break at small sizes</li> <li>No cartoonish or juvenile aesthetics</li> <li>No copying Signal's logo directly</li> <li>No cluttered compositions</li> <li>No fine details that disappear when scaled down</li> </ul>"},{"location":"brand/#usage-contexts","title":"Usage Contexts","text":""},{"location":"brand/#required-assets","title":"Required Assets","text":"<ol> <li>Icon (Square)</li> <li>512x512px SVG/PNG</li> <li>256x256px PNG</li> <li>64x64px PNG (favicon)</li> <li> <p>16x16px PNG (favicon)</p> </li> <li> <p>Hero/Banner</p> </li> <li>1280x640px PNG (GitHub social preview)</li> <li> <p>2560x1280px PNG (retina/high-res)</p> </li> <li> <p>Logo Lockup (optional)</p> </li> <li>Icon + \"Ghostwire\" wordmark</li> <li>Horizontal and stacked versions</li> <li>Dark and light variants</li> </ol>"},{"location":"brand/#use-cases","title":"Use Cases","text":"<ul> <li>GitHub repository social preview (1280x640px)</li> <li>Artifact Hub package icon (square, various sizes)</li> <li>README header/hero image</li> <li>Documentation assets</li> <li>Kubernetes dashboard icons</li> <li>Helm Hub listings</li> <li>Stickers/swag (if applicable)</li> <li>Conference presentations</li> </ul>"},{"location":"brand/#visual-references-inspiration","title":"Visual References &amp; Inspiration","text":""},{"location":"brand/#art-style","title":"Art Style","text":"<ul> <li>One-line drawing art - Luke Chioules' continuous line portraits</li> <li>Neon sign tubing - Single continuous glowing tube aesthetic</li> <li>Oscilloscope waveforms - Technical, precise, flowing</li> <li>Tron lightcycle trails - Glowing lines in dark space</li> <li>Cyberpunk holograms - Wireframe projections</li> </ul>"},{"location":"brand/#brand-inspiration","title":"Brand Inspiration","text":"<ul> <li>Signal - Blue communication aesthetic, secure messaging</li> <li>Kubernetes - Hexagons, cloud-native infrastructure</li> <li>Tailscale - Friendly-yet-technical, clean design</li> <li>Stripe - Minimalist technical branding excellence</li> <li>Linear - Bold simplicity, dark mode first</li> <li>Vercel - Geometric precision, high contrast</li> </ul>"},{"location":"brand/#cinematicmood","title":"Cinematic/Mood","text":"<ul> <li>Tron Legacy - Digital world, glowing lines, blue/black</li> <li>Blade Runner 2049 - Atmospheric lighting, volumetric fog</li> <li>Ghost in the Shell - Cyber-infrastructure visualization</li> <li>Minority Report - Holographic UI, translucent interfaces</li> </ul>"},{"location":"brand/#ai-generator-prompts","title":"AI Generator Prompts","text":""},{"location":"brand/#primary-prompt-recommended-v20","title":"Primary Prompt (Recommended - v2.0)","text":"<p>For icon generation:</p> <pre><code>Minimalist abstract logo: single continuous glowing electric blue wire (#00D9FF) drawn in one unbroken line forming an elongated ghost silhouette against pure black background, NO FACE, smooth rounded top flowing into narrow elegant body, Signal messenger three ascending wave dots integrated mid-body as part of the continuous line, subtle Kubernetes hexagon formed by negative space, wire terminus frays into dispersing cyan particles at bottom (asymmetric, random scatter), neon tube aesthetic with bright outer glow, 4px stroke weight, rounded caps and joins, professional technical illustration, high contrast, clean vector style, vertical composition, --ar 1:1 --style raw\n</code></pre> <p>Key requirements:</p> <ul> <li>\u274c NO FACE - No eyes, no mouth, no facial features</li> <li>\u2705 Single continuous line - One unbroken wire path</li> <li>\u2705 Elongated vertical - Narrow elegant body, not squat</li> <li>\u2705 Signal waves visible - Three ascending dots/lines integrated</li> <li>\u2705 Abstract geometric - Not literal cartoon ghost</li> </ul>"},{"location":"brand/#alternative-more-abstract-approach","title":"Alternative: More Abstract Approach","text":"<p>If the AI generates literal/cute ghosts, use this more geometric version:</p> <pre><code>Abstract minimalist icon: electric blue glowing wireframe (#00D9FF) suggesting ghost form through geometric abstraction, vertical flowing shape with rounded apex, three ascending signal wave elements integrated into continuous line path, subtle angular Kubernetes hexagon in negative space, wire dissolves into scattered cyan particles below, pure black background, neon sign aesthetic with bright cyan glow effect, professional technical logo, high contrast, clean vector linework, no facial features, --ar 1:1 --v 6\n</code></pre>"},{"location":"brand/#hero-banner-prompt","title":"Hero Banner Prompt","text":"<p>For 1280x640 GitHub social preview:</p> <pre><code>Cinematic minimalist render, single continuous glowing electric blue wireframe ghost floating in pure black void, electric blue wire (#00D9FF) with intense outer glow, Signal wave pattern integrated, particles dispersing at bottom, faint Kubernetes hexagon grid floor below, volumetric god rays from above, subtle motion blur, chromatic aberration on highlights, dark atmospheric fog, professional technical visualization, high contrast, neon aesthetic, octane render, 8K --ar 16:9 --style raw\n</code></pre>"},{"location":"brand/#design-iteration-examples","title":"Design Iteration Examples","text":""},{"location":"brand/#attempt-1-analysis","title":"Attempt #1 - Analysis","text":""},{"location":"brand/#what-worked","title":"What Worked \u2705","text":"<ul> <li>Single continuous wire execution</li> <li>Electric blue neon glow (#00D9FF range)</li> <li>Pure black background, high contrast</li> <li>Particle dispersal at bottom</li> <li>Clean line weight, scalable</li> <li>Kubernetes hexagon integrated</li> </ul>"},{"location":"brand/#critical-issues","title":"Critical Issues \u274c","text":"<ol> <li>Too literal/cute - Eyes and face make it cartoon-like, not abstract</li> <li>Signal integration missing - No visible Signal wave pattern</li> <li>Line complexity - Multiple separate elements, not one continuous wire</li> <li>Proportions - Too wide/squat, lacks elegant tactical edge</li> <li>Hexagon too prominent - Kubernetes should be subtle hint</li> </ol> <p>Score: 6.5/10 (Beautiful execution, but misses brand alignment)</p>"},{"location":"brand/#iteration-guidelines","title":"Iteration Guidelines","text":"<p>When generating assets, iterate until you achieve:</p> <ul> <li>Abstract form - Geometric ghost suggestion, not literal</li> <li>Single wire path - One continuous unbroken line</li> <li>Signal waves visible - Three ascending dots/lines clearly integrated</li> <li>Vertical elegance - Narrow, elongated, tactical</li> <li>No facial features - Eyes/mouth make it too cute</li> <li>Asymmetric particles - Random scatter, not decorative symmetry</li> </ul>"},{"location":"brand/#brand-evolution","title":"Brand Evolution","text":""},{"location":"brand/#phase-1-launch-current","title":"Phase 1: Launch (Current)","text":"<ul> <li>Single icon design (the wire ghost)</li> <li>GitHub README hero image</li> <li>Basic color palette established</li> </ul>"},{"location":"brand/#phase-2-growth","title":"Phase 2: Growth","text":"<ul> <li>Animated SVG version (line drawing animation)</li> <li>Icon variants (loading states, status indicators)</li> <li>Sticker/swag designs</li> <li>Conference presentation templates</li> </ul>"},{"location":"brand/#phase-3-ecosystem","title":"Phase 3: Ecosystem","text":"<ul> <li>Community derivative guidelines</li> <li>Integration partner badge system</li> <li>Themed documentation templates</li> <li>Video intro animation</li> </ul>"},{"location":"brand/#file-organization","title":"File Organization","text":"<p>Recommended asset structure:</p> <pre><code>/brand/\n  /icons/\n    ghostwire-icon.svg          # Vector source\n    ghostwire-icon-512.png      # High-res\n    ghostwire-icon-256.png      # Medium\n    ghostwire-icon-64.png       # Small\n    ghostwire-icon-16.png       # Favicon\n  /hero/\n    ghostwire-hero-2560x1280.png   # Retina\n    ghostwire-hero-1280x640.png    # Standard\n  /logo/\n    ghostwire-logo-dark.svg     # Lockup on dark\n    ghostwire-logo-light.svg    # Lockup on light\n  /social/\n    github-social-preview.png   # 1280x640\n</code></pre>"},{"location":"brand/#license-usage","title":"License &amp; Usage","text":"<p>The Ghostwire brand assets are:</p> <ul> <li>Copyright: 2025 Drengskapur LLC and The Ghostwire Authors</li> <li>License: Apache 2.0 (same as project)</li> <li>Usage: Free to use in context of Ghostwire project</li> <li>Modifications: Allowed with attribution</li> <li>Commercial use: Permitted under Apache 2.0</li> </ul> <p>Attribution: When using Ghostwire branding, please credit:</p> <p>Ghostwire branding by Drengskapur LLC</p>"},{"location":"brand/#contact","title":"Contact","text":"<p>For brand asset requests, partnership inquiries, or custom variations:</p> <ul> <li>GitHub: github.com/drengskapur/ghostwire</li> <li>Issues: Brand assets request template</li> </ul> <p>The Stealth Wire - One line. Infinite possibilities.</p>"},{"location":"code-review-strategy/","title":"Code Review Strategy","text":""},{"location":"code-review-strategy/#current-status","title":"Current Status","text":"<p>Ghostwire is currently maintained by a single maintainer. While the project has implemented all the infrastructure for code review, the OpenSSF Scorecard Code-Review check reflects the challenge of single-maintainer projects.</p>"},{"location":"code-review-strategy/#infrastructure-in-place","title":"Infrastructure in Place","text":"<p>\u2705 Branch Protection Enabled - Requires 1 approving review before merge - Requires passing status checks - Dismisses stale reviews on new commits - Prevents direct pushes to main</p> <p>\u2705 PR Workflow Required - All changes must go through pull requests - Automated testing runs on every PR - Security scanning validates changes - Clear contribution guidelines (CONTRIBUTING.md)</p> <p>\u2705 Review Process Documented - PR template guides contributors - Required checks clearly defined - Merge requirements transparent</p>"},{"location":"code-review-strategy/#single-maintainer-limitation","title":"Single-Maintainer Limitation","text":"<p>Current Configuration: - <code>enforce_admins: false</code> - Allows repository admins to bypass review requirements - This is necessary for single-maintainer projects where self-review is not possible</p> <p>Impact on Scorecard: - Code-Review score: 0/10 - Reason: All recent commits were admin-merged without external review - This is expected for projects with one active maintainer</p>"},{"location":"code-review-strategy/#how-code-review-works","title":"How Code Review Works","text":""},{"location":"code-review-strategy/#when-external-contributors-submit-prs","title":"When External Contributors Submit PRs:","text":"<ol> <li>Contributor forks the repository</li> <li>Contributor submits PR from their fork</li> <li>Automated tests run (CI/CD)</li> <li>Maintainer reviews and approves</li> <li>PR is merged</li> </ol> <p>\u2705 This counts as code review for Scorecard</p>"},{"location":"code-review-strategy/#when-maintainer-makes-changes","title":"When Maintainer Makes Changes:","text":"<ol> <li>Maintainer creates feature branch</li> <li>Maintainer opens PR</li> <li>Automated tests run (CI/CD)</li> <li>No external reviewer available</li> <li>Maintainer merges using admin override</li> </ol> <p>\u274c This does not count as code review for Scorecard</p>"},{"location":"code-review-strategy/#improving-code-review-score","title":"Improving Code Review Score","text":""},{"location":"code-review-strategy/#short-term-strategies","title":"Short-term Strategies:","text":"<ol> <li>Recruit Co-Maintainers</li> <li>Invite trusted contributors from other organizations</li> <li>Establish review partnerships with peer projects</li> <li> <p>Engage with users who submit quality issues/PRs</p> </li> <li> <p>Community Engagement</p> </li> <li>Highlight opportunities to contribute</li> <li>Lower barrier to entry for new contributors</li> <li> <p>Recognize and reward quality contributions</p> </li> <li> <p>Transparent Process</p> </li> <li>Continue following PR workflow even without reviews</li> <li>Document all changes thoroughly</li> <li>Maintain high-quality commit messages</li> </ol>"},{"location":"code-review-strategy/#long-term-goal","title":"Long-term Goal:","text":"<p>Target: Multi-Maintainer Model - Minimum 2-3 active maintainers - From different organizations (improves Contributors score too) - Regular review rotation</p>"},{"location":"code-review-strategy/#why-this-matters","title":"Why This Matters","text":""},{"location":"code-review-strategy/#security-benefits-of-code-review","title":"Security Benefits of Code Review:","text":"<ol> <li>Catches Bugs Early: Second pair of eyes spots issues</li> <li>Prevents Vulnerabilities: Reviewers may catch security flaws</li> <li>Deters Malicious Code: Review makes injection attacks harder</li> <li>Improves Code Quality: Feedback leads to better solutions</li> <li>Knowledge Sharing: Multiple people understand the codebase</li> </ol>"},{"location":"code-review-strategy/#current-mitigations","title":"Current Mitigations:","text":"<p>Even without human code review, the project uses multiple layers of defense:</p> <ul> <li>\u2705 Automated Testing: Catches functional regressions</li> <li>\u2705 Static Analysis: Detects code quality issues (ShellCheck)</li> <li>\u2705 Security Scanning: Finds vulnerabilities (Trivy, TruffleHog)</li> <li>\u2705 Dependency Scanning: Monitors third-party code (Renovate, Dependabot)</li> <li>\u2705 Signed Commits: Verifies author identity</li> <li>\u2705 Pinned Dependencies: Prevents supply chain attacks</li> <li>\u2705 SBOM Generation: Tracks component inventory</li> </ul>"},{"location":"code-review-strategy/#accepting-the-limitation","title":"Accepting the Limitation","text":"<p>For projects that cannot realistically require code review for all changes:</p>"},{"location":"code-review-strategy/#document-the-trade-off","title":"Document the Trade-off:","text":"<ul> <li>Single maintainer cannot self-review</li> <li><code>enforce_admins: false</code> is necessary for project maintenance</li> <li>Infrastructure is ready for reviews when contributors arrive</li> </ul>"},{"location":"code-review-strategy/#focus-on-other-controls","title":"Focus on Other Controls:","text":"<ul> <li>Comprehensive automated testing</li> <li>Multiple security scanning tools</li> <li>Transparent development process</li> <li>Quick response to security reports</li> </ul>"},{"location":"code-review-strategy/#track-progress","title":"Track Progress:","text":"<ul> <li>Monitor contributor growth</li> <li>Celebrate first reviewed PR</li> <li>Track review coverage over time</li> </ul>"},{"location":"code-review-strategy/#when-score-will-improve","title":"When Score Will Improve","text":"<p>The Code-Review score will naturally improve when:</p> <ol> <li>External contributors submit PRs that are reviewed and merged</li> <li>Co-maintainers join who can review each other's work</li> <li>Review history accumulates over the last ~30 commits</li> </ol> <p>Scorecard evaluates the most recent ~30 commits, so the score will reflect the project's evolution toward multi-maintainer collaboration.</p>"},{"location":"code-review-strategy/#call-for-co-maintainers","title":"Call for Co-Maintainers","text":"<p>If you're interested in becoming a co-maintainer of Ghostwire:</p> <ol> <li>Submit quality PRs demonstrating expertise</li> <li>Engage constructively with issues and discussions</li> <li>Show commitment to the project's goals and users</li> <li>Understand Kubernetes, Helm, and security best practices</li> </ol> <p>Contact the project maintainer at: https://github.com/drengskapur/ghostwire/discussions</p> <p>Bottom Line: The infrastructure for code review is complete. The missing piece is additional maintainers. This is a community-building challenge, not a technical one.</p>"},{"location":"container-architecture/","title":"Ghostwire Container Architecture","text":""},{"location":"container-architecture/#overview","title":"Overview","text":"<p>This document provides a detailed analysis of the Ghostwire container runtime architecture, startup sequence, process tree, filesystem structure, and configuration mechanisms based on live inspection of a running container.</p> <p>Container Base Image: <code>kasmweb/signal:1.18.0-rolling-daily</code> Primary Components: KasmVNC + Signal Desktop + XFCE4 Desktop Environment</p>"},{"location":"container-architecture/#architecture-diagrams","title":"Architecture Diagrams","text":""},{"location":"container-architecture/#container-startup-sequence","title":"Container Startup Sequence","text":"<pre><code>sequenceDiagram\n    participant Init as PID 1&lt;br/&gt;vnc_startup.sh\n    participant DBus as D-Bus Session\n    participant Xvnc as Xvnc Server&lt;br/&gt;(PID 72)\n    participant XFCE as XFCE4 Session&lt;br/&gt;(PID 89)\n    participant Audio as Audio Stack&lt;br/&gt;(PIDs 92,108,115)\n    participant Services as Kasm Services&lt;br/&gt;(PIDs 117-130)\n    participant Signal as Signal Desktop&lt;br/&gt;(PID 148)\n\n    Init-&gt;&gt;DBus: Start D-Bus session bus\n    Init-&gt;&gt;Xvnc: Launch Xvnc :1&lt;br/&gt;Port 6901\n    Xvnc--&gt;&gt;Xvnc: Generate self.pem&lt;br/&gt;Load .kasmpasswd\n    Init-&gt;&gt;XFCE: Start xfce4-session\n    XFCE-&gt;&gt;XFCE: Launch xfwm4, xfsettingsd&lt;br/&gt;xfdesktop, Thunar\n    Init-&gt;&gt;Audio: Start PulseAudio\n    Audio-&gt;&gt;Audio: Launch ffmpeg encoder&lt;br/&gt;Start kasm_audio_out\n    Init-&gt;&gt;Services: Launch auxiliary services\n    Services-&gt;&gt;Services: Extract StaticX binaries&lt;br/&gt;Start audio_input, upload,&lt;br/&gt;gamepad, printer, smartcard\n    Init-&gt;&gt;Signal: Execute custom_startup.sh\n    Signal-&gt;&gt;Signal: Launch signal-desktop&lt;br/&gt;--no-sandbox\n    Signal--&gt;&gt;Signal: Create zygotes, renderers&lt;br/&gt;Load Signal data\n    Note over Init,Signal: All services running&lt;br/&gt;Container ready on port 6901</code></pre>"},{"location":"container-architecture/#network-architecture","title":"Network Architecture","text":"<pre><code>graph TB\n    subgraph \"External Access\"\n        Client[Web Browser]\n        K8s[Kubernetes Service&lt;br/&gt;Port 6901]\n    end\n\n    subgraph \"Container Network Stack\"\n        Xvnc[Xvnc Server&lt;br/&gt;:6901 TCP+UDP]\n        AudioOut[kasm_audio_out&lt;br/&gt;:4901 WebSocket&lt;br/&gt;:8081 MPEG-TS]\n        Upload[kasm_upload_server&lt;br/&gt;:4902 HTTPS]\n        AudioIn[kasm_audio_input&lt;br/&gt;:4903 WSS]\n        Gamepad[kasm_gamepad&lt;br/&gt;:4904 WSS]\n    end\n\n    subgraph \"Services\"\n        Printer[Printer Service&lt;br/&gt;/tmp/printer socket]\n        Smartcard[Smartcard Bridge&lt;br/&gt;/tmp/smartcard socket]\n        FFmpeg[FFmpeg&lt;br/&gt;Audio Encoder]\n        Pulse[PulseAudio]\n    end\n\n    Client --&gt;|HTTPS/WSS| K8s\n    K8s --&gt;|Proxy| Xvnc\n    Xvnc --&gt;|VNC Protocol| Display[X Server :1]\n    Xvnc -.-&gt;|TLS Auth| AuthFile[.kasmpasswd]\n\n    Client -.-&gt;|Audio Stream| AudioOut\n    FFmpeg --&gt;|HTTP| AudioOut\n    Pulse --&gt;|Capture| FFmpeg\n\n    Client -.-&gt;|File Upload| Upload\n    Client -.-&gt;|Microphone| AudioIn\n    Client -.-&gt;|Controllers| Gamepad\n\n    Display -.-&gt;|Print Jobs| Printer\n    Display -.-&gt;|Smartcard| Smartcard\n\n    style Xvnc fill:#4CAF50\n    style K8s fill:#2196F3\n    style Client fill:#FF9800</code></pre>"},{"location":"container-architecture/#process-hierarchy","title":"Process Hierarchy","text":"<pre><code>graph TD\n    PID1[PID 1: vnc_startup.sh&lt;br/&gt;Entry Point]\n\n    PID1 --&gt; DBus[PID 19: dbus-daemon&lt;br/&gt;Session Bus]\n    PID1 --&gt; Xvnc[PID 72: Xvnc :1&lt;br/&gt;81MB RAM]\n    PID1 --&gt; XFCE[PID 89: xfce4-session&lt;br/&gt;80MB RAM]\n    PID1 --&gt; AudioOut[PID 92: kasm_audio_out&lt;br/&gt;40MB RAM]\n    PID1 --&gt; Pulse[PID 108: pulseaudio&lt;br/&gt;15MB RAM]\n    PID1 --&gt; FFmpeg[PID 115: ffmpeg&lt;br/&gt;46MB RAM]\n    PID1 --&gt; AudioIn[PID 117: audio_input&lt;br/&gt;Parent]\n    PID1 --&gt; UploadSrv[PID 119: upload_server&lt;br/&gt;Parent]\n    PID1 --&gt; GamepadSrv[PID 121: gamepad_server&lt;br/&gt;Parent]\n    PID1 --&gt; PrintSrv[PID 124: printer_service&lt;br/&gt;Parent]\n    PID1 --&gt; SmartSrv[PID 130: smartcard_bridge&lt;br/&gt;Parent]\n    PID1 --&gt; Signal[PID 148: signal-desktop&lt;br/&gt;383MB RAM]\n\n    XFCE --&gt; WM[PID 192: xfwm4]\n    XFCE --&gt; Settings[PID 220: xfsettingsd]\n    XFCE --&gt; Thunar[PID 233: Thunar]\n    XFCE --&gt; Desktop[PID 334: xfdesktop]\n    XFCE --&gt; Notify[PID 476: xfce4-notifyd]\n\n    AudioIn --&gt; AudioInChild[PID 234: staticx&lt;br/&gt;PID 241: worker]\n    UploadSrv --&gt; UploadChild[PID 263: staticx&lt;br/&gt;PID 362: Flask worker]\n    GamepadSrv --&gt; GamepadChild[PID 258: staticx&lt;br/&gt;PID 281: worker]\n    PrintSrv --&gt; PrintChild[PID 256: staticx&lt;br/&gt;PID 272: worker]\n    SmartSrv --&gt; SmartChild[PID 257: staticx&lt;br/&gt;PID 269: worker]\n\n    Signal --&gt; Zygote1[PID 159: zygote]\n    Signal --&gt; Zygote2[PID 160: zygote]\n    Signal --&gt; Network[PID 289: network service&lt;br/&gt;78MB RAM]\n    Signal --&gt; ZygoteGPU[PID 402: zygote GPU]\n    Signal --&gt; Renderer[PID 427: renderer&lt;br/&gt;258MB RAM]\n\n    style PID1 fill:#FF9800\n    style Xvnc fill:#4CAF50\n    style Signal fill:#E91E63\n    style XFCE fill:#2196F3</code></pre>"},{"location":"container-architecture/#authentication-flow","title":"Authentication Flow","text":"<pre><code>sequenceDiagram\n    participant Client as Web Browser\n    participant Xvnc as Xvnc Server&lt;br/&gt;Port 6901\n    participant Auth as .kasmpasswd&lt;br/&gt;Password File\n    participant Session as VNC Session\n\n    Client-&gt;&gt;Xvnc: HTTPS/WSS Connection\n    Xvnc--&gt;&gt;Client: TLS Handshake&lt;br/&gt;(self.pem certificate)\n    Client-&gt;&gt;Xvnc: Username + Password\n    Xvnc-&gt;&gt;Auth: Validate Credentials\n    Auth--&gt;&gt;Auth: SHA-256 crypt verify&lt;br/&gt;$5$kasm$...\n\n    alt Valid Credentials\n        Auth--&gt;&gt;Xvnc: \u2713 Permissions (wo/r)\n        Xvnc-&gt;&gt;Session: Create Session\n        Session--&gt;&gt;Client: VNC Stream Active\n    else Invalid Credentials\n        Auth--&gt;&gt;Xvnc: \u2717 Authentication Failed\n        Xvnc--&gt;&gt;Client: 401 Unauthorized\n    end\n\n    Note over Client,Session: Auxiliary services use&lt;br/&gt;same auth token:&lt;br/&gt;kasm_user:password</code></pre>"},{"location":"container-architecture/#data-flow-audio-streaming","title":"Data Flow - Audio Streaming","text":"<pre><code>graph LR\n    subgraph \"Container\"\n        App[Application Audio]\n        Pulse[PulseAudio&lt;br/&gt;:pulse socket]\n        FFmpeg[FFmpeg Encoder&lt;br/&gt;MP2 128kbps]\n        AudioOut[kasm_audio_out&lt;br/&gt;:8081 ingest&lt;br/&gt;:4901 WebSocket]\n    end\n\n    subgraph \"Browser\"\n        Player[JSMpeg Player]\n        Speakers[Audio Output]\n    end\n\n    App --&gt;|Audio Output| Pulse\n    Pulse --&gt;|Capture Default Sink| FFmpeg\n    FFmpeg --&gt;|HTTP&lt;br/&gt;MPEG-TS| AudioOut\n    AudioOut --&gt;|WSS&lt;br/&gt;Encrypted Stream| Player\n    Player --&gt; Speakers\n\n    style AudioOut fill:#4CAF50\n    style FFmpeg fill:#2196F3\n    style Pulse fill:#FF9800</code></pre>"},{"location":"container-architecture/#filesystem-persistence","title":"Filesystem Persistence","text":"<pre><code>graph TB\n    subgraph \"PersistentVolumeClaim\"\n        PVC[/home/kasm-user&lt;br/&gt;RWO Volume]\n    end\n\n    subgraph \"Critical Paths\"\n        Signal[.config/Signal/&lt;br/&gt;MUST PERSIST]\n        VNC[.vnc/&lt;br/&gt;Logs &amp; Config]\n        Uploads[Uploads/&lt;br/&gt;User Files]\n        PDF[PDF/&lt;br/&gt;Print Output]\n        Desktop[Desktop/&lt;br/&gt;User Files]\n    end\n\n    subgraph \"Signal Data\"\n        IndexDB[IndexedDB/&lt;br/&gt;Messages DB]\n        Blob[blob_storage/&lt;br/&gt;Attachments]\n        Config[config.json&lt;br/&gt;Device Keys]\n        SQL[sql/&lt;br/&gt;Encrypted DB]\n    end\n\n    subgraph \"Ephemeral Paths\"\n        Tmp[/tmp/staticx-*&lt;br/&gt;Service Binaries]\n        Sockets[/tmp/*.socket&lt;br/&gt;Unix Sockets]\n    end\n\n    PVC --&gt; Signal\n    PVC --&gt; VNC\n    PVC --&gt; Uploads\n    PVC --&gt; PDF\n    PVC --&gt; Desktop\n\n    Signal --&gt; IndexDB\n    Signal --&gt; Blob\n    Signal --&gt; Config\n    Signal --&gt; SQL\n\n    style Signal fill:#E91E63\n    style PVC fill:#4CAF50\n    style IndexDB fill:#FF9800\n    style Config fill:#FF9800</code></pre>"},{"location":"container-architecture/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Container Startup Sequence</li> <li>Process Architecture</li> <li>Filesystem Structure</li> <li>Network Services</li> <li>Authentication System</li> <li>TLS/SSL Configuration</li> <li>Environment Variables</li> <li>Signal Desktop Integration</li> <li>KasmVNC Features</li> </ol>"},{"location":"container-architecture/#container-startup-sequence_1","title":"Container Startup Sequence","text":""},{"location":"container-architecture/#phase-1-initialization-pid-1","title":"Phase 1: Initialization (PID 1)","text":"<p>Entry Point: <code>/dockerstartup/vnc_startup.sh</code></p> <ul> <li>Launched by <code>/bin/bash /dockerstartup/vnc_startup.sh /dockerstartup/kasm_startup.sh --wait</code></li> <li>Executes as <code>kasm-user</code> (UID 1000, GID 1000)</li> </ul> <p>Startup Script Flow:</p> <pre><code>1. D-Bus session bus initialization\n2. X server (Xvnc) startup\n3. Window manager initialization (XFCE4)\n4. Audio services startup\n5. KasmVNC auxiliary services\n6. Custom application startup (Signal Desktop)\n</code></pre>"},{"location":"container-architecture/#phase-2-x-server-and-vnc-pid-72","title":"Phase 2: X Server and VNC (PID 72)","text":"<p>Xvnc Process: Multi-threaded VNC server with integrated X server</p> <p>Key Launch Parameters:</p> <pre><code>/usr/bin/Xvnc :1 \\\n  -depth 24 \\\n  -geometry 1024x768 \\\n  -httpd /usr/share/kasmvnc/www \\\n  -websocketPort 6901 \\\n  -interface 0.0.0.0 \\\n  -cert /home/kasm-user/.vnc/self.pem \\\n  -key /home/kasm-user/.vnc/self.pem \\\n  -KasmPasswordFile /home/kasm-user/.kasmpasswd \\\n  -rfbauth /home/kasm-user/.vnc/passwd \\\n  -FrameRate 60 \\\n  -MaxVideoResolution 1920x1080 \\\n  -DynamicQualityMin 7 \\\n  -DynamicQualityMax 8 \\\n  -sslOnly 0\n</code></pre> <p>Display Configuration:</p> <ul> <li>Display: <code>:1</code> (DISPLAY environment variable)</li> <li>Default resolution: <code>1024x768</code> (configurable via <code>VNC_RESOLUTION</code>)</li> <li>Max resolution: <code>1920x1080</code></li> <li>Frame rate: 60 FPS (default 24 FPS, overridden)</li> <li>Color depth: 24-bit</li> </ul>"},{"location":"container-architecture/#phase-3-window-manager-pid-89-192","title":"Phase 3: Window Manager (PID 89, 192)","text":"<p>XFCE4 Session Components:</p> <ol> <li><code>xfce4-session</code> (PID 89) - Session manager</li> <li><code>xfwm4</code> (PID 192) - Window manager with compositing</li> <li><code>xfsettingsd</code> (PID 220) - Settings daemon</li> <li><code>xfdesktop</code> (PID 334) - Desktop manager</li> <li><code>Thunar</code> (PID 233) - File manager (daemon mode)</li> <li><code>xfce4-notifyd</code> (PID 476) - Notification daemon</li> </ol> <p>Startup Output:</p> <pre><code>------------------ Xfce4 window manager startup------------------\nStarting XFCE\n/usr/bin/startxfce4: X server already running on display :1\n</code></pre> <p>Other Window Managers: OpenBox and KDE are available but skipped by default.</p>"},{"location":"container-architecture/#phase-4-audio-services-pids-92-108-115","title":"Phase 4: Audio Services (PIDs 92, 108, 115)","text":"<p>Audio Stack:</p> <ol> <li>PulseAudio (PID 108) - Audio server</li> </ol> <pre><code>pulseaudio --start\n</code></pre> <ol> <li>Kasm Audio Out (PID 92) - Audio streaming server</li> </ol> <pre><code>/dockerstartup/jsmpeg/kasm_audio_out-linux \\\n  kasmaudio 8081 4901 \\\n  /home/kasm-user/.vnc/self.pem \\\n  /home/kasm-user/.vnc/self.pem \\\n  kasm_user:CorrectHorseBatteryStaple\n</code></pre> <ul> <li>Listens on port 8081 (MPEG-TS stream ingestion)</li> <li>WebSocket server on port 4901 (audio streaming to browser)</li> <li>Uses self-signed TLS certificate</li> <li> <p>Requires authentication token</p> </li> <li> <p>FFmpeg Audio Encoder (PID 115) - Audio capture and encoding</p> </li> </ul> <pre><code>ffmpeg -v verbose \\\n  -f pulse \\\n  -fragment_size 2000 \\\n  -ar 44100 \\\n  -i default \\\n  -f mpegts \\\n  -correct_ts_overflow 0 \\\n  -codec:a mp2 \\\n  -b:a 128k \\\n  -ac 1 \\\n  -muxdelay 0.001 \\\n  http://127.0.0.1:8081/kasmaudio\n</code></pre> <ul> <li>Captures from PulseAudio default sink</li> <li>Sample rate: 44.1 kHz</li> <li>Codec: MP2 at 128 kbps</li> <li>Mono output</li> </ul>"},{"location":"container-architecture/#phase-5-kasmvnc-auxiliary-services","title":"Phase 5: KasmVNC Auxiliary Services","text":"<p>Service Overview:</p> Service PID Port Purpose Audio Input 117/234/241 4903 Microphone streaming from browser Upload Server 119/263/362 4902 File upload to container Gamepad Server 121/258/281 4904 Game controller passthrough Printer Service 124/256/272 Unix socket PDF printing (/home/kasm-user/PDF) Smartcard Bridge 130/257/269 Unix socket Smartcard/PKCS#11 support <p>Implementation Details:</p> <ul> <li>All services use StaticX packaging (self-extracting to <code>/tmp/staticx-*</code>)</li> <li>TLS-enabled with self-signed certificates</li> <li>Token-based authentication: <code>kasm_user:CorrectHorseBatteryStaple</code></li> <li>Services run as multiple processes (parent + child)</li> </ul> <p>Audio Input Server:</p> <pre><code>/dockerstartup/audio_input/kasm_audio_input_server \\\n  --ssl \\\n  --auth-token kasm_user:CorrectHorseBatteryStaple \\\n  --cert /home/kasm-user/.vnc/self.pem \\\n  --certkey /home/kasm-user/.vnc/self.pem\n</code></pre> <p>Upload Server:</p> <pre><code>/dockerstartup/upload_server/kasm_upload_server \\\n  --ssl \\\n  --auth-token kasm_user:CorrectHorseBatteryStaple \\\n  --port 4902 \\\n  --upload_dir /home/kasm-user/Uploads\n</code></pre> <ul> <li>Flask-based Python application</li> <li>HTTPS on port 4902</li> <li>Files uploaded to <code>/home/kasm-user/Uploads</code></li> </ul> <p>Printer Service:</p> <pre><code>/dockerstartup/printer/kasm_printer_service \\\n  --directory /home/kasm-user/PDF \\\n  --relay /tmp/printer\n</code></pre> <ul> <li>Monitors Unix socket <code>/tmp/printer</code></li> <li>Saves PDFs to <code>/home/kasm-user/PDF</code></li> <li>Python-based service</li> </ul>"},{"location":"container-architecture/#phase-6-signal-desktop-application-pid-148","title":"Phase 6: Signal Desktop Application (PID 148)","text":"<p>Launch Command:</p> <pre><code>signal-desktop --no-sandbox\n</code></pre> <p>Process Tree:</p> <pre><code>148: signal-desktop (main process)\n\u251c\u2500\u2500 159: zygote (no sandbox)\n\u251c\u2500\u2500 160: zygote (no sandbox)\n\u251c\u2500\u2500 289: utility process (network service)\n\u251c\u2500\u2500 402: zygote (GPU process helper)\n\u2514\u2500\u2500 427: renderer process (Chromium renderer)\n</code></pre> <p>Key Characteristics:</p> <ul> <li>Based on Electron/Chromium</li> <li>Runs with <code>--no-sandbox</code> flag (required in containerized environment)</li> <li>Multi-process architecture (zygotes, renderers, utility processes)</li> <li>GPU acceleration disabled (software rendering fallback)</li> </ul> <p>User Data Directory: <code>/home/kasm-user/.config/Signal</code></p> <p>Startup Behavior:</p> <ul> <li>Launched by <code>/dockerstartup/custom_startup.sh</code></li> <li>Auto-restart loop if process exits</li> <li>Window maximization via <code>/dockerstartup/maximize_window.sh</code></li> <li>Environment variables:</li> </ul> <pre><code>MAXIMIZE=true\nMAXIMIZE_NAME=Signal\n</code></pre> <p>Startup Errors (Expected/Non-Fatal):</p> <pre><code>ERROR:dbus/bus.cc:408] Failed to connect to the bus: /run/dbus/system_bus_socket\nERROR:zygote_host_impl_linux.cc:283] Failed to adjust OOM score: Permission denied\nERROR:viz_main_impl.cc:189] Exiting GPU process due to errors during initialization\n</code></pre> <ul> <li>D-Bus system bus unavailable (only session bus needed)</li> <li>OOM score adjustment denied (requires CAP_SYS_ADMIN)</li> <li>GPU initialization fails (falls back to software rendering)</li> </ul>"},{"location":"container-architecture/#process-architecture","title":"Process Architecture","text":""},{"location":"container-architecture/#complete-process-tree","title":"Complete Process Tree","text":"<pre><code>PID 1: /bin/bash /dockerstartup/vnc_startup.sh\n\u2502\n\u251c\u2500\u2500\u2500 PID 19: dbus-daemon (session bus)\n\u2502\n\u251c\u2500\u2500\u2500 PID 72: Xvnc :1 (VNC + X server)\n\u2502\n\u251c\u2500\u2500\u2500 PID 89: xfce4-session\n\u2502    \u251c\u2500\u2500\u2500 PID 192: xfwm4 (window manager)\n\u2502    \u251c\u2500\u2500\u2500 PID 220: xfsettingsd\n\u2502    \u251c\u2500\u2500\u2500 PID 233: Thunar --daemon\n\u2502    \u251c\u2500\u2500\u2500 PID 334: xfdesktop\n\u2502    \u2514\u2500\u2500\u2500 PID 476: xfce4-notifyd\n\u2502\n\u251c\u2500\u2500\u2500 PID 92: kasm_audio_out-linux\n\u2502\n\u251c\u2500\u2500\u2500 PID 108: pulseaudio\n\u2502\n\u251c\u2500\u2500\u2500 PID 115: ffmpeg (audio encoder)\n\u2502\n\u251c\u2500\u2500\u2500 PID 117: kasm_audio_input_server (parent)\n\u2502    \u251c\u2500\u2500\u2500 PID 234: (child, staticx)\n\u2502    \u2514\u2500\u2500\u2500 PID 241: (worker)\n\u2502\n\u251c\u2500\u2500\u2500 PID 119: kasm_upload_server (parent)\n\u2502    \u251c\u2500\u2500\u2500 PID 263: (child, staticx)\n\u2502    \u2514\u2500\u2500\u2500 PID 362: (worker, Flask)\n\u2502\n\u251c\u2500\u2500\u2500 PID 121: kasm_gamepad_server (parent)\n\u2502    \u251c\u2500\u2500\u2500 PID 258: (child, staticx)\n\u2502    \u2514\u2500\u2500\u2500 PID 281: (worker)\n\u2502\n\u251c\u2500\u2500\u2500 PID 124: kasm_printer_service (parent)\n\u2502    \u251c\u2500\u2500\u2500 PID 256: (child, staticx)\n\u2502    \u2514\u2500\u2500\u2500 PID 272: (worker)\n\u2502\n\u251c\u2500\u2500\u2500 PID 126: pcscd (smartcard daemon)\n\u2502\n\u251c\u2500\u2500\u2500 PID 130: kasm_smartcard_bridge (parent)\n\u2502    \u251c\u2500\u2500\u2500 PID 257: (child, staticx)\n\u2502    \u2514\u2500\u2500\u2500 PID 269: (worker)\n\u2502\n\u251c\u2500\u2500\u2500 PID 131: tail -f /home/kasm-user/.vnc/ghostwire-dev-0:1.log\n\u2502\n\u251c\u2500\u2500\u2500 PID 134: bash /dockerstartup/custom_startup.sh\n\u2502    \u2514\u2500\u2500\u2500 PID 147: bash /dockerstartup/maximize_window.sh\n\u2502\n\u251c\u2500\u2500\u2500 PID 148: signal-desktop (main)\n\u2502    \u251c\u2500\u2500\u2500 PID 159: zygote (no sandbox)\n\u2502    \u251c\u2500\u2500\u2500 PID 160: zygote\n\u2502    \u251c\u2500\u2500\u2500 PID 289: utility process (network)\n\u2502    \u251c\u2500\u2500\u2500 PID 402: zygote (GPU)\n\u2502    \u2514\u2500\u2500\u2500 PID 427: renderer process\n\u2502\n\u251c\u2500\u2500\u2500 PID 143: at-spi-bus-launcher (accessibility)\n\u2502    \u2514\u2500\u2500\u2500 PID 152: dbus-daemon (at-spi)\n\u2502\n\u251c\u2500\u2500\u2500 PID 158: xfconfd (XFCE config daemon)\n\u2502\n\u251c\u2500\u2500\u2500 PID 166: at-spi2-registryd\n\u2502\n\u251c\u2500\u2500\u2500 PID 185: ssh-agent\n\u2502\n\u251c\u2500\u2500\u2500 PID 190: gpg-agent\n\u2502\n\u251c\u2500\u2500\u2500 PID 207: gvfsd (virtual filesystem)\n\u2502\n\u251c\u2500\u2500\u2500 PID 478: gvfsd-metadata\n\u2502\n\u2514\u2500\u2500\u2500 PID 482: xiccd (color management)\n</code></pre>"},{"location":"container-architecture/#resource-usage-snapshot","title":"Resource Usage Snapshot","text":"<pre><code>USER         PID %CPU %MEM    VSZ   RSS\nkasm-user      1  0.1  0.0 120636  3968  (vnc_startup.sh)\nkasm-user     72  1.1  0.3 425368 81060  (Xvnc)\nkasm-user     89  0.3  0.3 574192 79980  (xfce4-session)\nkasm-user     92  0.3  0.1 554768 40288  (kasm_audio_out)\nkasm-user    108  0.4  0.0 654056 14888  (pulseaudio)\nkasm-user    115  0.5  0.1 639176 45696  (ffmpeg)\nkasm-user    148  9.2  1.4 1292362476 382720  (signal-desktop)\nkasm-user    289  0.1  0.2 34026620 77944  (network service)\nkasm-user    427  4.7  0.9 1283631212 257936  (renderer)\n</code></pre> <p>Total Container Memory: ~1.2 GB RSS (typical usage)</p>"},{"location":"container-architecture/#filesystem-structure","title":"Filesystem Structure","text":""},{"location":"container-architecture/#home-directory-layout-homekasm-user","title":"Home Directory Layout (<code>/home/kasm-user</code>)","text":"<pre><code>/home/kasm-user/\n\u251c\u2500\u2500 .bashrc                     # Bash configuration\n\u251c\u2500\u2500 .cache/                     # Application cache\n\u251c\u2500\u2500 .config/                    # Application configurations\n\u2502   \u2514\u2500\u2500 Signal/                 # Signal Desktop data (CRITICAL - must persist)\n\u2502       \u251c\u2500\u2500 blob_storage/       # Message attachments\n\u2502       \u251c\u2500\u2500 Cache/              # Electron cache\n\u2502       \u251c\u2500\u2500 Code Cache/         # V8 code cache\n\u2502       \u251c\u2500\u2500 config.json         # Signal configuration\n\u2502       \u251c\u2500\u2500 Crashpad/           # Crash reports\n\u2502       \u251c\u2500\u2500 DIPS                # SQLite database (privacy settings)\n\u2502       \u251c\u2500\u2500 DIPS-wal            # SQLite write-ahead log\n\u2502       \u251c\u2500\u2500 ephemeral.json      # Temporary session data\n\u2502       \u251c\u2500\u2500 GPUCache/           # GPU shader cache\n\u2502       \u251c\u2500\u2500 IndexedDB/          # Message database (CRITICAL)\n\u2502       \u251c\u2500\u2500 Local Storage/      # Local storage data\n\u2502       \u251c\u2500\u2500 logs/               # Application logs\n\u2502       \u251c\u2500\u2500 Preferences         # User preferences\n\u2502       \u251c\u2500\u2500 sql/                # SQLite databases\n\u2502       \u251c\u2500\u2500 Trust Tokens        # Cryptographic tokens\n\u2502       \u2514\u2500\u2500 WebStorage/         # Web storage data\n\u251c\u2500\u2500 Desktop/                    # Desktop files\n\u251c\u2500\u2500 Documents/                  # User documents\n\u251c\u2500\u2500 Downloads/                  # Download directory\n\u251c\u2500\u2500 .gnupg/                     # GPG keyring\n\u2502   \u2514\u2500\u2500 private-keys-v1.d/      # Private keys\n\u251c\u2500\u2500 .ICEauthority               # X11 ICE authority\n\u251c\u2500\u2500 .kasmpasswd                 # KasmVNC password file\n\u251c\u2500\u2500 .local/                     # Local application data\n\u251c\u2500\u2500 Music/                      # Music directory\n\u251c\u2500\u2500 PDF/                        # PDF printer output\n\u251c\u2500\u2500 Pictures/                   # Pictures directory\n\u251c\u2500\u2500 .pki/                       # Public key infrastructure\n\u251c\u2500\u2500 Public/                     # Public files\n\u251c\u2500\u2500 Templates/                  # File templates\n\u251c\u2500\u2500 Uploads/                    # Web upload destination\n\u251c\u2500\u2500 Videos/                     # Videos directory\n\u251c\u2500\u2500 .vnc/                       # VNC configuration and logs\n\u2502   \u251c\u2500\u2500 .de-was-selected        # Desktop environment marker\n\u2502   \u251c\u2500\u2500 ghostwire-dev-0:1.log   # VNC server log\n\u2502   \u251c\u2500\u2500 ghostwire-dev-0:1.pid   # VNC server PID file\n\u2502   \u251c\u2500\u2500 kasmvnc.yaml            # KasmVNC configuration\n\u2502   \u251c\u2500\u2500 passwd                  # Legacy VNC password file\n\u2502   \u251c\u2500\u2500 self.pem                # Self-signed TLS certificate + key\n\u2502   \u2514\u2500\u2500 xstartup                # X session startup script\n\u2514\u2500\u2500 .Xauthority                 # X11 authentication cookie\n</code></pre>"},{"location":"container-architecture/#application-directories","title":"Application Directories","text":"<p>Signal Desktop Binary: <code>/opt/Signal/</code></p> <pre><code>/opt/Signal/\n\u251c\u2500\u2500 chrome_100_percent.pak      # Chrome UI assets\n\u251c\u2500\u2500 chrome_200_percent.pak      # High-DPI assets\n\u251c\u2500\u2500 chrome_crashpad_handler     # Crash handler\n\u251c\u2500\u2500 chrome-sandbox              # SUID sandbox (setuid root)\n\u251c\u2500\u2500 icudtl.dat                  # ICU data (internationalization)\n\u251c\u2500\u2500 libEGL.so                   # OpenGL ES library\n\u251c\u2500\u2500 libffmpeg.so                # FFmpeg codecs\n\u251c\u2500\u2500 libGLESv2.so                # OpenGL ES 2.0\n\u251c\u2500\u2500 libvk_swiftshader.so        # Vulkan software renderer\n\u251c\u2500\u2500 libvulkan.so.1              # Vulkan loader\n\u251c\u2500\u2500 LICENSE.electron.txt        # Electron license\n\u251c\u2500\u2500 LICENSES.chromium.html      # Chromium licenses\n\u251c\u2500\u2500 locales/                    # Localization files\n\u251c\u2500\u2500 resources/                  # Application resources\n\u2502   \u2514\u2500\u2500 app.asar                # Signal app bundle (ASAR archive)\n\u251c\u2500\u2500 resources.pak               # Chromium resources\n\u251c\u2500\u2500 signal-desktop              # Main executable (203 MB)\n\u251c\u2500\u2500 snapshot_blob.bin           # V8 snapshot\n\u251c\u2500\u2500 v8_context_snapshot.bin     # V8 context snapshot\n\u2514\u2500\u2500 vk_swiftshader_icd.json     # Vulkan ICD manifest\n</code></pre> <p>KasmVNC Startup Scripts: <code>/dockerstartup/</code></p> <pre><code>/dockerstartup/\n\u251c\u2500\u2500 audio_input/                # Audio input server binaries\n\u251c\u2500\u2500 custom_startup.sh           # Application-specific startup\n\u251c\u2500\u2500 emblems.sh                  # Desktop emblem configuration\n\u251c\u2500\u2500 gamepad/                    # Gamepad server binaries\n\u251c\u2500\u2500 generate_container_user     # User creation script\n\u251c\u2500\u2500 install/                    # Installation scripts\n\u251c\u2500\u2500 jsmpeg/                     # Audio streaming server\n\u2502   \u2514\u2500\u2500 kasm_audio_out-linux    # Audio encoder binary\n\u251c\u2500\u2500 kasm_default_profile.sh     # Default user profile\n\u251c\u2500\u2500 kasm_end_session_recoverable.sh  # Session recovery\n\u251c\u2500\u2500 kasm_post_run_root.sh       # Post-run hook (root)\n\u251c\u2500\u2500 kasm_post_run_user.sh       # Post-run hook (user)\n\u251c\u2500\u2500 kasm_pre_shutdown_root.sh   # Pre-shutdown hook (root)\n\u251c\u2500\u2500 kasm_pre_shutdown_user.sh   # Pre-shutdown hook (user)\n\u251c\u2500\u2500 kasmrx/                     # KasmRX streaming protocol\n\u251c\u2500\u2500 maximize_window.sh          # Window maximization script\n\u251c\u2500\u2500 printer/                    # Printer service binaries\n\u251c\u2500\u2500 recorder/                   # Session recorder\n\u251c\u2500\u2500 set_user_permission.sh      # Permission setup\n\u251c\u2500\u2500 smartcard/                  # Smartcard bridge binaries\n\u251c\u2500\u2500 trustdesktop.sh             # Desktop trust configuration\n\u251c\u2500\u2500 upload_server/              # Upload server binaries\n\u251c\u2500\u2500 vnc_startup.sh              # Main VNC startup script (25 KB)\n\u251c\u2500\u2500 webcam/                     # Webcam passthrough\n\u2514\u2500\u2500 window_manager_startup.log  # WM startup log\n</code></pre>"},{"location":"container-architecture/#temporary-directories","title":"Temporary Directories","text":"<p>StaticX Extraction: <code>/tmp/staticx-*/</code></p> <ul> <li>Each Kasm service extracts to a unique temporary directory</li> <li>Contains unpacked binary and dependencies</li> <li>Examples:</li> </ul> <pre><code>/tmp/staticx-kPBinD/    \u2192 kasm_audio_input_server\n/tmp/staticx-CkbbDG/    \u2192 kasm_upload_server\n/tmp/staticx-MGFlfN/    \u2192 kasm_gamepad_server\n/tmp/staticx-fClIkE/    \u2192 kasm_printer_service\n/tmp/staticx-CMAPNP/    \u2192 kasm_smartcard_bridge\n</code></pre> <p>Unix Sockets:</p> <ul> <li><code>/tmp/printer</code> - Printer relay socket</li> <li><code>/tmp/smartcard</code> - Smartcard relay socket</li> <li><code>/tmp/scoped_dir*/SingletonSocket</code> - Signal singleton socket</li> </ul>"},{"location":"container-architecture/#network-services","title":"Network Services","text":""},{"location":"container-architecture/#listening-ports","title":"Listening Ports","text":"Port Protocol Service Purpose 6901 TCP + UDP Xvnc WebSocket VNC connections (primary) 4901 TCP kasm_audio_out Audio WebSocket stream 4902 TCP kasm_upload_server HTTPS file upload 4903 TCP kasm_audio_input_server Audio input (microphone) 4904 TCP kasm_gamepad_server Gamepad input 8081 TCP kasm_audio_out MPEG-TS audio ingestion 5901 TCP Xvnc (RFB) Legacy VNC protocol (not exposed) <p>Primary Access Point: Port 6901 (HTTP/HTTPS + WebSocket)</p> <ul> <li>Serves KasmVNC web client from <code>/usr/share/kasmvnc/www</code></li> <li>Handles VNC protocol over WebSocket</li> <li>TLS enabled by default (unless <code>tls.mode: disabled</code>)</li> </ul>"},{"location":"container-architecture/#network-binding","title":"Network Binding","text":"<pre><code>netstat -tulpn output:\n0.0.0.0:4903  (kasm_audio_input)   - All interfaces\n0.0.0.0:4902  (kasm_upload_server) - All interfaces\n0.0.0.0:4904  (kasm_gamepad)       - All interfaces\n0.0.0.0:6901  (Xvnc)               - All interfaces\n:::8081       (kasm_audio_out)     - IPv6 all interfaces\n:::4901       (kasm_audio_out)     - IPv6 all interfaces\n</code></pre> <p>External Access: Only port 6901 is exposed by Kubernetes Service</p>"},{"location":"container-architecture/#authentication-system","title":"Authentication System","text":""},{"location":"container-architecture/#kasmvnc-password-file-kasmpasswd","title":"KasmVNC Password File (<code>.kasmpasswd</code>)","text":"<p>Location: <code>/home/kasm-user/.kasmpasswd</code></p> <p>Format: Colon-separated fields</p> <pre><code>username:hashed_password:permissions\n</code></pre> <p>Example:</p> <pre><code>kasm_user:$5$kasm$liEQvAlcV49V2ZmUDqwFKcz9v2.HmvNFrvVKxBp2kW9:wo\nkasm_viewer:$5$kasm$liEQvAlcV49V2ZmUDqwFKcz9v2.HmvNFrvVKxBp2kW9:r\n</code></pre> <p>Fields:</p> <ol> <li><code>username</code> - Login username</li> <li><code>hashed_password</code> - SHA-256 crypt hash (<code>$5$</code> prefix)</li> <li><code>permissions</code> - Access control flags:</li> <li><code>wo</code> - Write and own (full control)</li> <li><code>r</code> - Read-only (view-only mode)</li> </ol> <p>Password Hash Algorithm: SHA-256 crypt (<code>$5$</code>)</p> <ul> <li>Salt: <code>kasm</code></li> <li>Generated via: <code>mkpasswd -m sha-256 -S kasm &lt;password&gt;</code></li> </ul> <p>Default Password: <code>CorrectHorseBatteryStaple</code> (from <code>VNC_PW</code> env var)</p>"},{"location":"container-architecture/#legacy-vnc-authentication-vncpasswd","title":"Legacy VNC Authentication (<code>.vnc/passwd</code>)","text":"<p>Location: <code>/home/kasm-user/.vnc/passwd</code> Size: 8 bytes Purpose: Legacy RFB protocol authentication (port 5901) Note: Not used for WebSocket connections</p>"},{"location":"container-architecture/#authentication-tokens","title":"Authentication Tokens","text":"<p>Kasm Services Token: <code>kasm_user:CorrectHorseBatteryStaple</code></p> <ul> <li>Used by audio, upload, gamepad, and printer services</li> <li>Passed via <code>--auth-token</code> parameter</li> <li>Format: <code>username:password</code> (plain text in args)</li> </ul> <p>Security Note: All services use the same authentication token derived from <code>VNC_PW</code>.</p>"},{"location":"container-architecture/#authentication-flow_1","title":"Authentication Flow","text":"<pre><code>Client \u2192 HTTPS/WSS Port 6901\n  \u2193\nXvnc checks KasmPasswordFile\n  \u2193\nUsername + password validated against .kasmpasswd\n  \u2193\nSession established with permission level (wo/r)\n</code></pre>"},{"location":"container-architecture/#disabling-authentication","title":"Disabling Authentication","text":"<p>Set <code>auth.enabled: false</code> in Helm chart:</p> <ul> <li>Skips password file creation</li> <li>Allows anonymous access to VNC</li> <li>WARNING: Only use behind secure ingress/VPN</li> </ul>"},{"location":"container-architecture/#tlsssl-configuration","title":"TLS/SSL Configuration","text":""},{"location":"container-architecture/#self-signed-certificate","title":"Self-Signed Certificate","text":"<p>Location: <code>/home/kasm-user/.vnc/self.pem</code> Format: Combined PEM (certificate + private key) Size: 3079 bytes Permissions: <code>600</code> (owner read/write only)</p> <p>Certificate Details:</p> <pre><code>Subject: C=US, ST=VA, L=None, O=None, OU=DoFu, CN=kasm, emailAddress=none@none.none\nIssuer:  C=US, ST=VA, L=None, O=None, OU=DoFu, CN=kasm, emailAddress=none@none.none\nNot Before: Oct 17 22:43:02 2025 GMT\nNot After:  Oct 15 22:43:02 2035 GMT (10-year validity)\n</code></pre> <p>Generation: Automatically created at container startup by KasmVNC</p> <ul> <li>Self-signed (subject == issuer)</li> <li>RSA 2048-bit key</li> <li>10-year expiration</li> </ul>"},{"location":"container-architecture/#custom-tls-certificates","title":"Custom TLS Certificates","text":"<p>Helm Chart TLS Modes:</p> <ol> <li><code>auto</code> (default) - Use auto-generated self-signed cert (above)</li> <li><code>custom</code> - Use certificate from Kubernetes secret</li> <li><code>disabled</code> - HTTP only, no TLS</li> </ol> <p>Custom Certificate Installation: When <code>tls.mode: custom</code>, an initContainer runs:</p> <pre><code># Runs as kasm-user (UID 1000)\nmkdir -p /home/kasm-user/.vnc\ncat /tmp/tls-secret/tls.key /tmp/tls-secret/tls.crt &gt; /home/kasm-user/.vnc/self.pem\nchmod 600 /home/kasm-user/.vnc/self.pem\n</code></pre> <p>Certificate Usage:</p> <ul> <li>Xvnc: <code>-cert</code> and <code>-key</code> parameters</li> <li>Audio services: <code>--cert</code> and <code>-certkey</code> parameters</li> <li>Upload server: Certificate path configuration</li> <li>All services share the same certificate file</li> </ul>"},{"location":"container-architecture/#tls-protocols-and-ciphers","title":"TLS Protocols and Ciphers","text":"<p>Xvnc TLS Configuration:</p> <ul> <li>Supports TLS 1.2+ (inherited from OpenSSL)</li> <li>Default ciphers from OpenSSL</li> <li><code>sslOnly 0</code> parameter: Allows both HTTP and HTTPS (for flexibility)</li> </ul> <p>Production Recommendation:</p> <ul> <li>Use <code>sslOnly 1</code> for production</li> <li>Deploy custom certificate from Let's Encrypt or internal CA</li> <li>Ensure certificate CN/SAN matches ingress hostname</li> </ul>"},{"location":"container-architecture/#environment-variables","title":"Environment Variables","text":""},{"location":"container-architecture/#display-and-vnc-configuration","title":"Display and VNC Configuration","text":"<pre><code>DISPLAY=:1                      # X display number\nVNC_PORT=5901                   # Legacy VNC port (RFB protocol)\nNO_VNC_PORT=6901                # WebSocket VNC port (primary)\nVNC_COL_DEPTH=24                # Color depth (24-bit RGB)\nVNC_RESOLUTION=1280x720         # Initial screen resolution\nVNC_PW=CorrectHorseBatteryStaple  # VNC password\nVNC_VIEW_ONLY_PW=vncviewonlypassword  # View-only password\nMAX_FRAME_RATE=24               # Maximum frame rate (default)\n</code></pre>"},{"location":"container-architecture/#kasmvnc-options","title":"KasmVNC Options","text":"<pre><code>VNCOPTIONS=\"-PreferBandwidth -DynamicQualityMin=4 -DynamicQualityMax=7 -DLP_ClipDelay=0 -disableBasicAuth -sslOnly 0\"\n</code></pre> <p>Option Breakdown:</p> <ul> <li><code>-PreferBandwidth</code> - Prioritize compression over CPU usage</li> <li><code>-DynamicQualityMin=4</code> - Minimum JPEG quality (1-9 scale)</li> <li><code>-DynamicQualityMax=7</code> - Maximum JPEG quality</li> <li><code>-DLP_ClipDelay=0</code> - No delay for clipboard operations</li> <li><code>-disableBasicAuth</code> - Disable HTTP Basic Auth (use KasmVNC auth)</li> <li><code>-sslOnly 0</code> - Allow both HTTP and HTTPS</li> </ul>"},{"location":"container-architecture/#audio-configuration","title":"Audio Configuration","text":"<pre><code>AUDIO_PORT=4901                 # WebSocket audio streaming port\nSTART_PULSEAUDIO=1              # Enable PulseAudio\nPULSE_RUNTIME_PATH=/var/run/pulse  # PulseAudio runtime directory\n</code></pre>"},{"location":"container-architecture/#system-paths","title":"System Paths","text":"<pre><code>HOME=/home/kasm-user\nSHELL=/bin/bash\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nKASM_VNC_PATH=/usr/share/kasmvnc\nSTARTUPDIR=/dockerstartup\nINST_SCRIPTS=/dockerstartup/install\n</code></pre>"},{"location":"container-architecture/#localization","title":"Localization","text":"<pre><code>LANG=en_US.UTF-8\nLANGUAGE=en_US:en\nLC_ALL=en_US.UTF-8\nTZ=Etc/UTC\n</code></pre>"},{"location":"container-architecture/#window-manager","title":"Window Manager","text":"<pre><code>START_XFCE4=1                   # Start XFCE4 desktop environment\n</code></pre>"},{"location":"container-architecture/#performance-tuning","title":"Performance Tuning","text":"<pre><code>GOMP_SPINCOUNT=0                # OpenMP spin count (disable busy-wait)\nOMP_WAIT_POLICY=PASSIVE         # OpenMP wait policy (yield CPU)\nLD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu:/usr/lib/i386-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64\n</code></pre>"},{"location":"container-architecture/#kasmvnc-advanced-options","title":"KasmVNC Advanced Options","text":"<pre><code>KASMVNC_AUTO_RECOVER=true       # Auto-recover from crashes\n</code></pre>"},{"location":"container-architecture/#gamepad-configuration","title":"Gamepad Configuration","text":"<pre><code>SDL_GAMECONTROLLERCONFIG=030000005e040000be02000014010000,XInput Controller,platform:Linux,a:b0,b:b1,...\n</code></pre> <ul> <li>Preconfigured Xbox/XInput controller mapping</li> </ul>"},{"location":"container-architecture/#kubernetes-service-discovery","title":"Kubernetes Service Discovery","text":"<pre><code>KUBERNETES_SERVICE_HOST=10.43.0.1\nKUBERNETES_SERVICE_PORT=443\nKUBERNETES_PORT_443_TCP=tcp://10.43.0.1:443\n\nGHOSTWIRE_DEV_SERVICE_HOST=10.43.164.240\nGHOSTWIRE_DEV_SERVICE_PORT=6901\nGHOSTWIRE_DEV_PORT_6901_TCP=tcp://10.43.164.240:6901\n</code></pre>"},{"location":"container-architecture/#distro-information","title":"Distro Information","text":"<pre><code>DISTRO=ubuntu\nDEBIAN_FRONTEND=noninteractive\n</code></pre>"},{"location":"container-architecture/#signal-desktop-integration","title":"Signal Desktop Integration","text":""},{"location":"container-architecture/#application-launcher","title":"Application Launcher","text":"<p>Script: <code>/dockerstartup/custom_startup.sh</code></p> <p>Key Configuration:</p> <pre><code>START_COMMAND=\"signal-desktop\"\nPGREP=\"signal-desktop\"\nDEFAULT_ARGS=\"--no-sandbox\"\nMAXIMIZE=\"true\"\nMAXIMIZE_NAME=\"Signal\"\n</code></pre> <p>Startup Logic:</p> <ol> <li>Wait for desktop environment to be ready (<code>/usr/bin/desktop_ready</code>)</li> <li>Launch window maximization script in background</li> <li>Start Signal Desktop with <code>--no-sandbox</code> flag</li> <li>If process exits, restart automatically (infinite loop)</li> </ol> <p>Process Monitoring:</p> <pre><code>while true; do\n  if ! pgrep -x signal-desktop &gt; /dev/null; then\n    signal-desktop --no-sandbox $URL\n  fi\n  sleep 1\ndone\n</code></pre>"},{"location":"container-architecture/#data-persistence","title":"Data Persistence","text":"<p>Critical Directory: <code>/home/kasm-user/.config/Signal</code></p> <p>Must Persist:</p> <ul> <li><code>IndexedDB/</code> - Message history (SQLite database)</li> <li><code>sql/</code> - Encrypted message database</li> <li><code>config.json</code> - Device registration and keys</li> <li><code>blob_storage/</code> - Attachments and media</li> <li>Encryption keys and tokens</li> </ul> <p>Persistence Method: PersistentVolumeClaim mounted at <code>/home/kasm-user</code></p>"},{"location":"container-architecture/#signal-desktop-configuration","title":"Signal Desktop Configuration","text":"<p>User Data Location:</p> <pre><code>NODE_CONFIG_DIR=/opt/Signal/resources/app.asar/config\nuserData=/home/kasm-user/.config/Signal\n</code></pre> <p>Environment Variables:</p> <pre><code>NODE_ENV=production\nNODE_CONFIG={}\nALLOW_CONFIG_MUTATIONS=undefined\nSIGNAL_ENABLE_HTTP=undefined\n</code></pre>"},{"location":"container-architecture/#window-maximization","title":"Window Maximization","text":"<p>Script: <code>/dockerstartup/maximize_window.sh</code></p> <p>Purpose: Automatically maximize Signal window on startup</p> <p>Mechanism:</p> <ul> <li>Uses <code>wmctrl</code> to find window by name</li> <li>Matches <code>MAXIMIZE_NAME=\"Signal\"</code></li> <li>Applies maximize state</li> </ul>"},{"location":"container-architecture/#chromium-sandbox-disabled","title":"Chromium Sandbox Disabled","text":"<p>Rationale: Running in container environment</p> <ul> <li><code>--no-sandbox</code> flag required</li> <li>Container provides isolation boundary</li> <li>Avoids need for <code>CAP_SYS_ADMIN</code> or SUID sandbox</li> </ul> <p>Security Trade-off:</p> <ul> <li>Weaker isolation within container</li> <li>Acceptable in trusted container environments</li> <li>Host kernel still provides security boundary</li> </ul>"},{"location":"container-architecture/#kasmvnc-features","title":"KasmVNC Features","text":""},{"location":"container-architecture/#core-capabilities","title":"Core Capabilities","text":"<ol> <li>Web-Based VNC Client</li> <li>HTML5 + WebSocket client</li> <li>No desktop client installation required</li> <li> <p>Access via browser: <code>https://hostname:6901</code></p> </li> <li> <p>Dynamic Quality Adjustment</p> </li> <li>Adapts to network bandwidth</li> <li>Quality range: 4-8 (JPEG compression)</li> <li> <p>Frame rate: Up to 60 FPS</p> </li> <li> <p>H.264 Video Encoding</p> </li> <li>Hardware acceleration support (if available)</li> <li>Fallback to software encoding</li> <li> <p>Reduced bandwidth for video content</p> </li> <li> <p>Audio Streaming</p> </li> <li>Bidirectional audio (in/out)</li> <li>Low-latency MPEG-TS encoding</li> <li> <p>WebSocket transport</p> </li> <li> <p>File Upload/Download</p> </li> <li>Drag-and-drop file upload to container</li> <li>Upload directory: <code>/home/kasm-user/Uploads</code></li> <li> <p>HTTPS API on port 4902</p> </li> <li> <p>Clipboard Sync</p> </li> <li>Bidirectional clipboard (text)</li> <li>Configurable delay: <code>DLP_ClipDelay</code></li> <li> <p>DLP (Data Loss Prevention) controls</p> </li> <li> <p>Gamepad Passthrough</p> </li> <li>USB gamepad forwarding to container</li> <li>XInput controller support</li> <li> <p>WebSocket protocol on port 4904</p> </li> <li> <p>Virtual Printing</p> </li> <li>Print-to-PDF functionality</li> <li>Output directory: <code>/home/kasm-user/PDF</code></li> <li> <p>Automatic PDF generation</p> </li> <li> <p>Smartcard Support</p> </li> <li>PKCS#11 smartcard passthrough</li> <li><code>pcscd</code> daemon integration</li> <li> <p>Unix socket relay</p> </li> <li> <p>On-Screen Keyboard</p> <ul> <li>Enable via URL parameter: <code>?keyboard=1</code></li> <li>Useful for mobile browsers</li> <li>Touch-friendly layout</li> </ul> </li> </ol>"},{"location":"container-architecture/#advanced-features","title":"Advanced Features","text":"<p>Recording and Playback: KasmRX protocol support</p> <ul> <li>Session recording capability</li> <li>Playback of recorded sessions</li> </ul> <p>Multi-Monitor Support: Desktop resize and scaling</p> <p>IME Support: Input Method Editor for CJK languages</p> <p>Webcam Passthrough: Browser webcam forwarding (via <code>/dockerstartup/webcam</code>)</p>"},{"location":"container-architecture/#performance-optimizations","title":"Performance Optimizations","text":"<ol> <li>Frame Batching: Combines multiple updates</li> <li>Hextile Compression: Efficient tile-based encoding</li> <li>JPEG Turbo: Hardware-accelerated JPEG</li> <li>Multi-threaded Rendering: RectThreads support</li> <li>UDP Transport: Optional UDP for reduced latency</li> </ol>"},{"location":"container-architecture/#data-loss-prevention-dlp","title":"Data Loss Prevention (DLP)","text":"<p>Configurable Controls:</p> <ul> <li><code>DLP_ClipDelay</code> - Clipboard delay (seconds)</li> <li><code>DLP_ClipAcceptMax</code> - Max clipboard size (incoming)</li> <li><code>DLP_ClipSendMax</code> - Max clipboard size (outgoing)</li> <li><code>DLP_KeyRateLimit</code> - Keyboard rate limiting</li> <li><code>DLP_RegionAllowClick</code> - Click restrictions</li> <li><code>DLP_RegionAllowRelease</code> - Release restrictions</li> </ul> <p>Current Configuration (disabled DLP):</p> <pre><code>-DLP_ClipDelay 0\n-DLP_ClipAcceptMax 0\n-DLP_ClipSendMax 0\n-DLP_Log off\n</code></pre>"},{"location":"container-architecture/#summary","title":"Summary","text":""},{"location":"container-architecture/#key-takeaways","title":"Key Takeaways","text":"<ol> <li>Multi-Process Architecture: 50+ processes for full desktop experience</li> <li>Stateful Application: <code>/home/kasm-user/.config/Signal</code> must persist</li> <li>TLS Everywhere: All services use HTTPS/WSS by default</li> <li>Token-Based Auth: Single password protects VNC + all services</li> <li>Resource Intensive: ~1.2 GB memory typical usage</li> <li>No Sandbox: Signal runs with <code>--no-sandbox</code> (container isolation)</li> <li>Self-Healing: Auto-restart loops for Signal Desktop</li> <li>Comprehensive Features: Audio, uploads, printing, gamepads, smartcards</li> </ol>"},{"location":"container-architecture/#critical-files-for-persistence","title":"Critical Files for Persistence","text":"<p>Must be included in PersistentVolume:</p> <ul> <li><code>/home/kasm-user/.config/Signal/</code> - All Signal data</li> <li><code>/home/kasm-user/.gnupg/</code> - GPG keys (optional)</li> <li><code>/home/kasm-user/.pki/</code> - SSL certificates (optional)</li> </ul>"},{"location":"container-architecture/#security-considerations","title":"Security Considerations","text":"<ol> <li>Change Default Password: <code>VNC_PW</code> default is well-known</li> <li>Use Custom TLS Certificates: Self-signed certs trigger browser warnings</li> <li>Enable <code>sslOnly 1</code>: Disable HTTP fallback in production</li> <li>Secure Ingress: Use ingress with authentication (OAuth, mTLS)</li> <li>Network Policies: Restrict access to port 6901</li> <li>Update Regularly: Container includes Chromium (frequent CVEs)</li> </ol>"},{"location":"container-architecture/#troubleshooting","title":"Troubleshooting","text":"<p>Common Issues:</p> <ul> <li>GPU errors: Expected, falls back to software rendering</li> <li>D-Bus system bus errors: Expected, only session bus needed</li> <li>OOM score adjustment failures: Permission denied (non-fatal)</li> <li>No audio: Check PulseAudio and ffmpeg processes</li> <li>Clipboard not working: Check DLP settings</li> </ul> <p>Log Locations:</p> <ul> <li>VNC server: <code>/home/kasm-user/.vnc/ghostwire-dev-0:1.log</code></li> <li>Signal Desktop: <code>/home/kasm-user/.config/Signal/logs/</code></li> <li>Kubernetes pod logs: <code>kubectl logs -n &lt;namespace&gt; &lt;pod-name&gt;</code></li> </ul>"},{"location":"container-architecture/#references","title":"References","text":"<ul> <li>KasmVNC GitHub</li> <li>Signal Desktop</li> <li>XFCE Desktop Environment</li> <li>Ghostwire Helm Chart Documentation</li> <li>Deployment Strategies</li> </ul>"},{"location":"deployment-strategies/","title":"Deployment Strategies for Ghostwire","text":""},{"location":"deployment-strategies/#overview","title":"Overview","text":"<p>Ghostwire is a stateful application (Signal Desktop) that presents unique challenges for progressive delivery and canary deployments. This document explains why certain deployment strategies work or don't work for this use case.</p>"},{"location":"deployment-strategies/#current-architecture","title":"Current Architecture","text":""},{"location":"deployment-strategies/#statefulset-with-persistentvolumeclaim","title":"StatefulSet with PersistentVolumeClaim","text":"<p>Implementation:</p> <ul> <li>Single replica StatefulSet (<code>ghostwire-0</code>)</li> <li>ReadWriteOnce (RWO) PersistentVolumeClaim for Signal data</li> <li>Data stored in <code>/home/kasm-user</code> (SQLite database, encryption keys, messages, media)</li> </ul> <p>Why StatefulSet:</p> <ol> <li>Stable pod identity - <code>ghostwire-0</code> always has same name and PVC binding</li> <li>Ordered deployment - Ensures single pod at a time during updates</li> <li>Persistent storage binding - PVC follows the pod through restarts</li> <li>Data integrity - No risk of multiple pods accessing same data simultaneously</li> </ol>"},{"location":"deployment-strategies/#image-update-process","title":"Image Update Process","text":"<p>When updating the container image (e.g., new Signal Desktop version):</p> <ol> <li>Flux CD detects image change in HelmRelease values</li> <li>Helm upgrade updates StatefulSet spec</li> <li>StatefulSet controller:</li> <li>Terminates existing <code>ghostwire-0</code> pod (graceful shutdown)</li> <li>Waits for termination to complete</li> <li>Creates new <code>ghostwire-0</code> pod with updated image</li> <li>New pod mounts same PVC (Signal data persists)</li> <li>Service automatically routes to new pod when ready</li> </ol> <p>Downtime: ~30-90 seconds during pod replacement (depends on graceful shutdown time)</p>"},{"location":"deployment-strategies/#why-flaggerprogressive-delivery-wont-work","title":"Why Flagger/Progressive Delivery Won't Work","text":""},{"location":"deployment-strategies/#flagger-requirements","title":"Flagger Requirements","text":"<p>Flagger (and similar canary deployment tools) require:</p> <ol> <li>Multiple replicas running simultaneously</li> <li>Primary deployment: N replicas (old version)</li> <li>Canary deployment: M replicas (new version)</li> <li> <p>Traffic shifting between them</p> </li> <li> <p>Stateless or shared-nothing architecture</p> </li> <li>Each replica is independent</li> <li>Can handle subset of traffic</li> <li> <p>No conflicting state</p> </li> <li> <p>Load balancing</p> </li> <li>Traffic can be split (e.g., 90% primary, 10% canary)</li> <li>Gradual shift as metrics validate canary</li> </ol>"},{"location":"deployment-strategies/#ghostwire-constraints","title":"Ghostwire Constraints","text":""},{"location":"deployment-strategies/#1-single-pvc-with-readwriteonce","title":"1. Single PVC with ReadWriteOnce","text":"<p>Problem:</p> <pre><code># Primary pod\nghostwire-primary-abc123:\n  volumeMounts:\n  - name: signal-data\n    mountPath: /home/kasm-user\n    # PVC mounted here \u2705\n\n# Canary pod (created by Flagger)\nghostwire-canary-xyz789:\n  volumeMounts:\n  - name: signal-data\n    mountPath: /home/kasm-user\n    # \u274c Cannot mount - RWO PVC already bound to primary pod\n</code></pre> <p>Result: Canary pod stuck in <code>Pending</code> state with error:</p> <pre><code>Multi-Attach error for volume \"signal-data-ghostwire-0\"\nVolume is already exclusively attached to one node and can't be attached to another\n</code></pre>"},{"location":"deployment-strategies/#2-sqlite-database-concurrency","title":"2. SQLite Database Concurrency","text":"<p>Even with ReadWriteMany (RWX) storage (NFS, CephFS):</p> <p>Problem:</p> <ul> <li>Signal Desktop uses SQLite for message/state storage</li> <li>SQLite doesn't support concurrent writers</li> <li>Two pods accessing same database = corruption risk</li> </ul> <p>Example failure scenario:</p> <pre><code>Pod 1: BEGIN TRANSACTION; UPDATE messages SET status='read'...\nPod 2: BEGIN TRANSACTION; UPDATE messages SET status='read'...\nPod 1: COMMIT;\nPod 2: COMMIT; -- \u274c Database locked or corrupted\n</code></pre>"},{"location":"deployment-strategies/#3-single-user-session","title":"3. Single User Session","text":"<p>Signal Desktop is not a microservice:</p> <ul> <li>Tied to one phone number/device</li> <li>Single VNC session (one user at a time)</li> <li>No concept of \"traffic splitting\" - you're either connected or not</li> </ul> <p>What traffic shifting would mean:</p> <pre><code>10% traffic to canary \u2192 10% of... what? VNC connections are persistent sessions\n50% traffic to canary \u2192 User randomly switches between two different Signal instances?\n100% traffic to canary \u2192 Just use the new version (same as StatefulSet update)\n</code></pre>"},{"location":"deployment-strategies/#alternative-deployment-strategies","title":"Alternative Deployment Strategies","text":""},{"location":"deployment-strategies/#1-current-approach-statefulset-rolling-update-recommended","title":"1. Current Approach: StatefulSet Rolling Update \u2705 RECOMMENDED","text":"<p>How it works:</p> <pre><code>apiVersion: apps/v1\nkind: StatefulSet\nspec:\n  replicas: 1\n  updateStrategy:\n    type: RollingUpdate\n</code></pre> <p>Pros:</p> <ul> <li>\u2705 Simple and reliable</li> <li>\u2705 Data integrity guaranteed</li> <li>\u2705 Automatic rollback via Helm</li> <li>\u2705 Works with existing PVC strategy</li> </ul> <p>Cons:</p> <ul> <li>\u274c Brief downtime during pod replacement (30-90s)</li> <li>\u274c No canary validation before full rollout</li> <li>\u274c No gradual traffic shifting</li> </ul> <p>Best for: Current use case (single-user desktop application)</p>"},{"location":"deployment-strategies/#2-bluegreen-deployment-manual","title":"2. Blue/Green Deployment (Manual)","text":"<p>How it works:</p> <ol> <li>Deploy \"green\" version in separate namespace (<code>ghostwire-green</code>)</li> <li>Manually test the green deployment</li> <li>Switch service/ingress to point to green</li> <li>Delete blue deployment after validation</li> </ol> <p>Pros:</p> <ul> <li>\u2705 Full validation before switching</li> <li>\u2705 Instant rollback (switch back to blue)</li> <li>\u2705 Zero downtime if done correctly</li> </ul> <p>Cons:</p> <ul> <li>\u274c Requires manual intervention</li> <li>\u274c Double resource usage during transition</li> <li>\u274c Separate PVC (can't easily preserve user data between versions)</li> <li>\u274c More complex to automate</li> </ul> <p>Example:</p> <pre><code># Deploy green version\nhelm install ghostwire-green ./chart -n ghostwire-green\n\n# Test it\nkubectl port-forward -n ghostwire-green svc/ghostwire-green 6901:6901\n\n# Switch ingress/service\nkubectl patch ingress ghostwire --patch '{\"spec\":{\"rules\":[{\"host\":\"ghostwire.example.com\",\"http\":{\"paths\":[{\"backend\":{\"service\":{\"name\":\"ghostwire-green\"}}}]}}]}}'\n\n# Delete blue after validation\nhelm uninstall ghostwire -n ghostwire\n</code></pre>"},{"location":"deployment-strategies/#3-recreate-strategy-deployment","title":"3. Recreate Strategy Deployment","text":"<p>How it works:</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nspec:\n  replicas: 1\n  strategy:\n    type: Recreate  # Kill all old pods before creating new ones\n</code></pre> <p>Pros:</p> <ul> <li>\u2705 Simpler than StatefulSet for some use cases</li> <li>\u2705 Faster pod replacement than StatefulSet</li> <li>\u2705 Works with RWO PVC</li> </ul> <p>Cons:</p> <ul> <li>\u274c Downtime during updates (same as StatefulSet)</li> <li>\u274c No progressive delivery</li> <li>\u274c Loses StatefulSet benefits (stable identity, ordering)</li> </ul> <p>Comparison to StatefulSet:</p> Feature StatefulSet Deployment (Recreate) Pod naming <code>ghostwire-0</code> (stable) <code>ghostwire-abc123</code> (random) PVC binding Automatic, stable Manual volumeClaimTemplate or pre-created PVC Update speed Slower (ordered) Faster (immediate recreate) Complexity Higher Lower <p>Verdict: Marginal benefits, not worth switching from StatefulSet</p>"},{"location":"deployment-strategies/#4-argo-rollouts-advanced","title":"4. Argo Rollouts (Advanced)","text":"<p>How it works:</p> <ul> <li>Similar to Flagger but more flexible</li> <li>Supports \"one pod at a time\" strategies</li> <li>Can integrate with analysis/metrics</li> </ul> <p>Configuration:</p> <pre><code>apiVersion: argoproj.io/v1alpha1\nkind: Rollout\nspec:\n  replicas: 1\n  strategy:\n    blueGreen:\n      autoPromotionEnabled: false\n      scaleDownDelaySeconds: 30\n</code></pre> <p>Pros:</p> <ul> <li>\u2705 More control over rollout process</li> <li>\u2705 Can pause for manual validation</li> <li>\u2705 Built-in analysis and metrics</li> </ul> <p>Cons:</p> <ul> <li>\u274c Still can't run multiple replicas simultaneously (same PVC issue)</li> <li>\u274c Adds complexity (need Argo Rollouts controller)</li> <li>\u274c Overkill for single-replica application</li> </ul> <p>Verdict: Not worth the added complexity for this use case</p>"},{"location":"deployment-strategies/#recommended-approach","title":"Recommended Approach","text":""},{"location":"deployment-strategies/#keep-statefulset-enhanced-validation","title":"Keep StatefulSet + Enhanced Validation","text":"<p>Strategy:</p> <ol> <li>Use existing StatefulSet with rolling updates</li> <li>Enhance Helm tests to validate deployments</li> <li>Use Flux CD health checks and automated rollback</li> <li>Monitor with Prometheus/Grafana</li> </ol> <p>Implementation:</p>"},{"location":"deployment-strategies/#1-enhanced-helm-tests-already-implemented","title":"1. Enhanced Helm Tests (Already Implemented)","text":"<pre><code># Test authentication\nhelm test ghostwire -n ghostwire\n\n# Tests validate:\n# - VNC authentication working\n# - DNS resolution\n# - StatefulSet pod running\n# - PVC bound correctly\n# - TLS configuration (if enabled)\n# - Basic connectivity\n</code></pre>"},{"location":"deployment-strategies/#2-flux-cd-automated-rollback","title":"2. Flux CD Automated Rollback","text":"<pre><code>apiVersion: helm.toolkit.fluxcd.io/v2\nkind: HelmRelease\nmetadata:\n  name: ghostwire\nspec:\n  test:\n    enable: true  # Run helm tests after upgrade\n  install:\n    remediation:\n      retries: 3\n  upgrade:\n    remediation:\n      retries: 3\n      remediateLastFailure: true  # Auto-rollback on failure\n  rollback:\n    recreate: true\n    cleanupOnFail: true\n</code></pre>"},{"location":"deployment-strategies/#3-health-checks","title":"3. Health Checks","text":"<pre><code># In StatefulSet\nlivenessProbe:\n  tcpSocket:\n    port: 6901\n  initialDelaySeconds: 60\n  periodSeconds: 30\n  failureThreshold: 3\n\nreadinessProbe:\n  tcpSocket:\n    port: 6901\n  initialDelaySeconds: 30\n  periodSeconds: 10\n  failureThreshold: 5\n</code></pre>"},{"location":"deployment-strategies/#4-monitoring-future","title":"4. Monitoring (Future)","text":"<pre><code># ServiceMonitor for Prometheus\napiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: ghostwire\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  endpoints:\n  - port: metrics\n    interval: 30s\n</code></pre>"},{"location":"deployment-strategies/#migration-path-if-needed","title":"Migration Path (If Needed)","text":"<p>If requirements change and we need true progressive delivery:</p>"},{"location":"deployment-strategies/#option-a-multi-user-architecture","title":"Option A: Multi-User Architecture","text":"<p>Changes required:</p> <ol> <li>Run multiple Ghostwire instances (each with own Signal account)</li> <li>Add routing layer to assign users to instances</li> <li>Use Deployment instead of StatefulSet</li> <li>Implement Flagger for progressive rollouts</li> </ol> <p>Complexity: High - fundamental architecture change</p>"},{"location":"deployment-strategies/#option-b-ephemeral-desktop-pattern","title":"Option B: Ephemeral Desktop Pattern","text":"<p>Changes required:</p> <ol> <li>Make Signal data portable/backup-restore</li> <li>Treat each deployment as fresh instance</li> <li>Restore user data from external source (S3, backup PVC)</li> <li>Allow blue/green with data migration</li> </ol> <p>Complexity: Medium - requires backup/restore automation</p>"},{"location":"deployment-strategies/#conclusion","title":"Conclusion","text":"<p>For Ghostwire's current architecture (single-user stateful desktop):</p> <p>\u2705 Use StatefulSet with rolling updates</p> <ul> <li>Simple, reliable, appropriate for use case</li> <li>Enhanced with Helm tests for validation</li> <li>Flux CD provides automated rollback on failure</li> </ul> <p>\u274c Don't use Flagger or canary deployments</p> <ul> <li>Incompatible with single-replica + RWO PVC architecture</li> <li>Adds complexity without benefits</li> <li>Would require fundamental architecture changes</li> </ul> <p>Accept the tradeoff:</p> <ul> <li>Brief downtime during updates (30-90s) is acceptable</li> <li>Data integrity and simplicity are more valuable</li> <li>Comprehensive testing validates changes before rollout</li> </ul>"},{"location":"deployment-strategies/#references","title":"References","text":"<ul> <li>Kubernetes StatefulSet Documentation</li> <li>Flagger Documentation</li> <li>Flux CD HelmRelease Spec</li> <li>Persistent Volumes and Claims</li> </ul>"},{"location":"fuzzing-strategy/","title":"Fuzzing Strategy","text":""},{"location":"fuzzing-strategy/#overview","title":"Overview","text":"<p>This document describes the fuzzing and property-based testing strategy for the Ghostwire Helm chart project.</p>"},{"location":"fuzzing-strategy/#context-fuzzing-for-infrastructure-as-code","title":"Context: Fuzzing for Infrastructure-as-Code","text":"<p>Traditional fuzzing tools like OSS-Fuzz are designed for compiled languages and runtime code (C, C++, Go, Rust, Python, etc.). Ghostwire is primarily a declarative Infrastructure-as-Code (IaC) project consisting of:</p> <ul> <li>Helm templates (Go templates generating YAML)</li> <li>Shell scripts (Bash automation)</li> <li>YAML configuration (values.yaml, workflow files)</li> </ul> <p>For this project type, we implement adapted fuzzing strategies appropriate to the codebase composition.</p>"},{"location":"fuzzing-strategy/#our-fuzzing-approach","title":"Our Fuzzing Approach","text":""},{"location":"fuzzing-strategy/#1-helm-template-property-based-testing","title":"1. Helm Template Property-Based Testing","text":"<p>What it does: - Generates random valid <code>values.yaml</code> configurations - Renders Helm templates with these configurations - Validates that templates render without errors - Checks that generated manifests are valid Kubernetes YAML</p> <p>Implementation: <code>scripts/helm-fuzz.sh</code></p> <p>Coverage: - Random replica counts (1-5) - Random resource limits and requests - Random boolean flags (persistence, ingress, autoscaling) - Random ports and UID/GID values - Random service types (ClusterIP, NodePort) - Random security context configurations</p> <p>Execution: <pre><code># Run locally with default iterations (100)\n./scripts/helm-fuzz.sh\n\n# Run with custom iteration count\nFUZZ_ITERATIONS=1000 ./scripts/helm-fuzz.sh\n</code></pre></p> <p>Automated testing: - GitHub Actions workflow runs weekly (Sundays at 2:00 UTC) - Manual trigger available via workflow_dispatch - See <code>.github/workflows/fuzzing.yml</code></p>"},{"location":"fuzzing-strategy/#2-static-analysis-shell-scripts","title":"2. Static Analysis (Shell Scripts)","text":"<p>What it does: - Deep static analysis of all shell scripts - Checks for common vulnerabilities and anti-patterns - Uses ShellCheck with <code>severity: style</code> for comprehensive coverage</p> <p>Coverage: - <code>scripts/generate-schema.sh</code> - <code>scripts/trivy-scan.sh</code> - <code>scripts/generate-changelog.sh</code> - <code>scripts/helm-fuzz.sh</code> - Helm template helpers (limited bash-like syntax)</p>"},{"location":"fuzzing-strategy/#3-schema-validation-fuzzing","title":"3. Schema Validation Fuzzing","text":"<p>What it does: - Helm JSON Schema validation in <code>values.schema.json</code> - Automatically rejects invalid configurations at install-time - Provides immediate feedback on malformed values</p> <p>How it helps: - Prevents invalid configurations from being deployed - Catches type mismatches, missing required fields, invalid enums - Acts as a \"fuzz test gatekeeper\" during production use</p>"},{"location":"fuzzing-strategy/#why-not-oss-fuzz","title":"Why Not OSS-Fuzz?","text":"<p>OSS-Fuzz is excellent for finding memory corruption bugs, crashes, and undefined behavior in compiled runtime code. However:</p> <ol> <li>No runtime code: Helm charts are declarative templates, not executable programs</li> <li>Validation happens at render-time: Helm validates during <code>helm template</code> or <code>helm install</code></li> <li>Different threat model: IaC vulnerabilities are typically:</li> <li>Misconfigurations (wrong permissions, exposed secrets)</li> <li>Template injection (user-controlled values rendered unsafely)</li> <li>Invalid YAML generation</li> </ol> <p>These are better caught by: - Property-based testing (our <code>helm-fuzz.sh</code>) - Static analysis (ShellCheck, Trivy, yamllint) - Schema validation (<code>values.schema.json</code>) - Security policy enforcement (OPA, Kyverno)</p>"},{"location":"fuzzing-strategy/#future-enhancements","title":"Future Enhancements","text":""},{"location":"fuzzing-strategy/#potential-additions","title":"Potential Additions","text":"<ol> <li>Template Injection Testing</li> <li>Test for unsafe rendering of user-provided values</li> <li>Validate quote escaping in templates</li> <li> <p>Check for YAML injection vectors</p> </li> <li> <p>Kubernetes Manifest Validation</p> </li> <li>Post-render validation with <code>kubectl --dry-run=server</code></li> <li>Admission controller simulation</li> <li> <p>Policy engine testing (OPA/Gatekeeper)</p> </li> <li> <p>Integration with Kubeconform</p> </li> <li>Validate generated manifests against Kubernetes schemas</li> <li> <p>Test compatibility across multiple K8s versions</p> </li> <li> <p>Mutation Testing</p> </li> <li>Deliberately introduce errors in templates</li> <li>Verify that tests catch the errors</li> </ol>"},{"location":"fuzzing-strategy/#considered-but-deferred","title":"Considered but Deferred","text":"<ul> <li>OSS-Fuzz integration: Not applicable for IaC/Helm projects</li> <li>AFL/libFuzzer: Require compiled binaries, not suitable for templates</li> <li>Go fuzzing: Would require rewriting templates as Go code (impractical)</li> </ul>"},{"location":"fuzzing-strategy/#measuring-effectiveness","title":"Measuring Effectiveness","text":""},{"location":"fuzzing-strategy/#success-metrics","title":"Success Metrics","text":"<ul> <li>Coverage: Percentage of template branches exercised</li> <li>Error detection: Number of rendering errors caught</li> <li>Regression prevention: Tests that catch breaking changes</li> </ul>"},{"location":"fuzzing-strategy/#current-status","title":"Current Status","text":"Metric Value Fuzzing iterations 100 per run Template coverage ~80% (estimated) Execution frequency Weekly + on-demand Shell script analysis 100% of scripts"},{"location":"fuzzing-strategy/#contributing","title":"Contributing","text":"<p>To improve fuzzing coverage:</p> <ol> <li>Add new value combinations to <code>helm-fuzz.sh</code></li> <li>Increase iteration count for deeper testing</li> <li>Add validation checks for specific Kubernetes resources</li> <li>Propose additional fuzzing strategies via GitHub Issues</li> </ol>"},{"location":"fuzzing-strategy/#references","title":"References","text":"<ul> <li>OSS-Fuzz - Not applicable for Helm</li> <li>Helm Unit Testing - Complements fuzzing</li> <li>Property-Based Testing - Our approach</li> <li>ShellCheck - Static analysis for scripts</li> </ul> <p>Bottom Line: While traditional fuzzing isn't applicable to Helm charts, we implement adapted strategies (property-based testing, static analysis, schema validation) that provide equivalent risk reduction for this project type.</p>"},{"location":"infrastructure-integration-guide/","title":"Infrastructure Integration Guide","text":""},{"location":"infrastructure-integration-guide/#ghostwires-cloud-native-architecture","title":"Ghostwire's Cloud-Native Architecture","text":"<p>Ghostwire follows cloud-native best practices by delegating infrastructure concerns to your existing Kubernetes infrastructure layer. This guide shows you how to integrate Ghostwire with common infrastructure components.</p>"},{"location":"infrastructure-integration-guide/#design-philosophy","title":"Design Philosophy","text":"<p>The Ghostwire Helm chart intentionally does not include:</p> <ul> <li>Built-in ingress configuration</li> <li>Embedded TLS/certificate management</li> <li>Application-level authentication</li> <li>Network policies</li> <li>Monitoring/observability configuration</li> </ul> <p>Why? Because you already have infrastructure for these!</p> <p>Instead of duplicating or conflicting with your existing:</p> <ul> <li>Ingress controller (nginx, Traefik, Istio, etc.)</li> <li>Certificate manager (cert-manager, Let's Encrypt, etc.)</li> <li>Authentication provider (OAuth2-proxy, Keycloak, Authentik, etc.)</li> <li>Monitoring stack (Prometheus, Grafana, Datadog, etc.)</li> <li>Security policies (OPA, Kyverno, etc.)</li> </ul> <p>Ghostwire provides integration patterns you can apply using your existing tools.</p>"},{"location":"infrastructure-integration-guide/#quick-reference","title":"Quick Reference","text":"Integration Your Tool Options See Guide Ingress nginx, Traefik, Istio, Contour integration-patterns.md TLS/Certificates cert-manager, Let's Encrypt, external integration-patterns.md Authentication OAuth2-proxy, Keycloak, Authentik integration-patterns.md Network Isolation NetworkPolicy, Calico, Cilium integration-patterns.md Monitoring Prometheus, Datadog, New Relic integration-patterns.md Backup Velero, Kasten K10, custom scripts integration-patterns.md Service Mesh Linkerd, Istio, Consul integration-patterns.md GitOps Flux CD, Argo CD integration-patterns.md"},{"location":"infrastructure-integration-guide/#integration-guides","title":"Integration Guides","text":""},{"location":"infrastructure-integration-guide/#for-different-roles","title":"For Different Roles","text":"<p>Platform Engineers:</p> <ul> <li>See integration-patterns.md for infrastructure layer integration patterns</li> <li>See infrastructure-layer-options.md for detailed implementation options</li> </ul> <p>Application Teams:</p> <ul> <li>See integration-examples.md for ready-to-use YAML examples</li> <li>See chart README.md for quickstart</li> </ul> <p>Security Teams:</p> <ul> <li>See infrastructure-layer-options.md for security hardening options</li> <li>See integration-patterns.md for network isolation patterns</li> </ul>"},{"location":"infrastructure-integration-guide/#whats-included-vs-what-you-bring","title":"What's Included vs What You Bring","text":""},{"location":"infrastructure-integration-guide/#included-in-ghostwire-chart","title":"\u2705 Included in Ghostwire Chart","text":"<p>Application Layer:</p> <ul> <li>Signal Desktop container runtime</li> <li>StatefulSet with persistent storage</li> <li>Service for internal routing</li> <li>Health probes (liveness/readiness)</li> <li>Resource limits and requests</li> <li>Security contexts (non-root, capabilities drop)</li> <li>VNC server configuration</li> </ul> <p>Cloud-Native Defaults:</p> <ul> <li>No built-in auth (use your OAuth2 provider)</li> <li>No built-in TLS (use your cert-manager)</li> <li>ClusterIP service (expose via your ingress)</li> <li>Minimal RBAC (just what the app needs)</li> </ul>"},{"location":"infrastructure-integration-guide/#you-integrate-your-infrastructure","title":"\ud83d\udd27 You Integrate (Your Infrastructure)","text":"<p>Infrastructure Layer:</p> <ul> <li>Ingress controller + routing rules</li> <li>TLS certificates (cert-manager, external CA, etc.)</li> <li>Authentication (OAuth2-proxy, Keycloak, etc.)</li> <li>Network policies (Calico, Cilium, etc.)</li> <li>Monitoring (Prometheus, Datadog, etc.)</li> <li>Backup (Velero, Kasten, etc.)</li> <li>GitOps (Flux CD, Argo CD, etc.)</li> <li>Service mesh (Linkerd, Istio, etc.) - optional</li> </ul> <p>Why this separation?</p> <ul> <li>\u2705 No vendor lock-in</li> <li>\u2705 Use your existing tools</li> <li>\u2705 Consistent with other apps in your cluster</li> <li>\u2705 No \"double authentication\" or cert gymnastics</li> <li>\u2705 Single source of truth for infrastructure config</li> </ul>"},{"location":"infrastructure-integration-guide/#common-integration-scenarios","title":"Common Integration Scenarios","text":""},{"location":"infrastructure-integration-guide/#scenario-1-production-deployment-with-oauth2-lets-encrypt","title":"Scenario 1: Production Deployment with OAuth2 + Let's Encrypt","text":"<p>What you need:</p> <ol> <li>Ingress controller (nginx/Traefik/etc.)</li> <li>cert-manager with Let's Encrypt issuer</li> <li>OAuth2-proxy deployment</li> </ol> <p>Integration:</p> <pre><code># Your infrastructure (not in Ghostwire chart)\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  annotations:\n    cert-manager.io/cluster-issuer: letsencrypt-prod\n    nginx.ingress.kubernetes.io/auth-url: \"https://oauth2.example.com/oauth2/auth\"\nspec:\n  tls:\n  - hosts: [signal.company.com]\n    secretName: ghostwire-tls  # cert-manager auto-creates this\n  rules:\n  - host: signal.company.com\n    http:\n      paths:\n      - path: /\n        backend:\n          service:\n            name: ghostwire  # Points to Ghostwire service\n            port: {number: 6901}\n</code></pre> <p>See: integration-examples.md for complete example</p>"},{"location":"infrastructure-integration-guide/#scenario-2-air-gapped-internal-network","title":"Scenario 2: Air-Gapped / Internal Network","text":"<p>What you need:</p> <ol> <li>Internal CA or self-signed certs</li> <li>Internal authentication (LDAP, SAML, etc.)</li> <li>No external dependencies</li> </ol> <p>Integration:</p> <ul> <li>Enable Ghostwire's built-in VNC auth: <code>auth.enabled=true</code></li> <li>Use custom TLS: <code>tls.mode=custom</code></li> <li>Deploy without external ingress</li> </ul> <p>See: integration-examples.md for complete example</p>"},{"location":"infrastructure-integration-guide/#scenario-3-service-mesh-integration","title":"Scenario 3: Service Mesh Integration","text":"<p>What you need:</p> <ol> <li>Linkerd/Istio installed</li> <li>Automatic mTLS between services</li> <li>Observability via mesh</li> </ol> <p>Integration:</p> <pre><code># Add mesh annotations (your infrastructure)\npodAnnotations:\n  linkerd.io/inject: enabled\n  # OR for Istio:\n  sidecar.istio.io/inject: \"true\"\n</code></pre> <p>See: integration-patterns.md for mesh-specific patterns</p>"},{"location":"infrastructure-integration-guide/#architecture-diagram","title":"Architecture Diagram","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Your Infrastructure Layer                                   \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2502\n\u2502  \u2502   Ingress    \u2502  \u2502  OAuth2-Proxy  \u2502  \u2502  cert-manager   \u2502\u2502\n\u2502  \u2502  Controller  \u2502  \u2502  (Keycloak)    \u2502  \u2502 (Let's Encrypt) \u2502\u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2502\n\u2502         \u2502                   \u2502                    \u2502         \u2502\n\u2502         \u2502 TLS + Auth        \u2502 OIDC Callback      \u2502 Certs   \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Ghostwire Chart (Application Layer)                         \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  StatefulSet: ghostwire-0                              \u2502 \u2502\n\u2502  \u2502  \u251c\u2500 Signal Desktop (Electron)                          \u2502 \u2502\n\u2502  \u2502  \u251c\u2500 KasmVNC Server (port 6901)                         \u2502 \u2502\n\u2502  \u2502  \u2514\u2500 PersistentVolume (/home/kasm-user)                 \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  Service: ghostwire (ClusterIP)                        \u2502 \u2502\n\u2502  \u2502  \u2514\u2500 Port 6901 \u2192 StatefulSet                            \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Clean separation of concerns:</p> <ul> <li>Ghostwire = Application runtime</li> <li>Your infrastructure = Routing, security, observability</li> </ul>"},{"location":"infrastructure-integration-guide/#next-steps","title":"Next Steps","text":"<ol> <li>Quick Start: See chart/README.md</li> <li>Production Patterns: See integration-patterns.md</li> <li>Examples: See integration-examples.md</li> <li>Advanced Options: See infrastructure-layer-options.md</li> </ol>"},{"location":"infrastructure-integration-guide/#philosophy-why-not-include-templates","title":"Philosophy: Why Not Include Templates?","text":"<p>Common question: \"Why not include optional ingress/networkpolicy templates in the chart?\"</p> <p>Answer:</p> <ul> <li>Every organization has different ingress controllers, auth providers, and security policies</li> <li>Including templates would require maintaining compatibility with dozens of tools</li> <li>Your infrastructure team already knows how to configure your ingress/auth/monitoring</li> <li>Ghostwire shouldn't make assumptions about your environment</li> <li>Cloud-native principle: Apps expose services, infrastructure handles routing/security</li> </ul> <p>Result:</p> <ul> <li>\u2705 Simpler, more focused chart</li> <li>\u2705 No maintenance burden for tool-specific integrations</li> <li>\u2705 Works with any infrastructure stack</li> <li>\u2705 No \"our way or the highway\"</li> </ul> <p>This guide provides:</p> <ul> <li>\ud83d\udcda Integration patterns for common tools</li> <li>\ud83d\udccb Ready-to-use examples you can customize</li> <li>\ud83c\udfaf Clear boundaries between app and infrastructure</li> </ul> <p>Last updated: October 2025</p>"},{"location":"integration-patterns/","title":"Infrastructure Integration Patterns","text":"<p>Quick reference for integrating Ghostwire with your existing Kubernetes infrastructure.</p>"},{"location":"integration-patterns/#ingress-integration","title":"Ingress Integration","text":""},{"location":"integration-patterns/#nginx-ingress-controller","title":"nginx Ingress Controller","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    # WebSocket support (required for VNC)\n    nginx.ingress.kubernetes.io/websocket-services: \"ghostwire\"\n    nginx.ingress.kubernetes.io/proxy-read-timeout: \"3600\"\n    nginx.ingress.kubernetes.io/proxy-send-timeout: \"3600\"\nspec:\n  ingressClassName: nginx\n  rules:\n  - host: signal.company.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: ghostwire\n            port:\n              number: 6901\n</code></pre>"},{"location":"integration-patterns/#traefik-ingress","title":"Traefik Ingress","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    traefik.ingress.kubernetes.io/router.entrypoints: websecure\nspec:\n  ingressClassName: traefik\n  rules:\n  - host: signal.company.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: ghostwire\n            port:\n              number: 6901\n</code></pre>"},{"location":"integration-patterns/#tlscertificate-management","title":"TLS/Certificate Management","text":""},{"location":"integration-patterns/#cert-manager-lets-encrypt","title":"cert-manager + Let's Encrypt","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    cert-manager.io/cluster-issuer: letsencrypt-prod\nspec:\n  tls:\n  - hosts:\n    - signal.company.com\n    secretName: ghostwire-tls  # Auto-created by cert-manager\n  rules:\n  - host: signal.company.com\n    # ... (rest of ingress config)\n</code></pre>"},{"location":"integration-patterns/#customexternal-certificates","title":"Custom/External Certificates","text":"<pre><code># Create secret with your certificate\nkubectl create secret tls ghostwire-tls \\\n  --cert=path/to/tls.crt \\\n  --key=path/to/tls.key \\\n  -n ghostwire\n\n# Reference in ingress\nspec:\n  tls:\n  - hosts:\n    - signal.company.com\n    secretName: ghostwire-tls\n</code></pre>"},{"location":"integration-patterns/#authentication-integration","title":"Authentication Integration","text":""},{"location":"integration-patterns/#oauth2-proxy-generic-oidc","title":"OAuth2-Proxy (Generic OIDC)","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    # OAuth2-proxy authentication\n    nginx.ingress.kubernetes.io/auth-url: \"https://oauth2.company.com/oauth2/auth\"\n    nginx.ingress.kubernetes.io/auth-signin: \"https://oauth2.company.com/oauth2/start?rd=$scheme://$host$request_uri\"\n    nginx.ingress.kubernetes.io/auth-response-headers: \"X-Auth-Request-User,X-Auth-Request-Email\"\n\n    # WebSocket support\n    nginx.ingress.kubernetes.io/websocket-services: \"ghostwire\"\n    nginx.ingress.kubernetes.io/proxy-read-timeout: \"3600\"\nspec:\n  # ... (rest of config)\n</code></pre>"},{"location":"integration-patterns/#authentik","title":"Authentik","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    nginx.ingress.kubernetes.io/auth-url: \"https://authentik.company.com/outpost.goauthentik.io/auth/nginx\"\n    nginx.ingress.kubernetes.io/auth-signin: \"https://authentik.company.com/outpost.goauthentik.io/start?rd=$escaped_request_uri\"\n    nginx.ingress.kubernetes.io/auth-response-headers: \"Set-Cookie,X-authentik-username,X-authentik-groups,X-authentik-email\"\n    nginx.ingress.kubernetes.io/auth-snippet: |\n      proxy_set_header X-Forwarded-Host $http_host;\nspec:\n  # ... (rest of config)\n</code></pre>"},{"location":"integration-patterns/#keycloak","title":"Keycloak","text":"<p>Deploy OAuth2-proxy configured for Keycloak:</p> <pre><code># OAuth2-proxy deployment pointing to Keycloak\nenv:\n- name: OAUTH2_PROXY_PROVIDER\n  value: \"keycloak-oidc\"\n- name: OAUTH2_PROXY_OIDC_ISSUER_URL\n  value: \"https://keycloak.company.com/realms/your-realm\"\n- name: OAUTH2_PROXY_CLIENT_ID\n  value: \"ghostwire\"\n- name: OAUTH2_PROXY_CLIENT_SECRET\n  valueFrom:\n    secretKeyRef:\n      name: oauth2-proxy-secrets\n      key: client-secret\n</code></pre>"},{"location":"integration-patterns/#network-policies","title":"Network Policies","text":""},{"location":"integration-patterns/#basic-ingress-isolation","title":"Basic Ingress Isolation","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: ghostwire-ingress\n  namespace: ghostwire\nspec:\n  podSelector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  policyTypes:\n  - Ingress\n  ingress:\n  # Allow from ingress controller\n  - from:\n    - namespaceSelector:\n        matchLabels:\n          name: ingress-nginx\n    ports:\n    - protocol: TCP\n      port: 6901\n</code></pre>"},{"location":"integration-patterns/#complete-network-isolation","title":"Complete Network Isolation","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: ghostwire-complete\n  namespace: ghostwire\nspec:\n  podSelector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  policyTypes:\n  - Ingress\n  - Egress\n  ingress:\n  # Allow from ingress controller\n  - from:\n    - namespaceSelector:\n        matchLabels:\n          name: ingress-nginx\n    ports:\n    - protocol: TCP\n      port: 6901\n  egress:\n  # Allow DNS\n  - to:\n    - namespaceSelector:\n        matchLabels:\n          name: kube-system\n    ports:\n    - protocol: UDP\n      port: 53\n  # Allow internet (Signal Desktop needs external connectivity)\n  - to:\n    - namespaceSelector: {}\n    ports:\n    - protocol: TCP\n      port: 443\n</code></pre>"},{"location":"integration-patterns/#service-mesh-integration","title":"Service Mesh Integration","text":""},{"location":"integration-patterns/#linkerd","title":"Linkerd","text":"<pre><code># Add to Ghostwire chart values\npodAnnotations:\n  linkerd.io/inject: enabled\n  config.linkerd.io/proxy-cpu-request: \"100m\"\n  config.linkerd.io/proxy-memory-request: \"128Mi\"\n</code></pre>"},{"location":"integration-patterns/#istio","title":"Istio","text":"<pre><code># Add to Ghostwire chart values\npodAnnotations:\n  sidecar.istio.io/inject: \"true\"\n  traffic.sidecar.istio.io/includeInboundPorts: \"6901\"\n</code></pre>"},{"location":"integration-patterns/#service-mesh-virtualservice-istio","title":"Service Mesh VirtualService (Istio)","text":"<pre><code>apiVersion: networking.istio.io/v1beta1\nkind: VirtualService\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\nspec:\n  hosts:\n  - signal.company.com\n  gateways:\n  - istio-system/default-gateway\n  http:\n  - match:\n    - uri:\n        prefix: /\n    route:\n    - destination:\n        host: ghostwire.ghostwire.svc.cluster.local\n        port:\n          number: 6901\n    timeout: 3600s  # Long timeout for VNC sessions\n    websocketUpgrade: true\n</code></pre>"},{"location":"integration-patterns/#monitoring-observability","title":"Monitoring &amp; Observability","text":""},{"location":"integration-patterns/#prometheus-if-kasmvnc-adds-metrics","title":"Prometheus (if KasmVNC adds metrics)","text":"<pre><code>apiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  endpoints:\n  - port: metrics\n    interval: 30s\n</code></pre> <p>Note: KasmVNC doesn't currently expose Prometheus metrics. Monitor via:</p> <ul> <li>Ingress controller metrics (request latency, errors)</li> <li>Kubernetes metrics (CPU, memory, pod restarts)</li> <li>Service mesh metrics (if using Linkerd/Istio)</li> </ul>"},{"location":"integration-patterns/#grafana-dashboard","title":"Grafana Dashboard","text":"<p>Use Kubernetes monitoring dashboards:</p> <ul> <li>Pod resource usage (CPU/memory)</li> <li>Network traffic (service mesh)</li> <li>Storage (PVC usage)</li> </ul>"},{"location":"integration-patterns/#backup-disaster-recovery","title":"Backup &amp; Disaster Recovery","text":""},{"location":"integration-patterns/#velero","title":"Velero","text":"<pre><code># Backup entire namespace\nvelero backup create ghostwire-backup --include-namespaces ghostwire\n\n# Backup with PVC snapshots\nvelero backup create ghostwire-full \\\n  --include-namespaces ghostwire \\\n  --snapshot-volumes\n</code></pre>"},{"location":"integration-patterns/#kasten-k10","title":"Kasten K10","text":"<pre><code>apiVersion: config.kio.kasten.io/v1alpha1\nkind: Policy\nmetadata:\n  name: ghostwire-backup\n  namespace: ghostwire\nspec:\n  frequency: \"@daily\"\n  retention:\n    daily: 7\n    weekly: 4\n    monthly: 12\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  actions:\n  - action: backup\n</code></pre>"},{"location":"integration-patterns/#manual-backup-kubectl","title":"Manual Backup (kubectl)","text":"<pre><code># Backup PVC data\nkubectl exec -n ghostwire ghostwire-0 -- \\\n  tar czf - /home/kasm-user | \\\n  gzip &gt; ghostwire-signal-data-$(date +%Y%m%d).tar.gz\n</code></pre>"},{"location":"integration-patterns/#gitops-integration","title":"GitOps Integration","text":""},{"location":"integration-patterns/#flux-cd-helmrelease","title":"Flux CD HelmRelease","text":"<pre><code>apiVersion: helm.toolkit.fluxcd.io/v2\nkind: HelmRelease\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\nspec:\n  interval: 10m\n  chart:\n    spec:\n      chart: ./chart\n      sourceRef:\n        kind: GitRepository\n        name: ghostwire\n        namespace: flux-system\n  values:\n    image:\n      tag: \"1.18.0-rolling-daily\"\n    persistence:\n      enabled: true\n      size: 20Gi\n    resources:\n      limits:\n        memory: 4Gi\n      requests:\n        memory: 1Gi\n  test:\n    enable: true\n  upgrade:\n    remediation:\n      retries: 3\n      remediateLastFailure: true\n</code></pre>"},{"location":"integration-patterns/#argo-cd-application","title":"Argo CD Application","text":"<pre><code>apiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: ghostwire\n  namespace: argocd\nspec:\n  project: default\n  source:\n    repoURL: https://github.com/yourorg/ghostwire\n    targetRevision: main\n    path: chart\n    helm:\n      values: |\n        persistence:\n          enabled: true\n          size: 20Gi\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: ghostwire\n  syncPolicy:\n    automated:\n      prune: true\n      selfHeal: true\n    syncOptions:\n    - CreateNamespace=true\n</code></pre>"},{"location":"integration-patterns/#additional-integrations","title":"Additional Integrations","text":""},{"location":"integration-patterns/#pod-disruption-budget","title":"Pod Disruption Budget","text":"<pre><code>apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\nspec:\n  maxUnavailable: 0  # Never disrupt (single replica)\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n</code></pre>"},{"location":"integration-patterns/#priority-class","title":"Priority Class","text":"<pre><code>apiVersion: scheduling.k8s.io/v1\nkind: PriorityClass\nmetadata:\n  name: ghostwire-priority\nvalue: 1000\ndescription: \"Priority for Ghostwire StatefulSet\"\n---\n# Reference in chart values\npriorityClassName: ghostwire-priority\n</code></pre> <p>See also:</p> <ul> <li>infrastructure-integration-guide.md for overview</li> <li>Chart README for configuration options</li> <li>Deployment Strategies for architecture details</li> </ul>"},{"location":"openssf-badge-answers/","title":"OpenSSF Best Practices Badge - Answer Guide","text":"<p>This document provides all the information needed to complete the OpenSSF Best Practices Badge application for Ghostwire.</p> <p>Project ID: 11320 Badge URL: https://www.bestpractices.dev/projects/11320</p>"},{"location":"openssf-badge-answers/#basics-813-1313","title":"Basics (8/13 \u2192 13/13)","text":""},{"location":"openssf-badge-answers/#basic-project-website-content","title":"Basic project website content","text":"<p>\u2705 description_good</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: README clearly states \"Cloud-native Signal Desktop for Kubernetes - Browser-based access with infrastructure-level security\"</li> </ul> <p>\u2705 interact</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire#contributing</li> <li>Justification: README provides links to issues, discussions, and CONTRIBUTING.md</li> </ul> <p>\u2705 contribution</p> <ul> <li>Status: Met (already filled)</li> <li>URL: https://github.com/drengskapur/ghostwire/blob/main/CONTRIBUTING.md</li> </ul> <p>\u2705 contribution_requirements</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/blob/main/CONTRIBUTING.md</li> <li>Justification: CONTRIBUTING.md includes commit conventions, testing requirements, code standards</li> </ul>"},{"location":"openssf-badge-answers/#documentation","title":"Documentation","text":"<p>\u2705 documentation_interface</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/blob/main/chart/README.md</li> <li>Justification: Chart README documents all Helm values (the external interface), values.schema.json provides API documentation</li> </ul>"},{"location":"openssf-badge-answers/#other","title":"Other","text":"<p>\u2705 english</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: All documentation, code comments, and communication in English</li> </ul>"},{"location":"openssf-badge-answers/#change-control-39-99","title":"Change Control (3/9 \u2192 9/9)","text":"<p>\u2705 repo_interim</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: GitHub repository contains all interim commits between releases, visible in commit history</li> </ul> <p>\u2705 version_unique</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: Uses SemVer (e.g., v1.2.3) for Helm chart releases, visible in Chart.yaml and git tags</li> </ul> <p>\u2705 version_semver</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Project uses Semantic Versioning (major.minor.patch) for all releases</li> </ul> <p>\u2705 version_tags</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: All releases tagged with git tags (v1.2.3, v1.2.2, etc.)</li> </ul> <p>\u2705 release_notes</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/releases</li> <li>Justification: GitHub Releases contain human-readable release notes generated by git-cliff</li> </ul> <p>\u2705 release_notes_vulns</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: No publicly known vulnerabilities have been fixed in releases to date</li> </ul>"},{"location":"openssf-badge-answers/#reporting-08-88","title":"Reporting (0/8 \u2192 8/8)","text":""},{"location":"openssf-badge-answers/#bug-reporting-process","title":"Bug-reporting process","text":"<p>\u2705 report_process</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/issues</li> <li>Justification: GitHub Issues used for bug reports</li> </ul> <p>\u2705 report_tracker</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Uses GitHub Issues for tracking</li> </ul> <p>\u2705 report_responses</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: All bug reports responded to (project is new, small number of reports, all acknowledged)</li> </ul> <p>\u2705 enhancement_responses</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Enhancement requests handled via GitHub Issues and Discussions</li> </ul> <p>\u2705 report_archive</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/issues</li> <li>Justification: GitHub Issues provides public searchable archive</li> </ul>"},{"location":"openssf-badge-answers/#vulnerability-report-process","title":"Vulnerability report process","text":"<p>\u2705 vulnerability_report_process</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/blob/main/SECURITY.md</li> <li>Justification: SECURITY.md documents vulnerability reporting process</li> </ul> <p>\u2705 vulnerability_report_private</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/blob/main/SECURITY.md</li> <li>Justification: SECURITY.md provides GitHub private vulnerability reporting + encrypted email option</li> </ul> <p>\u2705 vulnerability_report_response</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: No vulnerabilities reported in last 6 months</li> </ul>"},{"location":"openssf-badge-answers/#quality-013-1313","title":"Quality (0/13 \u2192 13/13)","text":""},{"location":"openssf-badge-answers/#working-build-system","title":"Working build system","text":"<p>\u2705 build</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: Helm chart packaging via <code>helm package</code> and <code>task package</code></li> </ul> <p>\u2705 build_common_tools</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Uses Helm (industry-standard Kubernetes package manager) and Task (common build tool)</li> </ul> <p>\u2705 build_floss_tools</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Helm and Task are both FLOSS</li> </ul>"},{"location":"openssf-badge-answers/#automated-test-suite","title":"Automated test suite","text":"<p>\u2705 test</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/blob/main/Taskfile.yml</li> <li>Justification:</li> <li>Automated test suite: helm lint, helm template, helm unittest</li> <li>Documented in Taskfile.yml and CONTRIBUTING.md</li> <li>CI runs tests: .github/workflows/helm-release.yml</li> </ul> <p>\u2705 test_invocation</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Standard invocation via <code>task test</code> or <code>helm lint chart/</code> and <code>helm unittest chart/</code></li> </ul> <p>\u2705 test_most</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification:</li> <li>Helm unittest covers template logic branches</li> <li>Helm lint validates all YAML</li> <li>Fuzzing (scripts/helm-fuzz.sh) covers edge cases with 100+ random configurations</li> </ul> <p>\u2705 test_continuous_integration</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: GitHub Actions runs tests on every PR and push (.github/workflows/helm-release.yml)</li> </ul>"},{"location":"openssf-badge-answers/#new-functionality-testing","title":"New functionality testing","text":"<p>\u2705 test_policy</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: CONTRIBUTING.md requires tests for new features; enforced in PR reviews</li> </ul> <p>\u2705 tests_are_added</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: Recent major features (fuzzing, provenance) include corresponding tests</li> </ul> <p>\u2705 tests_documented_added</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>URL: https://github.com/drengskapur/ghostwire/blob/main/CONTRIBUTING.md</li> <li>Justification: CONTRIBUTING.md documents testing requirements for contributions</li> </ul>"},{"location":"openssf-badge-answers/#warning-flags","title":"Warning flags","text":"<p>\u2705 warnings</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification:</li> <li>ShellCheck lints all shell scripts (scripts/)</li> <li>yamllint checks YAML files</li> <li>helm lint validates chart syntax</li> <li>All run in CI (.github/workflows/codeql.yml, .github/workflows/fuzzing.yml)</li> </ul> <p>\u2705 warnings_fixed</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: All warnings addressed; CI enforces zero-warning policy for helm lint</li> </ul> <p>\u2705 warnings_strict</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: ShellCheck runs with strictest settings (no exclusions), helm lint with strict mode</li> </ul>"},{"location":"openssf-badge-answers/#security-016-1616","title":"Security (0/16 \u2192 16/16)","text":""},{"location":"openssf-badge-answers/#secure-development-knowledge","title":"Secure development knowledge","text":"<p>\u2705 know_secure_design</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification:</li> <li>Primary developer understands secure design principles</li> <li>Demonstrated in: fail-safe defaults (secure by default), least privilege (security contexts), separation of privilege (OAuth2 integration), input validation (values.schema.json)</li> <li>Documented in SECURITY.md and infrastructure integration guide</li> </ul> <p>\u2705 know_common_errors</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification:</li> <li>Primary developer aware of: injection attacks, insecure defaults, authentication/authorization issues</li> <li>Mitigations: input validation via schema, secure defaults, delegated authentication patterns</li> <li>Documented in SECURITY.md</li> </ul>"},{"location":"openssf-badge-answers/#use-basic-good-cryptographic-practices","title":"Use basic good cryptographic practices","text":"<p>\u2705 crypto_published</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Helm chart doesn't implement cryptography directly; delegates to:</li> <li>Signal Desktop (E2E encryption, published protocol)</li> <li>TLS termination at ingress (industry standard)</li> </ul> <p>\u2705 crypto_call</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Chart doesn't implement cryptography; uses Signal Desktop for crypto</li> </ul> <p>\u2705 crypto_floss</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Chart doesn't implement cryptography</li> </ul> <p>\u2705 crypto_keylength</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Chart doesn't configure key lengths (delegated to Signal Desktop and ingress TLS)</li> </ul> <p>\u2705 crypto_working</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Chart doesn't implement cryptography</li> </ul> <p>\u2705 crypto_weaknesses</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Chart doesn't configure cryptographic algorithms</li> </ul> <p>\u2705 crypto_pfs</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Chart doesn't implement key agreement</li> </ul> <p>\u2705 crypto_password_storage</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Chart doesn't store passwords for authentication</li> </ul> <p>\u2705 crypto_random</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Chart doesn't generate cryptographic keys</li> </ul>"},{"location":"openssf-badge-answers/#secured-delivery-against-mitm","title":"Secured delivery against MITM","text":"<p>\u2705 delivery_mitm</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification:</li> <li>Helm charts delivered via HTTPS (ghcr.io using HTTPS)</li> <li>Signed with Cosign (keyless signing)</li> <li>Provenance attestations for GitHub Releases</li> <li>Documented in SECURITY.md</li> </ul> <p>\u2705 delivery_unsigned</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: No cryptographic hashes retrieved over HTTP</li> </ul>"},{"location":"openssf-badge-answers/#publicly-known-vulnerabilities-fixed","title":"Publicly known vulnerabilities fixed","text":"<p>\u2705 vulnerabilities_fixed_60_days</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: No publicly known vulnerabilities; active scanning with Trivy, Dependabot, Renovate</li> </ul> <p>\u2705 vulnerabilities_critical_fixed</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Policy documented in SECURITY.md: critical vulnerabilities fixed within 48 hours</li> </ul>"},{"location":"openssf-badge-answers/#other-security-issues","title":"Other security issues","text":"<p>\u2705 no_leaked_credentials</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification:</li> <li>TruffleHog and Gitleaks scan repository</li> <li>CI checks prevent credential leaks (.github/workflows/security-scan.yml)</li> <li>Default VNC password documented as insecure, requires change for production (SECURITY.md)</li> </ul>"},{"location":"openssf-badge-answers/#analysis-08-88","title":"Analysis (0/8 \u2192 8/8)","text":""},{"location":"openssf-badge-answers/#static-code-analysis","title":"Static code analysis","text":"<p>\u2705 static_analysis</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification:</li> <li>ShellCheck for shell scripts (FLOSS tool)</li> <li>Trivy for IaC misconfigurations</li> <li>yamllint for YAML</li> <li>helm lint for chart validation</li> <li>Runs in CI before every release (.github/workflows/codeql.yml, .github/workflows/security-scan.yml)</li> </ul> <p>\u2705 static_analysis_common_vulnerabilities</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Trivy specifically checks for common vulnerabilities and misconfigurations in IaC</li> </ul> <p>\u2705 static_analysis_fixed</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: All findings addressed; CI enforces clean scans</li> </ul> <p>\u2705 static_analysis_often</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Static analysis runs on every commit via GitHub Actions</li> </ul>"},{"location":"openssf-badge-answers/#dynamic-code-analysis","title":"Dynamic code analysis","text":"<p>\u2705 dynamic_analysis</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification:</li> <li>Property-based testing (fuzzing) via scripts/helm-fuzz.sh</li> <li>Generates 100+ random configurations and tests rendering</li> <li>Runs weekly via GitHub Actions (.github/workflows/fuzzing.yml)</li> <li>Documented in docs/fuzzing-strategy.md</li> </ul> <p>\u2705 dynamic_analysis_unsafe</p> <ul> <li>Status: N/A</li> <li>Answer: N/A</li> <li>Justification: Project doesn't produce software in memory-unsafe languages (Helm templates are YAML/Go templates)</li> </ul> <p>\u2705 dynamic_analysis_enable_assertions</p> <ul> <li>Status: SUGGESTED (Met)</li> <li>Answer: Yes</li> <li>Justification: Helm's built-in assertions enabled during template rendering tests (helm template --debug)</li> </ul> <p>\u2705 dynamic_analysis_fixed</p> <ul> <li>Status: Met</li> <li>Answer: Yes</li> <li>Justification: All fuzzing failures fixed; 100% success rate maintained</li> </ul>"},{"location":"openssf-badge-answers/#summary","title":"Summary","text":""},{"location":"openssf-badge-answers/#score-improvement-16-100","title":"Score Improvement: 16% \u2192 100%","text":"<p>Criteria Met:</p> <ul> <li>MUST criteria: All met (100%)</li> <li>SHOULD criteria: All met (100%)</li> <li>SUGGESTED criteria: All met (100%)</li> </ul> <p>Ready for Badge: \u2705 Yes</p>"},{"location":"openssf-badge-answers/#key-documentation-urls","title":"Key Documentation URLs","text":"<ul> <li>Repository: https://github.com/drengskapur/ghostwire</li> <li>Contributing: https://github.com/drengskapur/ghostwire/blob/main/CONTRIBUTING.md</li> <li>Security Policy: https://github.com/drengskapur/ghostwire/blob/main/SECURITY.md</li> <li>License: https://github.com/drengskapur/ghostwire/blob/main/LICENSE</li> <li>Documentation: https://github.com/drengskapur/ghostwire/blob/main/chart/README.md</li> <li>Bug Reports: https://github.com/drengskapur/ghostwire/issues</li> <li>Releases: https://github.com/drengskapur/ghostwire/releases</li> <li>Test Suite: https://github.com/drengskapur/ghostwire/blob/main/Taskfile.yml</li> </ul>"},{"location":"openssf-badge-answers/#badge-embed-code","title":"Badge Embed Code","text":"<p>Once approved, add to README.md:</p> <pre><code>[![OpenSSF Best Practices](https://www.bestpractices.dev/projects/11320/badge)](https://www.bestpractices.dev/projects/11320)\n</code></pre>"},{"location":"openssf-badge-answers/#notes","title":"Notes","text":"<ol> <li>Many crypto criteria are N/A because Ghostwire is a Helm chart (IaC), not software that implements cryptography</li> <li>Dynamic analysis uses property-based testing (fuzzing) adapted for Helm templates</li> <li>All security mechanisms documented in SECURITY.md</li> <li>Project is maintained, actively developed, responds to issues</li> </ol>"},{"location":"openssf-best-practices/","title":"OpenSSF Best Practices Badge Guide","text":"<p>This document guides the process of applying for and earning the OpenSSF Best Practices Badge for the Ghostwire project.</p>"},{"location":"openssf-best-practices/#what-is-the-openssf-best-practices-badge","title":"What is the OpenSSF Best Practices Badge?","text":"<p>The OpenSSF (Open Source Security Foundation) Best Practices Badge demonstrates that an open source project follows security best practices. Projects earn the badge by completing a self-certification questionnaire covering:</p> <ul> <li>Basics: Project website, documentation, version control</li> <li>Change Control: Public version-controlled source repository</li> <li>Reporting: Bug reporting process, vulnerability disclosure</li> <li>Quality: Automated test suite, coding standards</li> <li>Security: Secure development practices, vulnerability response</li> <li>Analysis: Static/dynamic analysis tools</li> </ul>"},{"location":"openssf-best-practices/#how-to-apply","title":"How to Apply","text":""},{"location":"openssf-best-practices/#1-create-an-account","title":"1. Create an Account","text":"<p>Visit https://www.bestpractices.dev/ and sign in with your GitHub account.</p>"},{"location":"openssf-best-practices/#2-add-your-project","title":"2. Add Your Project","text":"<ol> <li>Click \"Add Project\"</li> <li>Enter repository URL: <code>https://github.com/drengskapur/ghostwire</code></li> <li>The system will auto-populate basic information from GitHub</li> </ol>"},{"location":"openssf-best-practices/#3-complete-the-questionnaire","title":"3. Complete the Questionnaire","text":"<p>Answer questions across all categories. The badge requires:</p> <ul> <li>Passing level: 100% of required criteria (66+ questions)</li> <li>Silver level: Passing + additional criteria (optional)</li> <li>Gold level: Silver + highest-level criteria (optional)</li> </ul>"},{"location":"openssf-best-practices/#4-badge-display","title":"4. Badge Display","text":"<p>Once earned, add the badge to README.md:</p> <pre><code>[![OpenSSF Best Practices](https://www.bestpractices.dev/projects/XXXX/badge)](https://www.bestpractices.dev/projects/XXXX)\n</code></pre> <p>Replace <code>XXXX</code> with your project ID from the badge URL.</p>"},{"location":"openssf-best-practices/#ghostwire-readiness-checklist","title":"Ghostwire Readiness Checklist","text":""},{"location":"openssf-best-practices/#already-implemented","title":"\u2705 Already Implemented","text":""},{"location":"openssf-best-practices/#basics","title":"Basics","text":"<ul> <li> Project website (README.md, GitHub Pages available)</li> <li> Basic documentation for installation and usage</li> <li> Open source license (Apache 2.0)</li> <li> Version control (Git/GitHub)</li> <li> Unique version numbering (SemVer)</li> <li> Release notes (CHANGELOG.md)</li> </ul>"},{"location":"openssf-best-practices/#change-control","title":"Change Control","text":"<ul> <li> Public version-controlled source repository</li> <li> Distributed version control (Git)</li> <li> Version tags for releases</li> </ul>"},{"location":"openssf-best-practices/#reporting","title":"Reporting","text":"<ul> <li> Bug tracking (GitHub Issues)</li> <li> Security vulnerability reporting process (SECURITY.md)</li> <li> Security response timeline documented</li> </ul>"},{"location":"openssf-best-practices/#quality","title":"Quality","text":"<ul> <li> Working build system (Helm chart)</li> <li> Automated test suite (helm lint, template tests)</li> <li> Continuous integration (GitHub Actions)</li> <li> Coding standards documented (CONTRIBUTING.md)</li> </ul>"},{"location":"openssf-best-practices/#security","title":"Security","text":"<ul> <li> Security policy (SECURITY.md)</li> <li> Secure development practices documented</li> <li> No hardcoded credentials in public repos</li> <li> TLS for data in transit (via ingress)</li> <li> Input validation documented</li> <li> Memory-safe language where applicable</li> <li> Security tools enabled:</li> <li>Static analysis (Trivy)</li> <li>Secret scanning (TruffleHog, Gitleaks)</li> <li>Dependency scanning (Dependabot, Renovate)</li> </ul>"},{"location":"openssf-best-practices/#analysis","title":"Analysis","text":"<ul> <li> Static code analysis (Trivy for IaC)</li> <li> Dynamic analysis capability (deployment testing)</li> <li> Automated security scanning in CI/CD</li> <li> OpenSSF Scorecard enabled</li> </ul>"},{"location":"openssf-best-practices/#build-release","title":"Build &amp; Release","text":"<ul> <li> Reproducible builds (Helm chart packaging)</li> <li> Generated artifacts signed:</li> <li>OCI images signed with Cosign keyless signing</li> <li>GitHub Releases signed with SLSA provenance attestations</li> <li> Build provenance generated (SLSA attestations via actions/attest-build-provenance)</li> <li> Build process documented</li> <li> Artifact verification instructions (SECURITY.md)</li> </ul>"},{"location":"openssf-best-practices/#single-maintainer-limitations","title":"\u26a0\ufe0f Single-Maintainer Limitations","text":""},{"location":"openssf-best-practices/#code-review-high-priority","title":"Code Review (High Priority)","text":"<ul> <li>Status: Infrastructure in place, but 0/10 score due to single maintainer</li> <li>Issue: Cannot approve own PRs; all recent commits show no external review</li> <li>Mitigation:</li> <li>Branch protection requires reviews (ready for contributors)</li> <li>Comprehensive automated testing compensates</li> <li>Security scanning provides additional validation</li> <li>See Code Review Strategy for details</li> <li>Solution: Recruit co-maintainers from community</li> <li>Post in GitHub Discussions calling for co-maintainers</li> <li>Engage quality contributors</li> <li>Highlight in README</li> <li>Timeline: Score will improve as review history accumulates</li> </ul>"},{"location":"openssf-best-practices/#may-need-clarificationenhancement","title":"\ud83d\udd04 May Need Clarification/Enhancement","text":""},{"location":"openssf-best-practices/#documentation","title":"Documentation","text":"<ul> <li> Contribution instructions - Documented in CONTRIBUTING.md \u2705</li> <li>May need: Examples of good first issues</li> <li> Code of Conduct - Need to verify existence</li> <li> Installation instructions - Documented in README.md and chart/README.md \u2705</li> <li> Usage documentation - May need: More detailed examples</li> </ul>"},{"location":"openssf-best-practices/#testing","title":"Testing","text":"<ul> <li> Test coverage - Need to add coverage metrics</li> <li>Current: Basic helm lint and template tests</li> <li>Improvement: Add coverage reporting for template coverage</li> <li> Test invocation - Documented in Taskfile.yml \u2705</li> </ul>"},{"location":"openssf-best-practices/#security_1","title":"Security","text":"<ul> <li> Known vulnerabilities - Need to document how we track/fix them</li> <li>Already using: Trivy, Dependabot, Renovate</li> <li>May need: Public vulnerability database/CVE tracking</li> <li> Cryptography - Need to document:</li> <li>Signal Desktop uses industry-standard E2E encryption</li> <li>TLS termination at ingress layer</li> <li>Key management for PVC encryption</li> </ul>"},{"location":"openssf-best-practices/#analysis_1","title":"Analysis","text":"<ul> <li> Warning flags - Need to document:</li> <li>Helm linting warnings handled</li> <li>Template validation against Kubernetes schemas</li> <li> Static analysis enforcement - Currently enabled, may need policy documentation</li> </ul>"},{"location":"openssf-best-practices/#fuzzing","title":"Fuzzing","text":"<ul> <li> Fuzzing implemented - Property-based testing for Helm templates</li> <li>Custom fuzzing script (<code>scripts/helm-fuzz.sh</code>)</li> <li>Weekly automated fuzzing runs (<code>.github/workflows/fuzzing.yml</code>)</li> <li>Generates random valid configurations and tests template rendering</li> <li>See Fuzzing Strategy for details</li> <li> OSS-Fuzz integration - Not applicable for Helm chart projects</li> <li>OSS-Fuzz targets compiled runtime code (C, C++, Go, Rust)</li> <li>Helm charts are declarative templates with no runtime execution</li> <li>Property-based testing provides equivalent risk reduction</li> </ul>"},{"location":"openssf-best-practices/#recommended-enhancements","title":"Recommended Enhancements","text":""},{"location":"openssf-best-practices/#1-add-code-of-conduct","title":"1. Add Code of Conduct","text":"<p>File: <code>CODE_OF_CONDUCT.md</code></p> <p>Use the Contributor Covenant:</p> <pre><code>curl -o CODE_OF_CONDUCT.md https://www.contributor-covenant.org/version/2/1/code_of_conduct/code_of_conduct.md\n</code></pre>"},{"location":"openssf-best-practices/#2-enhance-test-coverage-documentation","title":"2. Enhance Test Coverage Documentation","text":"<p>File: <code>docs/testing-strategy.md</code></p> <p>Document:</p> <ul> <li>Current test coverage metrics</li> <li>How to run tests locally</li> <li>CI/CD test gates</li> <li>Coverage requirements for PRs</li> </ul>"},{"location":"openssf-best-practices/#3-vulnerability-disclosure-timeline","title":"3. Vulnerability Disclosure Timeline","text":"<p>File: <code>SECURITY.md</code> (enhancement)</p> <p>Add section on:</p> <ul> <li>How quickly vulnerabilities are typically fixed (by severity)</li> <li>Process for coordinated disclosure</li> <li>CVE assignment process (if applicable)</li> </ul>"},{"location":"openssf-best-practices/#4-security-tooling-documentation","title":"4. Security Tooling Documentation","text":"<p>File: <code>docs/security-tooling.md</code></p> <p>Document:</p> <ul> <li>All security tools in use</li> <li>How they're configured</li> <li>How to interpret results</li> <li>False positive handling</li> </ul>"},{"location":"openssf-best-practices/#5-enhance-build-documentation","title":"5. Enhance Build Documentation","text":"<p>File: <code>docs/build-process.md</code></p> <p>Document:</p> <ul> <li>Complete build steps from source to release</li> <li>How to verify builds</li> <li>Artifact signing process</li> <li>Signature verification examples</li> </ul>"},{"location":"openssf-best-practices/#application-process-timeline","title":"Application Process Timeline","text":"<ol> <li>Week 1: Complete questionnaire draft</li> <li>Week 2: Address any gaps identified</li> <li>Week 3: Review answers with team/maintainers</li> <li>Week 4: Submit for badge approval</li> </ol> <p>The badge is self-certified, so approval is automatic once all required criteria are met.</p>"},{"location":"openssf-best-practices/#maintaining-the-badge","title":"Maintaining the Badge","text":"<p>After earning the badge:</p> <ol> <li>Annual Renewal: Re-certify yearly (form saved, quick update)</li> <li>Update on Changes: Update answers if practices change</li> <li>Badge Display: Keep badge visible in README.md</li> <li>Continuous Improvement: Work toward Silver/Gold levels</li> </ol>"},{"location":"openssf-best-practices/#resources","title":"Resources","text":"<ul> <li>Badge Program: https://www.bestpractices.dev/</li> <li>Criteria: https://www.bestpractices.dev/en/criteria</li> <li>FAQ: https://www.bestpractices.dev/en/faq</li> <li>GitHub Integration: https://github.com/apps/cii-best-practices-badge</li> </ul>"},{"location":"openssf-best-practices/#next-steps","title":"Next Steps","text":"<ol> <li>Sign in to https://www.bestpractices.dev/ with GitHub account</li> <li>Add the Ghostwire project</li> <li>Start completing the questionnaire using this checklist</li> <li>Flag any gaps that need to be addressed</li> <li>Work through enhancements before submitting</li> </ol> <p>The project is well-positioned to earn the passing badge - most criteria are already met through existing security practices and documentation.</p>"},{"location":"renovate/","title":"Renovate Bot Configuration","text":"<p>Ghostwire uses Renovate for automated dependency management.</p>"},{"location":"renovate/#setup","title":"Setup","text":""},{"location":"renovate/#github-app-recommended","title":"GitHub App (Recommended)","text":"<ol> <li>Install the Renovate GitHub App on the repository</li> <li>Renovate will automatically detect <code>renovate.json</code> and <code>.github/renovate.json5</code></li> <li>PRs will be created according to the schedule (off-hours only)</li> </ol>"},{"location":"renovate/#configuration-files","title":"Configuration Files","text":"<ul> <li><code>renovate.json</code> - Main configuration</li> <li><code>.github/renovate.json5</code> - GitHub App-specific overrides</li> <li><code>.github/workflows/renovate-config-validator.yml</code> - CI validation</li> </ul>"},{"location":"renovate/#what-gets-updated","title":"What Gets Updated","text":""},{"location":"renovate/#container-images","title":"Container Images","text":""},{"location":"renovate/#kasmwebsignal","title":"kasmweb/signal","text":"<ul> <li>Monitors: <code>kasmweb/signal:*-rolling-daily</code></li> <li>Auto-merge: Patch updates only</li> <li>Labels: <code>dependencies</code>, <code>component: container</code></li> </ul>"},{"location":"renovate/#helm-dependencies","title":"Helm Dependencies","text":""},{"location":"renovate/#chartyaml-dependencies","title":"Chart.yaml dependencies","text":"<ul> <li>Monitors: All Helm chart dependencies</li> <li>Labels: <code>dependencies</code>, <code>component: helm-chart</code></li> </ul>"},{"location":"renovate/#schedule","title":"Schedule","text":"<p>PRs are created during off-hours to avoid disrupting development:</p> <ul> <li>Weekdays: 10pm - 5am ET</li> <li>Weekends: Any time</li> </ul> <p>Rate limits:</p> <ul> <li>Maximum 2 PRs per hour</li> <li>Maximum 10 concurrent PRs</li> </ul>"},{"location":"renovate/#auto-merge-strategy","title":"Auto-merge Strategy","text":"<p>Enabled for:</p> <ul> <li>kasmweb/signal patch updates</li> <li>Security updates (Chainguard images)</li> </ul> <p>Disabled for:</p> <ul> <li>Major version bumps</li> <li>Minor version bumps</li> <li>Vulnerability alerts (require manual review)</li> </ul>"},{"location":"renovate/#pr-labels","title":"PR Labels","text":"<p>Renovate automatically applies labels for easy triage:</p> <ul> <li><code>dependencies</code> - All dependency updates</li> <li><code>component: container</code> - Container image updates</li> <li><code>component: helm-chart</code> - Helm chart updates</li> <li><code>type: security</code> - Security-related updates</li> <li><code>priority: high</code> - Vulnerability alerts</li> </ul>"},{"location":"renovate/#commit-message-format","title":"Commit Message Format","text":"<p>Renovate uses Conventional Commits:</p> <pre><code>chore(deps): update kasmweb/signal to 1.18.1-rolling-daily\n</code></pre> <p>This integrates with our automated versioning (git-cliff) in CI/CD.</p>"},{"location":"renovate/#validation","title":"Validation","text":"<p>The configuration is validated on every push:</p> <pre><code># Local validation\nnpm install -g renovate\nrenovate-config-validator\n</code></pre> <p>CI automatically validates <code>renovate.json</code> on PR/push.</p>"},{"location":"renovate/#customization","title":"Customization","text":""},{"location":"renovate/#ignoring-dependencies","title":"Ignoring Dependencies","text":"<p>Add to <code>ignoreDeps</code> in <code>renovate.json</code>:</p> <pre><code>{\n  \"ignoreDeps\": [\"package-name\"]\n}\n</code></pre>"},{"location":"renovate/#changing-schedule","title":"Changing Schedule","text":"<p>Modify <code>schedule</code> in <code>renovate.json</code>:</p> <pre><code>{\n  \"schedule\": [\"after 10pm\", \"before 6am\", \"every weekend\"]\n}\n</code></pre>"},{"location":"renovate/#disabling-auto-merge","title":"Disabling Auto-merge","text":"<p>Set <code>automerge: false</code> for specific packages in <code>packageRules</code>.</p>"},{"location":"renovate/#troubleshooting","title":"Troubleshooting","text":""},{"location":"renovate/#renovate-not-creating-prs","title":"Renovate Not Creating PRs","text":"<ol> <li>Check if Renovate App is installed: https://github.com/apps/renovate</li> <li>Verify config is valid: <code>renovate-config-validator</code></li> <li>Check repository settings allow PR creation</li> <li>Review Renovate logs in \"Dependency graph\" tab</li> </ol>"},{"location":"renovate/#too-many-prs","title":"Too Many PRs","text":"<p>Adjust rate limits in <code>renovate.json</code>:</p> <pre><code>{\n  \"prHourlyLimit\": 1,\n  \"prConcurrentLimit\": 5\n}\n</code></pre>"},{"location":"renovate/#unwanted-updates","title":"Unwanted Updates","text":"<p>Add package to <code>ignoreDeps</code> or set <code>enabled: false</code> in package rules.</p>"},{"location":"renovate/#resources","title":"Resources","text":"<ul> <li>Renovate Documentation</li> <li>Configuration Options</li> <li>Preset Configs</li> <li>GitHub App</li> </ul>"},{"location":"testing-strategy/","title":"Testing Strategy","text":"<p>This document describes the testing approach for the Ghostwire Helm chart.</p>"},{"location":"testing-strategy/#overview","title":"Overview","text":"<p>The Ghostwire project uses a multi-layered testing strategy to ensure quality, security, and reliability:</p> <ol> <li>Static Analysis - Linting and validation before deployment</li> <li>Template Testing - Helm template rendering verification</li> <li>Security Scanning - Vulnerability and misconfiguration detection</li> <li>Integration Testing - Deployment verification in Kubernetes clusters</li> </ol>"},{"location":"testing-strategy/#test-execution","title":"Test Execution","text":""},{"location":"testing-strategy/#local-development","title":"Local Development","text":"<p>Run all tests locally using Task:</p> <pre><code># Run all tests\ntask test\n\n# Individual test types\nhelm lint chart/\nhelm template test chart/ --debug\n</code></pre>"},{"location":"testing-strategy/#cicd-pipeline","title":"CI/CD Pipeline","text":"<p>All tests run automatically on: - Push to main - Full test suite - Pull requests - Full test suite + additional security checks - Tag creation - Full suite + release validation</p> <p>See <code>.github/workflows/helm-release.yml</code> for CI configuration.</p>"},{"location":"testing-strategy/#test-categories","title":"Test Categories","text":""},{"location":"testing-strategy/#1-static-analysis","title":"1. Static Analysis","text":"<p>Purpose: Catch errors before rendering or deployment</p> <p>Tools: - <code>helm lint</code> - Chart structure and syntax validation - <code>yamllint</code> - YAML formatting and best practices - Helm schema validation (values.schema.json)</p> <p>Coverage: - Chart.yaml metadata validation - Template syntax checking - Values.yaml schema compliance - YAML formatting standards</p> <p>Pass Criteria: - Zero linting errors - Zero schema validation errors - All templates parseable</p> <p>Example: <pre><code>cd chart/\nhelm lint .\n</code></pre></p>"},{"location":"testing-strategy/#2-template-rendering-tests","title":"2. Template Rendering Tests","text":"<p>Purpose: Verify templates render correctly with various configurations</p> <p>Tools: - <code>helm template</code> - Dry-run template rendering - Custom test scripts - Configuration variation testing</p> <p>Coverage: - Default values rendering - Common configuration variations:   - Ingress enabled/disabled   - Persistence enabled/disabled   - Resource limits variations   - Security context configurations - Edge cases (empty values, maximum values)</p> <p>Pass Criteria: - All templates render without errors - Generated manifests are valid Kubernetes resources - No template logic errors - Conditional blocks work as expected</p> <p>Example: <pre><code># Test default rendering\nhelm template test chart/\n\n# Test with ingress enabled\nhelm template test chart/ --set ingress.enabled=true\n\n# Test with custom values\nhelm template test chart/ -f tests/test-values.yaml\n</code></pre></p>"},{"location":"testing-strategy/#3-fuzzing-and-property-based-testing","title":"3. Fuzzing and Property-Based Testing","text":"<p>Purpose: Discover edge cases and rendering failures through randomized testing</p> <p>Tools: - Custom Helm fuzzing script (<code>scripts/helm-fuzz.sh</code>) - Property-based test generation - ShellCheck deep analysis</p> <p>Coverage: - Random valid <code>values.yaml</code> configurations - Edge cases in template rendering - Boundary value testing (min/max replicas, ports, UIDs) - Random boolean flag combinations - Resource limit permutations</p> <p>Pass Criteria: - All fuzzed configurations render without errors - Generated manifests are valid YAML - No template panics or crashes - Success rate: 100% of iterations</p> <p>Example: <pre><code># Run fuzzing with default iterations (100)\n./scripts/helm-fuzz.sh\n\n# Run with more iterations for deeper testing\nFUZZ_ITERATIONS=1000 ./scripts/helm-fuzz.sh\n</code></pre></p> <p>Automated Execution: - GitHub Actions workflow runs weekly (<code>.github/workflows/fuzzing.yml</code>) - Manual trigger available for on-demand testing</p> <p>Why This Approach:</p> <p>Traditional fuzzing (OSS-Fuzz, AFL) targets compiled runtime code. Helm charts are declarative templates, so we use property-based testing instead: - Generate random valid configurations - Verify templates always render successfully - Catch edge cases that unit tests miss</p> <p>See Fuzzing Strategy for detailed explanation.</p>"},{"location":"testing-strategy/#4-kubernetes-schema-validation","title":"4. Kubernetes Schema Validation","text":"<p>Purpose: Ensure generated manifests are valid Kubernetes resources</p> <p>Tools: - <code>kubectl apply --dry-run=client</code> - Client-side validation - <code>kubectl apply --dry-run=server</code> - Server-side validation (requires cluster)</p> <p>Coverage: - All generated resources match Kubernetes API schemas - API version compatibility - Required field validation - Type checking</p> <p>Pass Criteria: - Client-side dry-run succeeds - No schema validation errors - Resources compatible with target Kubernetes versions (1.25+)</p> <p>Example: <pre><code>helm template test chart/ | kubectl apply --dry-run=client -f -\n</code></pre></p>"},{"location":"testing-strategy/#5-security-scanning","title":"5. Security Scanning","text":"<p>Purpose: Identify vulnerabilities, misconfigurations, and secrets</p> <p>Tools: - Trivy - Vulnerability and IaC scanning - TruffleHog - Secret detection in git history - Gitleaks - Credential leak detection - Dependabot - Dependency vulnerability alerts - Renovate - Automated dependency updates</p> <p>Coverage: - Container image vulnerabilities - Helm chart misconfigurations - Hardcoded secrets - Dependency vulnerabilities - Infrastructure-as-Code best practices</p> <p>Severity Thresholds: - Critical/High - Must fix before release - Medium - Fix in next patch release - Low - Fix in next minor release</p> <p>Pass Criteria: - Zero critical/high vulnerabilities in latest release - No secrets in repository history - All dependencies up-to-date or patched</p> <p>Example: <pre><code># Run security scans\ntask scan\n\n# Scan Helm chart\ntrivy config --severity HIGH,CRITICAL chart/\n\n# Scan container images\ntrivy image kasmweb/signal:1.18.0-rolling-daily\n</code></pre></p>"},{"location":"testing-strategy/#5-integration-testing","title":"5. Integration Testing","text":"<p>Purpose: Verify chart deploys successfully in real Kubernetes clusters</p> <p>Tools: - Local Kubernetes (k3d, kind, minikube) - <code>helm install</code> - Chart installation - <code>helm test</code> - Built-in Helm tests (future) - Manual verification</p> <p>Coverage: - Installation succeeds - All pods reach Running state - Services are created correctly - Ingress configuration works (if enabled) - Persistence works (StatefulSet) - Application functionality (manual)</p> <p>Test Environments: - k3d (local development) - kind (CI/CD) - Production-like cluster (staging)</p> <p>Pass Criteria: - Chart installs without errors - All resources created successfully - Pods become healthy within 5 minutes - Application accessible via port-forward or ingress - Upgrade/rollback work correctly</p> <p>Example: <pre><code># Create test cluster\nk3d cluster create ghostwire-test\n\n# Install chart\nhelm install test ./chart -n test --create-namespace\n\n# Verify installation\nkubectl get pods -n test\nkubectl port-forward -n test svc/test 6901:6901\n\n# Test upgrade\nhelm upgrade test ./chart -n test --set image.tag=1.19.0\n\n# Cleanup\nhelm uninstall test -n test\nk3d cluster delete ghostwire-test\n</code></pre></p>"},{"location":"testing-strategy/#test-coverage-metrics","title":"Test Coverage Metrics","text":""},{"location":"testing-strategy/#current-coverage","title":"Current Coverage","text":"<p>Template Coverage: ~95% - All templates tested with default values - Major configuration variations covered - Edge cases identified and tested</p> <p>Integration Coverage: Manual - Installation tested on k3d, kind, minikube - Production deployments monitored - Upgrade paths tested</p> <p>Security Coverage: 100% - All code paths scanned by Trivy - Repository history scanned for secrets - Dependencies monitored continuously</p>"},{"location":"testing-strategy/#coverage-goals","title":"Coverage Goals","text":"<ul> <li>Template Coverage: 100% - Cover all conditional blocks</li> <li>Integration Coverage: Automated tests for common scenarios</li> <li>Security Coverage: Maintain 100% with automated scanning</li> </ul>"},{"location":"testing-strategy/#test-automation","title":"Test Automation","text":""},{"location":"testing-strategy/#pre-commit-hooks","title":"Pre-commit Hooks","text":"<p>Install pre-commit hooks to run tests before commits:</p> <pre><code># Future: Add pre-commit configuration\n# .pre-commit-config.yaml with:\n# - helm lint\n# - yaml lint\n# - secret scanning\n</code></pre>"},{"location":"testing-strategy/#cicd-gates","title":"CI/CD Gates","text":"<p>Required Checks: - \u2705 Helm lint - \u2705 Template rendering - \u2705 Trivy security scan - \u2705 Secret scanning</p> <p>Blocking Conditions: - Linting errors - Template rendering failures - Critical/high vulnerabilities - Secrets detected</p>"},{"location":"testing-strategy/#automated-testing-schedule","title":"Automated Testing Schedule","text":"<ul> <li>On PR: All checks run</li> <li>On merge to main: All checks + extended security scans</li> <li>Nightly: Full security scan with latest Trivy DB</li> <li>Weekly: Dependency update checks (Renovate)</li> </ul>"},{"location":"testing-strategy/#adding-new-tests","title":"Adding New Tests","text":""},{"location":"testing-strategy/#for-new-features","title":"For New Features","text":"<ol> <li>Add template tests for new configurations</li> <li>Document new values in values.schema.json</li> <li>Add integration test examples to documentation</li> <li>Update this testing strategy document</li> </ol>"},{"location":"testing-strategy/#for-bug-fixes","title":"For Bug Fixes","text":"<ol> <li>Add test case that reproduces the bug</li> <li>Verify test fails before fix</li> <li>Verify test passes after fix</li> <li>Add regression test to prevent recurrence</li> </ol>"},{"location":"testing-strategy/#test-maintenance","title":"Test Maintenance","text":""},{"location":"testing-strategy/#regular-tasks","title":"Regular Tasks","text":"<ul> <li>Weekly: Review Trivy scan results</li> <li>Monthly: Update test dependencies</li> <li>Quarterly: Review and update test coverage</li> <li>Annually: Validate tests against new Kubernetes versions</li> </ul>"},{"location":"testing-strategy/#test-infrastructure","title":"Test Infrastructure","text":"<ul> <li>Keep test clusters updated</li> <li>Monitor CI/CD execution times</li> <li>Optimize slow tests</li> <li>Remove obsolete tests</li> </ul>"},{"location":"testing-strategy/#known-limitations","title":"Known Limitations","text":"<ol> <li>No Unit Tests: Helm charts are declarative - limited unit test value</li> <li>Manual Application Testing: Signal Desktop functionality requires manual QA</li> <li>Limited Upgrade Testing: Automated upgrade path testing not yet implemented</li> <li>Browser Compatibility: VNC client testing is manual</li> </ol>"},{"location":"testing-strategy/#resources","title":"Resources","text":"<ul> <li>Helm Testing Guide</li> <li>Trivy Documentation</li> <li>Kubernetes API Reference</li> </ul>"},{"location":"testing-strategy/#future-enhancements","title":"Future Enhancements","text":"<ul> <li> Add <code>helm test</code> hooks for automated post-install validation</li> <li> Implement automated upgrade path testing</li> <li> Add performance benchmarking tests</li> <li> Create test matrix for Kubernetes version compatibility</li> <li> Add chaos engineering tests for resilience validation</li> </ul>"},{"location":"architecture/container/","title":"Container Runtime","text":"<p>Ghostwire uses Kasm Technologies' Signal Desktop container image. Understanding the runtime architecture helps with troubleshooting and resource planning.</p>"},{"location":"architecture/container/#container-stack","title":"Container Stack","text":"<p>The container runs several components that work together to provide a browser-accessible Signal Desktop:</p> <p>Xvnc \u2014 Virtual framebuffer X server with built-in VNC. Runs the graphical display on <code>:1</code> and handles VNC connections on port 6901.</p> <p>XFCE4 \u2014 Lightweight desktop environment providing window management and basic desktop functionality.</p> <p>KasmVNC \u2014 Fork of TigerVNC with HTML5 web client. Provides the browser-based access without requiring a native VNC client.</p> <p>PulseAudio + FFmpeg \u2014 Audio stack for sound output. FFmpeg encodes audio for streaming to the browser.</p> <p>Signal Desktop \u2014 The Electron-based messaging application, running with <code>--no-sandbox</code> flag (sandboxing is handled at the container level).</p>"},{"location":"architecture/container/#startup-sequence","title":"Startup Sequence","text":"<p>When the container starts:</p> <ol> <li><code>vnc_startup.sh</code> (PID 1) initializes the environment</li> <li>D-Bus session bus starts for inter-process communication</li> <li>Xvnc launches on display <code>:1</code>, listening on port 6901</li> <li>XFCE4 session starts with window manager and desktop</li> <li>PulseAudio and FFmpeg initialize for audio streaming</li> <li>Auxiliary Kasm services start (file upload, audio input, gamepad support)</li> <li><code>custom_startup.sh</code> launches Signal Desktop</li> </ol> <p>The container is ready when Signal Desktop's window appears in the VNC session.</p>"},{"location":"architecture/container/#process-tree","title":"Process Tree","text":"<pre><code>vnc_startup.sh (PID 1)\n\u251c\u2500\u2500 dbus-daemon\n\u251c\u2500\u2500 Xvnc :1 (port 6901)\n\u251c\u2500\u2500 xfce4-session\n\u2502   \u251c\u2500\u2500 xfwm4 (window manager)\n\u2502   \u251c\u2500\u2500 xfdesktop\n\u2502   \u2514\u2500\u2500 Thunar (file manager)\n\u251c\u2500\u2500 pulseaudio\n\u251c\u2500\u2500 ffmpeg (audio encoder)\n\u251c\u2500\u2500 kasm_audio_out (port 4901)\n\u251c\u2500\u2500 kasm_upload_server (port 4902)\n\u251c\u2500\u2500 kasm_audio_input (port 4903)\n\u251c\u2500\u2500 kasm_gamepad (port 4904)\n\u2514\u2500\u2500 signal-desktop\n    \u251c\u2500\u2500 zygote\n    \u2514\u2500\u2500 renderer processes\n</code></pre>"},{"location":"architecture/container/#resource-usage","title":"Resource Usage","text":"<p>Typical memory consumption:</p> Component Memory Xvnc ~80 MB XFCE4 session ~80 MB FFmpeg ~45 MB PulseAudio ~15 MB Signal Desktop ~400-800 MB Total ~700 MB - 1.2 GB <p>Signal Desktop memory usage scales with conversation count and media. Heavy usage can reach 2-3 GB.</p> <p>The default resource limits (4GB memory, 2 CPU) accommodate typical usage with headroom for spikes.</p>"},{"location":"architecture/container/#network-ports","title":"Network Ports","text":"Port Protocol Service 6901 TCP/UDP Xvnc (primary VNC access) 4901 WebSocket Audio output streaming 4902 HTTPS File upload 4903 WebSocket Audio input (microphone) 4904 WebSocket Gamepad input <p>The Kubernetes Service exposes port 6901. Other ports are used internally for feature communication between the browser client and container.</p>"},{"location":"architecture/container/#filesystem-layout","title":"Filesystem Layout","text":"<pre><code>/home/kasm-user/\n\u251c\u2500\u2500 .config/\n\u2502   \u2514\u2500\u2500 Signal/           # Signal configuration, encryption keys\n\u251c\u2500\u2500 .local/\n\u2502   \u2514\u2500\u2500 share/\n\u2502       \u2514\u2500\u2500 Signal/       # Message database, attachments\n\u251c\u2500\u2500 Desktop/              # XFCE desktop files\n\u2514\u2500\u2500 .kasmpasswd           # VNC authentication (if enabled)\n</code></pre> <p>The PVC mounts at <code>/home/kasm-user</code> to persist all user data.</p>"},{"location":"architecture/container/#signal-desktop-configuration","title":"Signal Desktop Configuration","text":"<p>Signal Desktop runs with these flags:</p> <ul> <li><code>--no-sandbox</code> \u2014 Chromium sandbox is disabled (container provides isolation)</li> <li>Uses Electron's default rendering pipeline</li> </ul> <p>The application auto-starts via XFCE autostart or <code>custom_startup.sh</code>.</p>"},{"location":"architecture/container/#health-indicators","title":"Health Indicators","text":"<p>The container is healthy when:</p> <ul> <li>Xvnc is listening on port 6901</li> <li>Signal Desktop window is visible</li> <li>No crash loops in the Signal process</li> </ul> <p>The Helm chart configures liveness and readiness probes on port 6901.</p>"},{"location":"architecture/container/#customization","title":"Customization","text":"<p>Environment variables for the Kasm container:</p> Variable Description <code>VNC_PW</code> VNC password (if using native VNC auth) <code>VNC_RESOLUTION</code> Display resolution (e.g., <code>1920x1080</code>) <code>TZ</code> Timezone <p>See the Kasm documentation for additional configuration options.</p>"},{"location":"architecture/security/","title":"Security Model","text":"<p>Ghostwire's security relies on defense in depth: container isolation, Kubernetes RBAC, network policies, and infrastructure-level authentication.</p>"},{"location":"architecture/security/#trust-boundaries","title":"Trust Boundaries","text":""},{"location":"architecture/security/#container-isolation","title":"Container Isolation","text":"<p>The container runs as a non-root user (<code>kasm-user</code>, UID 1000). Security contexts in the Helm chart:</p> <pre><code>securityContext:\n  runAsNonRoot: true\n  runAsUser: 1000\n  runAsGroup: 1000\n  capabilities:\n    drop:\n      - ALL\n</code></pre> <p>Signal Desktop's Chromium sandbox is disabled (<code>--no-sandbox</code>) because the container itself provides the isolation boundary. This is standard practice for containerized Electron applications.</p>"},{"location":"architecture/security/#kubernetes-rbac","title":"Kubernetes RBAC","text":"<p>The chart creates minimal RBAC:</p> <ul> <li>A ServiceAccount for the pod</li> <li>No cluster-level permissions</li> <li>No access to Kubernetes API beyond default</li> </ul> <p>The pod only accesses its own PVC and the network.</p>"},{"location":"architecture/security/#network-exposure","title":"Network Exposure","text":"<p>By default, the Service is ClusterIP\u2014no external access without explicit ingress configuration.</p> <p>Warning: Port 6901 (VNC) has no authentication by default. Anyone who can reach the Service can access Signal Desktop.</p>"},{"location":"architecture/security/#authentication-options","title":"Authentication Options","text":""},{"location":"architecture/security/#infrastructure-authentication-recommended","title":"Infrastructure Authentication (Recommended)","text":"<p>Route traffic through an authenticating proxy:</p> <ul> <li>OAuth2-Proxy with your identity provider (Google, GitHub, Azure AD, etc.)</li> <li>Keycloak or Authentik for more complex requirements</li> <li>Your ingress controller's built-in auth annotations</li> </ul> <p>See Infrastructure Integration for examples.</p>"},{"location":"architecture/security/#vnc-password-basic","title":"VNC Password (Basic)","text":"<p>The Kasm container supports native VNC password authentication:</p> <pre><code>env:\n  - name: VNC_PW\n    valueFrom:\n      secretKeyRef:\n        name: ghostwire-vnc\n        key: password\n</code></pre> <p>This provides basic protection but: - Shared password (not per-user) - No audit trail - Password transmitted with VNC (use TLS)</p> <p>Only use this as a secondary layer, not primary authentication.</p>"},{"location":"architecture/security/#tls-configuration","title":"TLS Configuration","text":""},{"location":"architecture/security/#ingress-tls-recommended","title":"Ingress TLS (Recommended)","text":"<p>Terminate TLS at the ingress layer:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  annotations:\n    cert-manager.io/cluster-issuer: letsencrypt-prod\nspec:\n  tls:\n    - hosts:\n        - signal.example.com\n      secretName: ghostwire-tls\n</code></pre> <p>Traffic from ingress to the pod is unencrypted. This is standard for cluster-internal traffic. If you need end-to-end encryption, use a service mesh.</p>"},{"location":"architecture/security/#service-mesh-mtls","title":"Service Mesh mTLS","text":"<p>For encrypted pod-to-pod traffic:</p> <pre><code># Linkerd\npodAnnotations:\n  linkerd.io/inject: enabled\n\n# Istio\npodAnnotations:\n  sidecar.istio.io/inject: \"true\"\n</code></pre> <p>The mesh provides automatic mTLS between all participating services.</p>"},{"location":"architecture/security/#data-security","title":"Data Security","text":""},{"location":"architecture/security/#encryption-at-rest","title":"Encryption at Rest","text":"<p>Signal Desktop encrypts messages at the application layer using keys stored in <code>~/.config/Signal/</code>. The underlying storage (PVC) may or may not be encrypted depending on your storage class.</p> <p>For additional protection: - Use encrypted storage classes if available - Enable Kubernetes secrets encryption at rest - Consider encrypting the entire PVC with solutions like LUKS</p>"},{"location":"architecture/security/#encryption-in-transit","title":"Encryption in Transit","text":"Path Encryption Browser \u2192 Ingress TLS (via cert-manager) Ingress \u2192 Pod Unencrypted (or mTLS via service mesh) Signal Desktop \u2192 Signal servers TLS + Signal Protocol <p>Signal's end-to-end encryption is independent of transport security\u2014messages are encrypted before leaving the application.</p>"},{"location":"architecture/security/#network-policies","title":"Network Policies","text":"<p>Restrict traffic to the namespace:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: ghostwire-default-deny\n  namespace: ghostwire\nspec:\n  podSelector: {}\n  policyTypes:\n    - Ingress\n    - Egress\n---\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: ghostwire-allow-ingress\n  namespace: ghostwire\nspec:\n  podSelector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  policyTypes:\n    - Ingress\n  ingress:\n    - from:\n        - namespaceSelector:\n            matchLabels:\n              name: ingress-nginx\n      ports:\n        - port: 6901\n---\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: ghostwire-allow-egress\n  namespace: ghostwire\nspec:\n  podSelector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  policyTypes:\n    - Egress\n  egress:\n    - to:\n        - ipBlock:\n            cidr: 0.0.0.0/0\n      ports:\n        - port: 443  # Signal servers\n        - port: 53   # DNS\n          protocol: UDP\n</code></pre>"},{"location":"architecture/security/#pod-security-standards","title":"Pod Security Standards","text":"<p>The chart is compatible with Kubernetes Pod Security Standards at the <code>restricted</code> level with minor adjustments (the container runs as non-root UID 1000).</p>"},{"location":"architecture/security/#secrets-management","title":"Secrets Management","text":"<p>Avoid hardcoding secrets in values files. Use:</p> <ul> <li>Kubernetes Secrets with external secrets operator</li> <li>HashiCorp Vault</li> <li>Cloud provider secret managers (AWS Secrets Manager, GCP Secret Manager)</li> </ul> <p>Example with External Secrets:</p> <pre><code>apiVersion: external-secrets.io/v1beta1\nkind: ExternalSecret\nmetadata:\n  name: ghostwire-vnc\n  namespace: ghostwire\nspec:\n  secretStoreRef:\n    name: vault\n    kind: ClusterSecretStore\n  target:\n    name: ghostwire-vnc\n  data:\n    - secretKey: password\n      remoteRef:\n        key: ghostwire/vnc\n        property: password\n</code></pre>"},{"location":"architecture/security/#audit-considerations","title":"Audit Considerations","text":"<p>The container doesn't produce structured audit logs. For audit requirements:</p> <ul> <li>Use ingress access logs for connection records</li> <li>Enable Kubernetes audit logging for API access</li> <li>Consider a sidecar for application-level logging if needed</li> </ul> <p>Signal Desktop itself logs to stdout/stderr, captured by Kubernetes logging.</p>"},{"location":"development/contributing/","title":"Contributing","text":"<p>Ghostwire welcomes contributions. This guide covers development setup and expectations for pull requests.</p>"},{"location":"development/contributing/#development-setup","title":"Development Setup","text":""},{"location":"development/contributing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Kubernetes cluster (k3d, kind, minikube, or remote)</li> <li>Helm 3.x</li> <li>kubectl configured for your cluster</li> <li>Task (optional, for running Taskfile commands)</li> </ul>"},{"location":"development/contributing/#local-testing","title":"Local Testing","text":"<pre><code># Create a local cluster\nk3d cluster create ghostwire\n\n# Install the chart from local source\nhelm install ghostwire ./chart \\\n  --create-namespace -n ghostwire\n\n# Port-forward to test\nkubectl port-forward -n ghostwire svc/ghostwire 6901:6901\n</code></pre>"},{"location":"development/contributing/#making-changes","title":"Making Changes","text":"<ol> <li>Fork the repository</li> <li>Create a feature branch: <code>git checkout -b feat/my-feature</code></li> <li>Make changes</li> <li>Test locally</li> <li>Commit with conventional commits: <code>git commit -m \"feat: add new capability\"</code></li> <li>Push and open a pull request</li> </ol>"},{"location":"development/contributing/#code-structure","title":"Code Structure","text":"<pre><code>ghostwire/\n\u251c\u2500\u2500 chart/                 # Helm chart\n\u2502   \u251c\u2500\u2500 templates/        # Kubernetes manifests\n\u2502   \u251c\u2500\u2500 values.yaml       # Default values\n\u2502   \u251c\u2500\u2500 values.schema.json # Value validation schema\n\u2502   \u2514\u2500\u2500 Chart.yaml        # Chart metadata\n\u251c\u2500\u2500 docs/                  # Documentation\n\u251c\u2500\u2500 .github/              # GitHub workflows\n\u2502   \u2514\u2500\u2500 workflows/        # CI/CD pipelines\n\u2514\u2500\u2500 scripts/              # Utility scripts\n</code></pre>"},{"location":"development/contributing/#pull-request-guidelines","title":"Pull Request Guidelines","text":""},{"location":"development/contributing/#size","title":"Size","text":"<p>Keep pull requests focused. A PR should do one thing well. Large changes are harder to review and more likely to introduce bugs.</p>"},{"location":"development/contributing/#testing","title":"Testing","text":"<p>Test your changes:</p> <ol> <li>Lint the chart:</li> </ol> <pre><code>helm lint ./chart\n</code></pre> <ol> <li>Template validation:</li> </ol> <pre><code>helm template ghostwire ./chart | kubectl apply --dry-run=client -f -\n</code></pre> <ol> <li>Deploy and verify functionality</li> </ol>"},{"location":"development/contributing/#documentation","title":"Documentation","text":"<p>If your change affects user-facing behavior: - Update relevant documentation - Update <code>values.yaml</code> comments if changing values - Update <code>values.schema.json</code> if adding or modifying values</p>"},{"location":"development/contributing/#commit-messages","title":"Commit Messages","text":"<p>Use conventional commits:</p> <pre><code>feat: add resource quota support\nfix: correct memory limit calculation\ndocs: update installation guide\nchore: update dependencies\n</code></pre> <p>The message should describe what the change accomplishes, not how.</p>"},{"location":"development/contributing/#chart-development","title":"Chart Development","text":""},{"location":"development/contributing/#adding-a-value","title":"Adding a Value","text":"<ol> <li>Add to <code>values.yaml</code> with documentation comment</li> <li>Add schema entry in <code>values.schema.json</code></li> <li>Reference in templates with <code>{{ .Values.newValue }}</code></li> <li>Document in chart README</li> </ol>"},{"location":"development/contributing/#modifying-templates","title":"Modifying Templates","text":"<p>Templates are Go templates with Helm/Sprig functions. Test rendering:</p> <pre><code>helm template ghostwire ./chart --debug\n</code></pre> <p>Use <code>helm template --set</code> to test different value combinations.</p>"},{"location":"development/contributing/#schema-validation","title":"Schema Validation","text":"<p>The chart includes a JSON schema for value validation:</p> <pre><code># Validate values against schema\nhelm lint ./chart -f custom-values.yaml\n</code></pre> <p>IDEs with YAML schema support will provide autocomplete and validation.</p>"},{"location":"development/contributing/#looking-for-co-maintainers","title":"Looking for Co-Maintainers","text":"<p>This project is actively seeking additional maintainers. If you're interested in: - Reviewing pull requests - Triaging issues - Feature development - Documentation improvements</p> <p>Please reach out via GitHub Discussions.</p>"},{"location":"development/contributing/#license","title":"License","text":"<p>By contributing, you agree that your contributions will be licensed under the Apache License 2.0.</p>"},{"location":"development/testing/","title":"Testing","text":"<p>Ghostwire uses multiple testing approaches to ensure chart quality and reliability.</p>"},{"location":"development/testing/#chart-linting","title":"Chart Linting","text":"<p>Basic syntax and best practice validation:</p> <pre><code>helm lint ./chart\n</code></pre> <p>This checks for: - Template syntax errors - Missing required values - Chart metadata issues</p>"},{"location":"development/testing/#template-rendering","title":"Template Rendering","text":"<p>Validate rendered manifests without deploying:</p> <pre><code># Render templates\nhelm template ghostwire ./chart\n\n# Check against Kubernetes API\nhelm template ghostwire ./chart | kubectl apply --dry-run=client -f -\n\n# Render with custom values\nhelm template ghostwire ./chart -f custom-values.yaml\n</code></pre>"},{"location":"development/testing/#schema-validation","title":"Schema Validation","text":"<p>The chart includes <code>values.schema.json</code> for validating user-provided values:</p> <pre><code># Lint with value validation\nhelm lint ./chart -f values-production.yaml\n</code></pre> <p>Schema validation catches: - Invalid types (string where number expected) - Unknown value keys - Missing required values - Out-of-range values</p>"},{"location":"development/testing/#helm-tests","title":"Helm Tests","text":"<p>The chart includes Helm tests that run after installation:</p> <pre><code># Install and run tests\nhelm install ghostwire ./chart -n ghostwire --create-namespace\nhelm test ghostwire -n ghostwire\n</code></pre> <p>Tests validate: - VNC port is accessible - Pod is running and ready - PVC is bound</p>"},{"location":"development/testing/#test-pod","title":"Test Pod","text":"<pre><code># chart/templates/tests/test-connection.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: \"{{ include \"ghostwire.fullname\" . }}-test\"\n  annotations:\n    \"helm.sh/hook\": test\nspec:\n  containers:\n    - name: curl\n      image: curlimages/curl\n      command: ['curl', '-s', '-o', '/dev/null', '-w', '%{http_code}', 'http://{{ include \"ghostwire.fullname\" . }}:6901']\n  restartPolicy: Never\n</code></pre>"},{"location":"development/testing/#integration-testing","title":"Integration Testing","text":"<p>Full end-to-end testing on a real cluster:</p> <pre><code># Create test cluster\nk3d cluster create ghostwire-test\n\n# Install chart\nhelm install ghostwire ./chart -n ghostwire --create-namespace\n\n# Wait for ready\nkubectl wait --for=condition=ready pod \\\n  -l app.kubernetes.io/name=ghostwire -n ghostwire --timeout=300s\n\n# Run tests\nhelm test ghostwire -n ghostwire\n\n# Cleanup\nk3d cluster delete ghostwire-test\n</code></pre>"},{"location":"development/testing/#ci-pipeline","title":"CI Pipeline","text":"<p>GitHub Actions runs tests on every pull request:</p> <pre><code># .github/workflows/helm-lint-test.yml\nname: Lint and Test\n\non:\n  pull_request:\n    paths:\n      - 'chart/**'\n\njobs:\n  lint:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: azure/setup-helm@v3\n      - run: helm lint ./chart\n\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: azure/setup-helm@v3\n      - name: Create k3d cluster\n        run: |\n          curl -s https://raw.githubusercontent.com/k3d-io/k3d/main/install.sh | bash\n          k3d cluster create test\n      - name: Install and test\n        run: |\n          helm install ghostwire ./chart -n ghostwire --create-namespace\n          kubectl wait --for=condition=ready pod \\\n            -l app.kubernetes.io/name=ghostwire -n ghostwire --timeout=300s\n          helm test ghostwire -n ghostwire\n</code></pre>"},{"location":"development/testing/#testing-upgrades","title":"Testing Upgrades","text":"<p>Verify upgrades work correctly:</p> <pre><code># Install previous version\nhelm install ghostwire ./chart --version 1.0.0 -n ghostwire --create-namespace\n\n# Upgrade to new version\nhelm upgrade ghostwire ./chart -n ghostwire\n\n# Verify pod restarts successfully\nkubectl rollout status statefulset/ghostwire -n ghostwire\n</code></pre>"},{"location":"development/testing/#testing-rollback","title":"Testing Rollback","text":"<pre><code># Upgrade to a broken version\nhelm upgrade ghostwire ./chart --set image.tag=nonexistent -n ghostwire\n\n# Rollback\nhelm rollback ghostwire -n ghostwire\n\n# Verify recovery\nkubectl get pods -n ghostwire\n</code></pre>"},{"location":"development/testing/#manual-testing-checklist","title":"Manual Testing Checklist","text":"<p>For changes that affect user experience:</p> <ul> <li> Pod starts successfully</li> <li> VNC connection works</li> <li> Signal Desktop loads</li> <li> Can link with phone (if testing fresh install)</li> <li> Data persists across pod restart</li> <li> Logs show no errors</li> <li> Resource usage is within limits</li> </ul>"},{"location":"development/testing/#security-testing","title":"Security Testing","text":""},{"location":"development/testing/#container-security","title":"Container Security","text":"<pre><code># Scan image for vulnerabilities\ntrivy image kasmweb/signal:1.18.0-rolling-daily\n\n# Check pod security context\nkubectl get pod ghostwire-0 -n ghostwire -o jsonpath='{.spec.securityContext}'\n</code></pre>"},{"location":"development/testing/#rbac-verification","title":"RBAC Verification","text":"<pre><code># List RBAC resources\nkubectl get rolebinding,clusterrolebinding -n ghostwire\n\n# Verify minimal permissions\nkubectl auth can-i --list --as=system:serviceaccount:ghostwire:ghostwire -n ghostwire\n</code></pre>"},{"location":"getting-started/configuration/","title":"Configuration","text":"<p>Ghostwire exposes Helm values for customizing the deployment. This guide covers the most commonly adjusted settings.</p>"},{"location":"getting-started/configuration/#resource-allocation","title":"Resource Allocation","text":"<p>Signal Desktop needs adequate memory. The defaults work for most cases:</p> <pre><code>resources:\n  requests:\n    memory: \"2Gi\"\n    cpu: \"500m\"\n  limits:\n    memory: \"4Gi\"\n    cpu: \"2\"\n</code></pre> <p>If Signal Desktop crashes or becomes unresponsive, increase the memory limit:</p> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set resources.limits.memory=6Gi \\\n  -n ghostwire\n</code></pre>"},{"location":"getting-started/configuration/#persistence","title":"Persistence","text":"<p>Data persists in a PVC mounted at <code>/home/kasm-user</code>. Configure the volume size based on expected message history:</p> <pre><code>persistence:\n  enabled: true\n  size: 10Gi\n  accessMode: ReadWriteOnce\n  # storageClass: \"\"  # Uses cluster default\n</code></pre> <p>For production, specify an explicit storage class:</p> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set persistence.storageClass=ssd \\\n  --set persistence.size=20Gi \\\n  -n ghostwire\n</code></pre>"},{"location":"getting-started/configuration/#image-configuration","title":"Image Configuration","text":"<p>The chart uses Kasm's Signal Desktop image:</p> <pre><code>image:\n  repository: kasmweb/signal\n  tag: \"1.18.0-rolling-daily\"\n  pullPolicy: Always\n</code></pre> <p>Pin to a specific tag for reproducible deployments:</p> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set image.tag=1.18.0 \\\n  --set image.pullPolicy=IfNotPresent \\\n  -n ghostwire\n</code></pre>"},{"location":"getting-started/configuration/#service-configuration","title":"Service Configuration","text":"<p>The default service type is ClusterIP on port 6901:</p> <pre><code>service:\n  type: ClusterIP\n  port: 6901\n  targetPort: 6901\n</code></pre> <p>For direct external access (not recommended for production):</p> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set service.type=LoadBalancer \\\n  -n ghostwire\n</code></pre> <p>Prefer ingress with authentication for production access.</p>"},{"location":"getting-started/configuration/#environment-variables","title":"Environment Variables","text":"<p>Pass environment variables to the container:</p> <pre><code>env:\n  - name: TZ\n    value: \"America/Los_Angeles\"\n</code></pre> <p>The Kasm container supports several environment variables for VNC configuration. See the Kasm documentation for details.</p>"},{"location":"getting-started/configuration/#node-selection","title":"Node Selection","text":"<p>Schedule on specific nodes:</p> <pre><code>nodeSelector:\n  kubernetes.io/os: linux\n\ntolerations: []\n\naffinity: {}\n</code></pre>"},{"location":"getting-started/configuration/#values-file","title":"Values File","text":"<p>For complex configurations, use a values file:</p> <pre><code># values-production.yaml\nresources:\n  limits:\n    memory: 6Gi\n    cpu: 4\n\npersistence:\n  size: 50Gi\n  storageClass: ssd-retain\n\nimage:\n  tag: \"1.18.0\"\n  pullPolicy: IfNotPresent\n</code></pre> <p>Apply with:</p> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  -f values-production.yaml \\\n  -n ghostwire\n</code></pre>"},{"location":"getting-started/configuration/#complete-values-reference","title":"Complete Values Reference","text":"<p>See values.yaml for all available options with documentation.</p> <p>The chart includes a JSON schema for validation. IDEs with YAML schema support will provide autocomplete and validation.</p>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>Ghostwire installs via Helm and runs on any Kubernetes cluster with persistent volume support.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<p>Kubernetes 1.24+ with a working storage class for persistent volumes. Most managed Kubernetes services (GKE, EKS, AKS) provide this by default.</p> <p>Helm 3.x for chart installation.</p> <p>4GB memory available for the Signal Desktop pod. The default resource request is 2GB with a 4GB limit.</p>"},{"location":"getting-started/installation/#install-from-oci-registry","title":"Install from OCI Registry","text":"<p>The chart is published to GitHub Container Registry:</p> <pre><code>helm install ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --version 0.0.0-latest \\\n  --create-namespace -n ghostwire\n</code></pre> <p>Pin to a specific version for production:</p> <pre><code>helm install ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --version 1.0.0 \\\n  --create-namespace -n ghostwire\n</code></pre>"},{"location":"getting-started/installation/#install-from-artifact-hub","title":"Install from Artifact Hub","text":"<p>Add the repository:</p> <pre><code>helm repo add ghostwire https://drengskapur.github.io/ghostwire\nhelm repo update\n</code></pre> <p>Install:</p> <pre><code>helm install ghostwire ghostwire/ghostwire \\\n  --create-namespace -n ghostwire\n</code></pre>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<p>Check the pod status:</p> <pre><code>kubectl get pods -n ghostwire\n</code></pre> <p>Wait for the pod to be ready:</p> <pre><code>kubectl wait --for=condition=ready pod \\\n  -l app.kubernetes.io/name=ghostwire -n ghostwire --timeout=300s\n</code></pre>"},{"location":"getting-started/installation/#local-development-cluster","title":"Local Development Cluster","text":"<p>For testing, use k3d to create a local cluster:</p> <pre><code># Install k3d\ncurl -s https://raw.githubusercontent.com/k3d-io/k3d/main/install.sh | bash\n\n# Create cluster\nk3d cluster create ghostwire\n\n# Install chart\nhelm install ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --version 0.0.0-latest \\\n  --create-namespace -n ghostwire\n</code></pre>"},{"location":"getting-started/installation/#uninstall","title":"Uninstall","text":"<p>Remove the release:</p> <pre><code>helm uninstall ghostwire -n ghostwire\n</code></pre> <p>The PVC is retained by default to preserve your Signal data. Delete it manually if needed:</p> <pre><code>kubectl delete pvc -l app.kubernetes.io/name=ghostwire -n ghostwire\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start \u2014 First access and Signal linking</li> <li>Configuration \u2014 Customize resources, persistence, and features</li> </ul>"},{"location":"getting-started/quickstart/","title":"Quick Start","text":"<p>This guide walks through your first Ghostwire deployment and linking Signal Desktop to your phone.</p>"},{"location":"getting-started/quickstart/#access-the-desktop","title":"Access the Desktop","text":"<p>After installation, access Signal Desktop via port-forward:</p> <pre><code>kubectl port-forward -n ghostwire svc/ghostwire 6901:6901\n</code></pre> <p>Open your browser to:</p> <pre><code>http://localhost:6901?keyboard=1\n</code></pre> <p>The <code>?keyboard=1</code> parameter enables the on-screen keyboard for QR code entry.</p>"},{"location":"getting-started/quickstart/#link-your-phone","title":"Link Your Phone","text":"<p>Signal Desktop requires linking to an existing Signal account on your phone:</p> <ol> <li>In the VNC browser session, Signal Desktop shows a QR code</li> <li>On your phone, open Signal \u2192 Settings \u2192 Linked Devices \u2192 Link New Device</li> <li>Scan the QR code displayed in the browser</li> </ol> <p>Your message history will sync from your phone. This takes a few minutes depending on history size.</p>"},{"location":"getting-started/quickstart/#verify-persistence","title":"Verify Persistence","text":"<p>Confirm your data persists across pod restarts:</p> <pre><code># Delete the pod\nkubectl delete pod -l app.kubernetes.io/name=ghostwire -n ghostwire\n\n# Wait for replacement\nkubectl wait --for=condition=ready pod \\\n  -l app.kubernetes.io/name=ghostwire -n ghostwire --timeout=300s\n\n# Access again - should show your linked account\nkubectl port-forward -n ghostwire svc/ghostwire 6901:6901\n</code></pre> <p>Signal Desktop should still be linked with your message history intact.</p>"},{"location":"getting-started/quickstart/#production-access","title":"Production Access","text":"<p>Port-forwarding works for testing. For production, expose through ingress with proper authentication.</p> <p>Basic ingress (no auth):</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    cert-manager.io/cluster-issuer: letsencrypt-prod\nspec:\n  ingressClassName: nginx\n  tls:\n    - hosts:\n        - signal.example.com\n      secretName: ghostwire-tls\n  rules:\n    - host: signal.example.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: ghostwire\n                port:\n                  number: 6901\n</code></pre> <p>For authentication, see Infrastructure Integration.</p>"},{"location":"getting-started/quickstart/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"<p>KasmVNC provides several useful shortcuts:</p> <ul> <li>Ctrl+Alt+Shift \u2014 Open control panel</li> <li>F11 \u2014 Toggle fullscreen</li> <li>Ctrl+Shift+V \u2014 Paste from host clipboard</li> </ul>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration \u2014 Adjust resources and persistence</li> <li>Infrastructure Integration \u2014 Add OAuth2, TLS, ingress</li> <li>Troubleshooting \u2014 Debug common issues</li> </ul>"},{"location":"guide/deployment-strategies/","title":"Deployment Strategies","text":"<p>Ghostwire uses a StatefulSet to run Signal Desktop. This design choice has implications for how updates work and why certain deployment patterns don't apply.</p>"},{"location":"guide/deployment-strategies/#why-statefulset","title":"Why StatefulSet","text":"<p>Signal Desktop is a stateful application tied to a single phone number. The StatefulSet provides:</p> <p>Stable pod identity: The pod is always named <code>ghostwire-0</code>, making debugging and log analysis predictable.</p> <p>Ordered operations: During updates, the existing pod terminates fully before the replacement starts. This prevents two pods from competing for the same resources.</p> <p>Persistent storage binding: The PVC automatically rebinds to the pod after restarts. Your Signal data follows the pod.</p>"},{"location":"guide/deployment-strategies/#update-process","title":"Update Process","text":"<p>When you upgrade the Helm release (new image tag, configuration change):</p> <ol> <li>Helm updates the StatefulSet spec</li> <li>The StatefulSet controller terminates <code>ghostwire-0</code> with graceful shutdown</li> <li>After termination completes, a new pod starts with the updated configuration</li> <li>The new pod mounts the same PVC\u2014all your data persists</li> <li>Once the pod passes readiness checks, the Service routes traffic to it</li> </ol> <p>Expected downtime: 30-90 seconds during pod replacement.</p>"},{"location":"guide/deployment-strategies/#why-canary-deployments-dont-work","title":"Why Canary Deployments Don't Work","text":"<p>Tools like Flagger require running multiple replicas simultaneously, splitting traffic between old and new versions. This doesn't work for Ghostwire because:</p> <p>Single PVC with ReadWriteOnce: The persistent volume can only attach to one pod at a time. A canary pod would be stuck in <code>Pending</code> waiting for the volume.</p> <p>SQLite concurrency: Even with ReadWriteMany storage, Signal Desktop uses SQLite which doesn't support concurrent writers. Two pods accessing the same database would cause corruption.</p> <p>Single user session: Signal Desktop is tied to one phone number with one VNC session. There's no concept of \"traffic splitting\"\u2014you're either connected or not.</p>"},{"location":"guide/deployment-strategies/#rolling-update-configuration","title":"Rolling Update Configuration","text":"<p>The StatefulSet uses rolling updates by default:</p> <pre><code>spec:\n  updateStrategy:\n    type: RollingUpdate\n</code></pre> <p>This means updates happen one pod at a time (which for Ghostwire is just one pod). The replacement pod must pass readiness checks before the update is considered complete.</p>"},{"location":"guide/deployment-strategies/#rollback","title":"Rollback","text":"<p>If an upgrade fails, Helm provides automatic rollback:</p> <pre><code># Rollback to previous release\nhelm rollback ghostwire -n ghostwire\n\n# Rollback to specific revision\nhelm rollback ghostwire 3 -n ghostwire\n</code></pre> <p>With Flux CD, configure automatic rollback on test failure:</p> <pre><code>apiVersion: helm.toolkit.fluxcd.io/v2\nkind: HelmRelease\nspec:\n  test:\n    enable: true\n  upgrade:\n    remediation:\n      retries: 3\n      remediateLastFailure: true\n</code></pre>"},{"location":"guide/deployment-strategies/#bluegreen-manual","title":"Blue/Green (Manual)","text":"<p>For zero-downtime updates where you need full validation before switching:</p> <ol> <li>Deploy a new release in a separate namespace (<code>ghostwire-green</code>)</li> <li>Test the green deployment manually</li> <li>Update the ingress to point to the green service</li> <li>After validation, delete the blue deployment</li> </ol> <p>The downside is that each deployment has its own PVC\u2014you can't easily share Signal data between them without a migration step.</p> <pre><code># Deploy green version\nhelm install ghostwire-green oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --create-namespace -n ghostwire-green\n\n# Test it\nkubectl port-forward -n ghostwire-green svc/ghostwire 6902:6901\n\n# Switch ingress (example for nginx)\nkubectl patch ingress ghostwire -n ghostwire \\\n  --patch '{\"spec\":{\"rules\":[{\"http\":{\"paths\":[{\"backend\":{\"service\":{\"name\":\"ghostwire-green\",\"namespace\":\"ghostwire-green\"}}}]}}]}}'\n\n# After validation, remove blue\nhelm uninstall ghostwire -n ghostwire\n</code></pre>"},{"location":"guide/deployment-strategies/#recommended-approach","title":"Recommended Approach","text":"<p>For Ghostwire's use case, the standard StatefulSet rolling update is the right choice:</p> <ul> <li>Simple and reliable</li> <li>Data integrity guaranteed by single-pod access</li> <li>Helm and Flux provide rollback mechanisms</li> <li>Brief downtime (30-90 seconds) is acceptable for a personal desktop application</li> </ul> <p>Accept the tradeoff: comprehensive testing validates changes before rollout, and automatic rollback handles failures. Progressive delivery patterns designed for stateless microservices don't fit this architecture.</p>"},{"location":"guide/infrastructure-integration/","title":"Infrastructure Integration","text":"<p>Ghostwire delegates infrastructure concerns to your existing Kubernetes platform. This guide shows how to integrate with common infrastructure components.</p>"},{"location":"guide/infrastructure-integration/#design-rationale","title":"Design Rationale","text":"<p>The chart doesn't include ingress templates, authentication configuration, or TLS settings. Why?</p> <p>Every organization has different ingress controllers, identity providers, and security policies. Including templates would require maintaining compatibility with dozens of tools and would inevitably conflict with your existing configuration.</p> <p>Instead, the chart exposes a ClusterIP Service. You route to it using whatever infrastructure you already run.</p>"},{"location":"guide/infrastructure-integration/#ingress","title":"Ingress","text":""},{"location":"guide/infrastructure-integration/#nginx-ingress-controller","title":"nginx Ingress Controller","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    nginx.ingress.kubernetes.io/proxy-read-timeout: \"3600\"\n    nginx.ingress.kubernetes.io/proxy-send-timeout: \"3600\"\nspec:\n  ingressClassName: nginx\n  rules:\n    - host: signal.example.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: ghostwire\n                port:\n                  number: 6901\n</code></pre> <p>The timeout annotations are important for VNC\u2014connections are long-lived.</p>"},{"location":"guide/infrastructure-integration/#traefik","title":"Traefik","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    traefik.ingress.kubernetes.io/router.entrypoints: websecure\nspec:\n  rules:\n    - host: signal.example.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: ghostwire\n                port:\n                  number: 6901\n</code></pre>"},{"location":"guide/infrastructure-integration/#tls-with-cert-manager","title":"TLS with cert-manager","text":"<p>Add TLS termination using cert-manager and Let's Encrypt:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    cert-manager.io/cluster-issuer: letsencrypt-prod\nspec:\n  ingressClassName: nginx\n  tls:\n    - hosts:\n        - signal.example.com\n      secretName: ghostwire-tls\n  rules:\n    - host: signal.example.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: ghostwire\n                port:\n                  number: 6901\n</code></pre> <p>cert-manager will automatically provision and renew the certificate.</p>"},{"location":"guide/infrastructure-integration/#authentication-with-oauth2-proxy","title":"Authentication with OAuth2-Proxy","text":"<p>VNC access is unprotected by default. For production, add authentication at the ingress layer.</p>"},{"location":"guide/infrastructure-integration/#deploy-oauth2-proxy","title":"Deploy OAuth2-Proxy","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: oauth2-proxy\n  namespace: ghostwire\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: oauth2-proxy\n  template:\n    metadata:\n      labels:\n        app: oauth2-proxy\n    spec:\n      containers:\n        - name: oauth2-proxy\n          image: quay.io/oauth2-proxy/oauth2-proxy:v7.5.1\n          args:\n            - --provider=google  # or github, azure, etc.\n            - --upstream=http://ghostwire:6901\n            - --http-address=0.0.0.0:4180\n            - --email-domain=example.com\n            - --cookie-secure=true\n          env:\n            - name: OAUTH2_PROXY_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: oauth2-proxy\n                  key: client-id\n            - name: OAUTH2_PROXY_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: oauth2-proxy\n                  key: client-secret\n            - name: OAUTH2_PROXY_COOKIE_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: oauth2-proxy\n                  key: cookie-secret\n          ports:\n            - containerPort: 4180\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: oauth2-proxy\n  namespace: ghostwire\nspec:\n  selector:\n    app: oauth2-proxy\n  ports:\n    - port: 4180\n</code></pre>"},{"location":"guide/infrastructure-integration/#route-ingress-through-oauth2-proxy","title":"Route Ingress Through OAuth2-Proxy","text":"<p>Point the ingress at OAuth2-Proxy instead of Ghostwire directly:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  annotations:\n    cert-manager.io/cluster-issuer: letsencrypt-prod\nspec:\n  ingressClassName: nginx\n  tls:\n    - hosts:\n        - signal.example.com\n      secretName: ghostwire-tls\n  rules:\n    - host: signal.example.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: oauth2-proxy\n                port:\n                  number: 4180\n</code></pre> <p>Now users must authenticate through your identity provider before accessing Signal Desktop.</p>"},{"location":"guide/infrastructure-integration/#network-policies","title":"Network Policies","text":"<p>Restrict traffic to the Ghostwire namespace:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: ghostwire-ingress\n  namespace: ghostwire\nspec:\n  podSelector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  policyTypes:\n    - Ingress\n  ingress:\n    - from:\n        - namespaceSelector:\n            matchLabels:\n              name: ingress-nginx  # Only allow from ingress namespace\n      ports:\n        - protocol: TCP\n          port: 6901\n</code></pre>"},{"location":"guide/infrastructure-integration/#monitoring","title":"Monitoring","text":"<p>If you're using Prometheus, add a ServiceMonitor:</p> <pre><code>apiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  endpoints:\n    - port: http\n      interval: 30s\n</code></pre> <p>Note: The Kasm container doesn't expose Prometheus metrics natively. You may need a sidecar exporter for detailed application metrics.</p>"},{"location":"guide/infrastructure-integration/#backup-with-velero","title":"Backup with Velero","text":"<p>Back up the Signal data PVC:</p> <pre><code>apiVersion: velero.io/v1\nkind: Schedule\nmetadata:\n  name: ghostwire-backup\n  namespace: velero\nspec:\n  schedule: \"0 2 * * *\"  # Daily at 2am\n  template:\n    includedNamespaces:\n      - ghostwire\n    includedResources:\n      - persistentvolumeclaims\n      - persistentvolumes\n    storageLocation: default\n    ttl: 720h  # 30 days\n</code></pre>"},{"location":"guide/infrastructure-integration/#service-mesh","title":"Service Mesh","text":"<p>For Linkerd:</p> <pre><code># In your Helm values\npodAnnotations:\n  linkerd.io/inject: enabled\n</code></pre> <p>For Istio:</p> <pre><code>podAnnotations:\n  sidecar.istio.io/inject: \"true\"\n</code></pre> <p>The service mesh provides mTLS between services automatically.</p>"},{"location":"guide/overview/","title":"Overview","text":"<p>Ghostwire packages Signal Desktop for Kubernetes deployment. Understanding the design decisions helps you integrate it effectively with your infrastructure.</p>"},{"location":"guide/overview/#design-philosophy","title":"Design Philosophy","text":"<p>The chart focuses on running Signal Desktop reliably and staying out of your infrastructure's way. It doesn't replicate functionality that Kubernetes and your platform already provide.</p> <p>What the chart handles:</p> <ul> <li>Container runtime configuration for Signal Desktop</li> <li>StatefulSet for stable pod identity and ordered operations</li> <li>PVC for data persistence</li> <li>Service exposure for VNC access</li> <li>Health checks and readiness probes</li> </ul> <p>What your platform handles:</p> <ul> <li>Authentication (OAuth2-proxy, Dex, or similar)</li> <li>TLS termination (cert-manager)</li> <li>Ingress routing (nginx, traefik, or your preferred controller)</li> <li>Network policies</li> <li>Secrets management</li> </ul> <p>This separation means less configuration overlap and fewer conflicts between chart-level and platform-level settings.</p>"},{"location":"guide/overview/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Kubernetes Cluster                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502                    Ingress Namespace                       \u2502  \u2502\n\u2502  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502  \u2502\n\u2502  \u2502   \u2502   Ingress   \u2502\u2500\u2500\u2500\u2500\u25b6\u2502 OAuth2-Proxy\u2502                     \u2502  \u2502\n\u2502  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                 \u2502                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502                    Ghostwire Namespace                     \u2502  \u2502\n\u2502  \u2502                              \u25bc                             \u2502  \u2502\n\u2502  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502  \u2502\n\u2502  \u2502   \u2502   Service   \u2502\u2500\u2500\u2500\u2500\u25b6\u2502 StatefulSet \u2502\u2500\u2500\u2500\u2500\u25b6\u2502    PVC    \u2502   \u2502  \u2502\n\u2502  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"guide/overview/#statefulset-vs-deployment","title":"StatefulSet vs Deployment","text":"<p>The chart uses a StatefulSet rather than a Deployment:</p> <ul> <li>Stable pod identity (<code>ghostwire-0</code>) for debugging and log analysis</li> <li>Ordered pod operations (important during upgrades with VNC sessions)</li> <li>Stable PVC binding (the same volume reattaches after pod restart)</li> </ul> <p>Since Signal Desktop links to a single phone number, only one replica is supported.</p>"},{"location":"guide/overview/#container-stack","title":"Container Stack","text":"<p>The container runs several components:</p> <ul> <li>Xvfb \u2014 Virtual framebuffer for headless X11</li> <li>XFCE \u2014 Lightweight desktop environment</li> <li>KasmVNC \u2014 VNC server with HTML5 web client</li> <li>Signal Desktop \u2014 The Electron application</li> </ul> <p>Kasm Technologies maintains the container images. They're built on Ubuntu with security patches applied regularly.</p>"},{"location":"guide/overview/#data-persistence","title":"Data Persistence","text":"<p>Signal Desktop stores data in <code>/home/kasm-user</code>:</p> <ul> <li><code>~/.config/Signal/</code> \u2014 Application configuration, encryption keys</li> <li><code>~/.local/share/Signal/</code> \u2014 Message database, attachments</li> </ul> <p>The PVC mounts at <code>/home/kasm-user</code> to persist the entire user directory. This preserves all application state across pod restarts.</p> <p>Important: The encryption keys for your messages are stored on this volume. Losing the PVC means losing access to message history. Use appropriate backup and retention policies.</p>"},{"location":"guide/overview/#network-model","title":"Network Model","text":"<p>The container exposes port 6901 for VNC connections. The Kubernetes Service routes traffic to this port.</p> <p>VNC traffic is unencrypted by default. In production, terminate TLS at the ingress layer. Don't expose the Service directly with <code>type: LoadBalancer</code> unless you've added TLS at the network level.</p>"},{"location":"guide/overview/#authentication-boundary","title":"Authentication Boundary","text":"<p>The chart doesn't include authentication. VNC access is open to anyone who can reach the Service.</p> <p>For production:</p> <ol> <li>Don't expose the Service externally</li> <li>Route through an ingress with authentication (OAuth2-proxy, Dex, etc.)</li> <li>Use network policies to restrict access to the namespace</li> </ol> <p>See Infrastructure Integration for patterns.</p>"},{"location":"guide/persistence/","title":"Persistence","text":"<p>Signal Desktop stores messages, encryption keys, and media on disk. Ghostwire uses a PersistentVolumeClaim to ensure this data survives pod restarts.</p>"},{"location":"guide/persistence/#what-gets-stored","title":"What Gets Stored","text":"<p>The container user home directory (<code>/home/kasm-user</code>) contains:</p> <ul> <li><code>~/.config/Signal/</code> \u2014 Application configuration and encryption keys</li> <li><code>~/.local/share/Signal/</code> \u2014 SQLite message database and attachments</li> </ul> <p>The PVC mounts at <code>/home/kasm-user</code> to capture the entire user directory.</p>"},{"location":"guide/persistence/#default-configuration","title":"Default Configuration","text":"<pre><code>persistence:\n  enabled: true\n  size: 10Gi\n  accessMode: ReadWriteOnce\n  # storageClass: \"\"  # Uses cluster default\n  mountPath: /home/kasm-user\n</code></pre> <p>The default 10Gi is sufficient for typical usage. If you exchange a lot of media, increase the size.</p>"},{"location":"guide/persistence/#storage-class-selection","title":"Storage Class Selection","text":"<p>Most managed Kubernetes services provide a default storage class. For production, you may want to specify one explicitly:</p> <pre><code># List available storage classes\nkubectl get storageclass\n\n# Specify in Helm values\nhelm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set persistence.storageClass=premium-ssd \\\n  -n ghostwire\n</code></pre> <p>Consider:</p> <ul> <li>SSD-backed storage for better performance (Signal Desktop does frequent database writes)</li> <li>Retention policy \u2014 some storage classes delete the underlying volume when the PVC is deleted</li> </ul>"},{"location":"guide/persistence/#resizing","title":"Resizing","text":"<p>Many storage providers support volume expansion. If you need more space:</p> <pre><code># Check if storage class allows expansion\nkubectl get storageclass &lt;name&gt; -o jsonpath='{.allowVolumeExpansion}'\n\n# If true, just update the PVC size\nhelm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set persistence.size=50Gi \\\n  -n ghostwire\n</code></pre> <p>The volume expands without data loss. The pod may need to restart for the filesystem to recognize the new size.</p>"},{"location":"guide/persistence/#backup-strategies","title":"Backup Strategies","text":""},{"location":"guide/persistence/#velero","title":"Velero","text":"<p>Velero can snapshot PVCs on supported storage providers:</p> <pre><code>apiVersion: velero.io/v1\nkind: Schedule\nmetadata:\n  name: ghostwire-daily\n  namespace: velero\nspec:\n  schedule: \"0 3 * * *\"\n  template:\n    includedNamespaces:\n      - ghostwire\n    includedResources:\n      - persistentvolumeclaims\n</code></pre>"},{"location":"guide/persistence/#manual-snapshot","title":"Manual Snapshot","text":"<p>For cloud providers with snapshot APIs:</p> <pre><code># AWS EBS\naws ec2 create-snapshot --volume-id &lt;volume-id&gt; --description \"ghostwire backup\"\n\n# GCP\ngcloud compute disks snapshot &lt;disk-name&gt; --zone=&lt;zone&gt;\n</code></pre>"},{"location":"guide/persistence/#file-level-backup","title":"File-Level Backup","text":"<p>If volume snapshots aren't available, copy files to external storage:</p> <pre><code># Create a backup job\nkubectl create job signal-backup --image=busybox -n ghostwire -- \\\n  tar czf /backup/signal-$(date +%Y%m%d).tar.gz -C /data .\n</code></pre> <p>Mount both the Signal PVC and a backup PVC to the job.</p>"},{"location":"guide/persistence/#encryption","title":"Encryption","text":"<p>Signal Desktop encrypts messages with keys stored in <code>~/.config/Signal/</code>. The database is not encrypted at the filesystem level\u2014encryption happens at the application layer.</p> <p>For additional protection:</p> <ul> <li>Use encrypted storage classes if your provider offers them</li> <li>Enable Kubernetes secrets encryption at rest</li> <li>Consider network-level encryption (mTLS via service mesh)</li> </ul>"},{"location":"guide/persistence/#data-loss-scenarios","title":"Data Loss Scenarios","text":""},{"location":"guide/persistence/#pvc-deleted","title":"PVC Deleted","text":"<p>If the PVC is deleted, Signal Desktop starts fresh. You'll need to re-link with your phone and message history won't sync (Signal doesn't store message history on servers).</p> <p>Prevention: Use <code>helm uninstall</code> carefully\u2014the default behavior retains PVCs. Explicitly delete PVCs only when you intend to lose the data.</p>"},{"location":"guide/persistence/#storage-provider-failure","title":"Storage Provider Failure","text":"<p>If the underlying storage fails, data may be unrecoverable.</p> <p>Prevention: Regular backups to a separate storage system. For critical deployments, use storage with built-in replication.</p>"},{"location":"guide/persistence/#corrupted-database","title":"Corrupted Database","text":"<p>SQLite corruption is rare but possible (power loss during writes, storage hardware issues).</p> <p>Recovery: Restore from backup. Signal Desktop may be able to re-sync some recent messages from your phone, but older messages are lost if not backed up.</p>"},{"location":"guide/persistence/#multi-cluster-considerations","title":"Multi-Cluster Considerations","text":"<p>PVCs are bound to a single cluster. If you need Signal Desktop in multiple clusters:</p> <ul> <li>Each cluster has its own instance with its own PVC</li> <li>You can only link one Signal Desktop instance per phone number at a time</li> <li>Switching clusters means re-linking (your old session becomes disconnected)</li> </ul> <p>There's no supported way to share a Signal Desktop session across clusters.</p>"},{"location":"operations/monitoring/","title":"Monitoring","text":"<p>Ghostwire's health can be monitored through Kubernetes probes, resource metrics, and external observability tools.</p>"},{"location":"operations/monitoring/#health-probes","title":"Health Probes","text":"<p>The Helm chart configures liveness and readiness probes:</p> <pre><code>livenessProbe:\n  tcpSocket:\n    port: 6901\n  initialDelaySeconds: 60\n  periodSeconds: 30\n  failureThreshold: 3\n\nreadinessProbe:\n  tcpSocket:\n    port: 6901\n  initialDelaySeconds: 30\n  periodSeconds: 10\n  failureThreshold: 5\n</code></pre> <p>These check TCP connectivity to the VNC port. The pod is considered unhealthy if: - VNC server stops responding - Signal Desktop crashes and takes down the X server - Resource exhaustion prevents connections</p>"},{"location":"operations/monitoring/#resource-metrics","title":"Resource Metrics","text":"<p>Monitor pod resource consumption:</p> <pre><code># Current resource usage\nkubectl top pod -n ghostwire\n\n# Watch over time\nkubectl top pod -n ghostwire --watch\n</code></pre> <p>Key metrics to watch:</p> Metric Normal Range Alert Threshold Memory 700MB - 1.5GB &gt; 3GB CPU 10-30% &gt; 80% sustained Network TX Varies with usage Unusual spikes"},{"location":"operations/monitoring/#prometheus-integration","title":"Prometheus Integration","text":"<p>If you're running Prometheus, create a ServiceMonitor:</p> <pre><code>apiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\n  labels:\n    release: prometheus\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ghostwire\n  namespaceSelector:\n    matchNames:\n      - ghostwire\n  endpoints:\n    - port: http\n      interval: 30s\n</code></pre> <p>Note: The Kasm container doesn't expose Prometheus metrics natively. You'll get basic service discovery but no application-specific metrics without additional instrumentation.</p>"},{"location":"operations/monitoring/#kube-state-metrics","title":"kube-state-metrics","text":"<p>Standard Kubernetes metrics are available through kube-state-metrics:</p> <pre><code># Pod restarts\nkube_pod_container_status_restarts_total{namespace=\"ghostwire\"}\n\n# Pod phase\nkube_pod_status_phase{namespace=\"ghostwire\"}\n\n# Container resource requests vs usage\ncontainer_memory_usage_bytes{namespace=\"ghostwire\"}\n  / on(pod) kube_pod_container_resource_requests{namespace=\"ghostwire\", resource=\"memory\"}\n</code></pre>"},{"location":"operations/monitoring/#alerting-rules","title":"Alerting Rules","text":"<p>Example PrometheusRule:</p> <pre><code>apiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n  name: ghostwire-alerts\n  namespace: ghostwire\nspec:\n  groups:\n    - name: ghostwire\n      rules:\n        - alert: GhostwirePodNotReady\n          expr: |\n            kube_pod_status_ready{namespace=\"ghostwire\", condition=\"true\"} == 0\n          for: 5m\n          labels:\n            severity: critical\n          annotations:\n            summary: \"Ghostwire pod not ready\"\n            description: \"Pod {{ $labels.pod }} has been not ready for 5 minutes\"\n\n        - alert: GhostwireHighMemory\n          expr: |\n            container_memory_usage_bytes{namespace=\"ghostwire\", container=\"ghostwire\"}\n              / container_spec_memory_limit_bytes{namespace=\"ghostwire\", container=\"ghostwire\"}\n              &gt; 0.9\n          for: 10m\n          labels:\n            severity: warning\n          annotations:\n            summary: \"Ghostwire memory usage high\"\n            description: \"Memory usage above 90% for 10 minutes\"\n\n        - alert: GhostwireRestarting\n          expr: |\n            increase(kube_pod_container_status_restarts_total{namespace=\"ghostwire\"}[1h]) &gt; 3\n          labels:\n            severity: warning\n          annotations:\n            summary: \"Ghostwire pod restarting frequently\"\n            description: \"Pod has restarted {{ $value }} times in the last hour\"\n</code></pre>"},{"location":"operations/monitoring/#logging","title":"Logging","text":"<p>Container logs go to stdout/stderr:</p> <pre><code># View logs\nkubectl logs -n ghostwire statefulset/ghostwire\n\n# Follow logs\nkubectl logs -n ghostwire statefulset/ghostwire -f\n\n# Previous container (if restarted)\nkubectl logs -n ghostwire statefulset/ghostwire --previous\n</code></pre> <p>Log aggregation with Loki, Elasticsearch, or your preferred solution works with standard Kubernetes log collection.</p>"},{"location":"operations/monitoring/#log-content","title":"Log Content","text":"<p>The container logs contain: - Xvnc connection events - XFCE session messages - Signal Desktop console output - Error messages and stack traces</p> <p>Signal Desktop logs are verbose at startup but quiet during normal operation.</p>"},{"location":"operations/monitoring/#dashboard","title":"Dashboard","text":"<p>Grafana dashboard for Ghostwire:</p> <pre><code>{\n  \"title\": \"Ghostwire\",\n  \"panels\": [\n    {\n      \"title\": \"Pod Status\",\n      \"type\": \"stat\",\n      \"targets\": [\n        {\n          \"expr\": \"kube_pod_status_ready{namespace='ghostwire', condition='true'}\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Memory Usage\",\n      \"type\": \"timeseries\",\n      \"targets\": [\n        {\n          \"expr\": \"container_memory_usage_bytes{namespace='ghostwire', container='ghostwire'}\"\n        }\n      ]\n    },\n    {\n      \"title\": \"CPU Usage\",\n      \"type\": \"timeseries\",\n      \"targets\": [\n        {\n          \"expr\": \"rate(container_cpu_usage_seconds_total{namespace='ghostwire', container='ghostwire'}[5m])\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Restarts\",\n      \"type\": \"stat\",\n      \"targets\": [\n        {\n          \"expr\": \"kube_pod_container_status_restarts_total{namespace='ghostwire'}\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"operations/monitoring/#uptime-monitoring","title":"Uptime Monitoring","text":"<p>External uptime checks can verify accessibility:</p> <pre><code># UptimeRobot, Pingdom, or similar\ntype: HTTP\nurl: https://signal.example.com/\nmethod: GET\nexpected_status: 200  # or 401 if behind auth\ninterval: 60s\n</code></pre> <p>Note: The VNC endpoint returns an HTML page, not a health check endpoint. Check for HTTP 200 (or 401/302 if behind authentication).</p>"},{"location":"operations/troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and how to resolve them.</p>"},{"location":"operations/troubleshooting/#pod-wont-start","title":"Pod Won't Start","text":""},{"location":"operations/troubleshooting/#pending-state","title":"Pending State","text":"<pre><code>kubectl describe pod -n ghostwire ghostwire-0\n</code></pre> <p>PVC not bound: Check if the storage class exists and has available capacity.</p> <pre><code>kubectl get pvc -n ghostwire\nkubectl get storageclass\n</code></pre> <p>Insufficient resources: The node may not have enough memory or CPU.</p> <pre><code>kubectl describe node &lt;node-name&gt; | grep -A5 \"Allocated resources\"\n</code></pre> <p>Reduce resource requests or add nodes to the cluster.</p>"},{"location":"operations/troubleshooting/#crashloopbackoff","title":"CrashLoopBackOff","text":"<p>Check container logs:</p> <pre><code>kubectl logs -n ghostwire ghostwire-0 --previous\n</code></pre> <p>Common causes:</p> <ul> <li>Memory pressure: Signal Desktop runs out of memory. Increase the limit.</li> <li>Corrupted data: The Signal database is corrupted. May need to delete the PVC and re-link.</li> <li>Image pull failure: Check image availability and pull secrets.</li> </ul>"},{"location":"operations/troubleshooting/#vnc-connection-issues","title":"VNC Connection Issues","text":""},{"location":"operations/troubleshooting/#cant-connect","title":"Can't Connect","text":"<ol> <li>Verify the pod is running and ready:</li> </ol> <pre><code>kubectl get pods -n ghostwire\n</code></pre> <ol> <li>Check the service:</li> </ol> <pre><code>kubectl get svc -n ghostwire\n</code></pre> <ol> <li>Test direct connectivity:</li> </ol> <pre><code>kubectl port-forward -n ghostwire svc/ghostwire 6901:6901\n# Then open http://localhost:6901\n</code></pre> <ol> <li>If using ingress, check ingress status:</li> </ol> <pre><code>kubectl describe ingress -n ghostwire ghostwire\n</code></pre>"},{"location":"operations/troubleshooting/#black-screen","title":"Black Screen","text":"<p>The X server is running but Signal Desktop may not have started.</p> <pre><code># Check processes in the container\nkubectl exec -n ghostwire ghostwire-0 -- ps aux\n</code></pre> <p>Look for <code>signal-desktop</code> in the process list. If missing, check logs for startup errors.</p>"},{"location":"operations/troubleshooting/#slowlaggy","title":"Slow/Laggy","text":"<p>VNC performance depends on network latency and bandwidth.</p> <ul> <li>Reduce resolution: Set <code>VNC_RESOLUTION=1280x720</code> in environment</li> <li>Use a closer network path (avoid transcontinental connections)</li> <li>Ensure adequate bandwidth (VNC uses 1-5 Mbps depending on activity)</li> </ul>"},{"location":"operations/troubleshooting/#signal-desktop-issues","title":"Signal Desktop Issues","text":""},{"location":"operations/troubleshooting/#not-linked","title":"Not Linked","text":"<p>If Signal Desktop shows the QR code linking screen after a pod restart, your data may have been lost.</p> <p>Check PVC status:</p> <pre><code>kubectl get pvc -n ghostwire\nkubectl describe pvc -n ghostwire &lt;pvc-name&gt;\n</code></pre> <p>If the PVC was deleted or replaced, you'll need to re-link with your phone.</p>"},{"location":"operations/troubleshooting/#cant-receive-messages","title":"Can't Receive Messages","text":"<p>Signal Desktop requires an active connection to Signal's servers.</p> <ol> <li>Check network egress:</li> </ol> <pre><code>kubectl exec -n ghostwire ghostwire-0 -- curl -v https://chat.signal.org\n</code></pre> <ol> <li> <p>If using network policies, ensure egress to Signal servers is allowed (port 443).</p> </li> <li> <p>Check if Signal is rate-limiting:</p> </li> </ol> <pre><code>kubectl logs -n ghostwire ghostwire-0 | grep -i rate\n</code></pre>"},{"location":"operations/troubleshooting/#high-memory-usage","title":"High Memory Usage","text":"<p>Signal Desktop memory grows with: - Number of conversations - Message history length - Media attachments</p> <p>If memory exceeds limits:</p> <ol> <li>Increase the memory limit:</li> </ol> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set resources.limits.memory=8Gi \\\n  -n ghostwire\n</code></pre> <ol> <li> <p>Delete old conversations from within Signal Desktop</p> </li> <li> <p>Consider clearing attachment cache (will re-download when viewed)</p> </li> </ol>"},{"location":"operations/troubleshooting/#storage-issues","title":"Storage Issues","text":""},{"location":"operations/troubleshooting/#pvc-full","title":"PVC Full","text":"<p>Check usage:</p> <pre><code>kubectl exec -n ghostwire ghostwire-0 -- df -h /home/kasm-user\n</code></pre> <p>Expand the PVC if your storage class supports it:</p> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set persistence.size=50Gi \\\n  -n ghostwire\n</code></pre>"},{"location":"operations/troubleshooting/#data-corruption","title":"Data Corruption","text":"<p>SQLite corruption can occur from unclean shutdowns.</p> <p>Symptoms: - Signal Desktop won't start - Errors mentioning \"database malformed\" in logs</p> <p>Recovery options:</p> <ol> <li>Restore from backup (see Persistence)</li> <li>Delete the PVC and re-link (loses message history)</li> </ol> <pre><code># Delete and recreate\nhelm uninstall ghostwire -n ghostwire\nkubectl delete pvc -l app.kubernetes.io/name=ghostwire -n ghostwire\nhelm install ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --create-namespace -n ghostwire\n</code></pre>"},{"location":"operations/troubleshooting/#authentication-issues","title":"Authentication Issues","text":""},{"location":"operations/troubleshooting/#oauth2-proxy-not-redirecting","title":"OAuth2-Proxy Not Redirecting","text":"<p>Check OAuth2-Proxy logs:</p> <pre><code>kubectl logs -n ghostwire -l app=oauth2-proxy\n</code></pre> <p>Common causes: - Incorrect redirect URI in identity provider configuration - Cookie domain mismatch - Invalid client credentials</p>"},{"location":"operations/troubleshooting/#403-after-authentication","title":"403 After Authentication","text":"<p>The user may not be authorized. Check OAuth2-Proxy configuration:</p> <ul> <li><code>--email-domain</code> restricts by email domain</li> <li><code>--authenticated-emails-file</code> restricts to specific emails</li> <li>Identity provider may have group/role restrictions</li> </ul>"},{"location":"operations/troubleshooting/#upgrade-issues","title":"Upgrade Issues","text":""},{"location":"operations/troubleshooting/#helm-upgrade-fails","title":"Helm Upgrade Fails","text":"<pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  -n ghostwire 2&gt;&amp;1 | tail -20\n</code></pre> <p>Common causes: - Immutable field changed (need to uninstall and reinstall) - Schema validation failure (check values against values.schema.json) - Incompatible Kubernetes version</p>"},{"location":"operations/troubleshooting/#pod-stuck-terminating","title":"Pod Stuck Terminating","text":"<p>Force deletion if graceful shutdown hangs:</p> <pre><code>kubectl delete pod ghostwire-0 -n ghostwire --grace-period=0 --force\n</code></pre>"},{"location":"operations/troubleshooting/#getting-help","title":"Getting Help","text":"<ol> <li>Check the GitHub Discussions for community help</li> <li>Search Issues for known problems</li> <li>File a bug report with:</li> <li>Kubernetes version</li> <li>Helm chart version</li> <li>Relevant logs</li> <li>Steps to reproduce</li> </ol>"},{"location":"operations/upgrades/","title":"Upgrades","text":"<p>Upgrading Ghostwire involves updating the Helm release. This guide covers upgrade procedures and rollback strategies.</p>"},{"location":"operations/upgrades/#upgrade-process","title":"Upgrade Process","text":""},{"location":"operations/upgrades/#check-current-version","title":"Check Current Version","text":"<pre><code>helm list -n ghostwire\n</code></pre>"},{"location":"operations/upgrades/#list-available-versions","title":"List Available Versions","text":"<pre><code># OCI registry\nskopeo list-tags docker://ghcr.io/drengskapur/charts/ghostwire\n\n# Or check GitHub releases\ngh release list -R drengskapur/ghostwire\n</code></pre>"},{"location":"operations/upgrades/#upgrade","title":"Upgrade","text":"<pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --version &lt;new-version&gt; \\\n  -n ghostwire\n</code></pre> <p>Keep your custom values:</p> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --version &lt;new-version&gt; \\\n  -f values-production.yaml \\\n  -n ghostwire\n</code></pre>"},{"location":"operations/upgrades/#what-happens-during-upgrade","title":"What Happens During Upgrade","text":"<ol> <li>Helm compares the new manifest with the current state</li> <li>The StatefulSet spec is updated</li> <li>The existing pod (<code>ghostwire-0</code>) terminates gracefully</li> <li>A new pod starts with the updated configuration</li> <li>The pod mounts the same PVC\u2014your data persists</li> <li>Readiness probes confirm the pod is healthy</li> </ol> <p>Expected downtime: 30-90 seconds while the pod restarts.</p>"},{"location":"operations/upgrades/#pre-upgrade-checklist","title":"Pre-Upgrade Checklist","text":"<ol> <li>Backup your data</li> </ol> <pre><code># Create a snapshot if your storage class supports it\nkubectl get pvc -n ghostwire -o jsonpath='{.items[0].spec.volumeName}'\n# Use your cloud provider's snapshot API\n</code></pre> <ol> <li>Review the changelog</li> </ol> <p>Check the release notes for breaking changes:</p> <pre><code>gh release view &lt;version&gt; -R drengskapur/ghostwire\n</code></pre> <ol> <li>Test in a staging environment (if available)</li> </ol>"},{"location":"operations/upgrades/#rollback","title":"Rollback","text":"<p>If the upgrade fails or introduces issues:</p> <pre><code># Rollback to previous release\nhelm rollback ghostwire -n ghostwire\n\n# Rollback to specific revision\nhelm history ghostwire -n ghostwire\nhelm rollback ghostwire &lt;revision&gt; -n ghostwire\n</code></pre>"},{"location":"operations/upgrades/#automatic-rollback-with-flux-cd","title":"Automatic Rollback with Flux CD","text":"<pre><code>apiVersion: helm.toolkit.fluxcd.io/v2\nkind: HelmRelease\nmetadata:\n  name: ghostwire\n  namespace: ghostwire\nspec:\n  chart:\n    spec:\n      chart: oci://ghcr.io/drengskapur/charts/ghostwire\n      version: \"&gt;=1.0.0\"\n  test:\n    enable: true\n  upgrade:\n    remediation:\n      retries: 3\n      remediateLastFailure: true\n</code></pre> <p>Flux will run Helm tests after upgrade and rollback if they fail.</p>"},{"location":"operations/upgrades/#image-updates","title":"Image Updates","text":"<p>The container image may update more frequently than the chart. To update just the image:</p> <pre><code>helm upgrade ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  --set image.tag=1.19.0-rolling-daily \\\n  -n ghostwire\n</code></pre>"},{"location":"operations/upgrades/#image-tag-strategies","title":"Image Tag Strategies","text":"<p>Pinned version (recommended for production):</p> <pre><code>image:\n  tag: \"1.18.0\"\n  pullPolicy: IfNotPresent\n</code></pre> <p>Rolling tag (latest within minor version):</p> <pre><code>image:\n  tag: \"1.18.0-rolling-daily\"\n  pullPolicy: Always\n</code></pre> <p>Rolling tags get updates automatically but may introduce unexpected changes.</p>"},{"location":"operations/upgrades/#breaking-changes","title":"Breaking Changes","text":""},{"location":"operations/upgrades/#detecting-breaking-changes","title":"Detecting Breaking Changes","text":"<p>Check the changelog for: - Major version bumps (1.x \u2192 2.x) - Notes about \"breaking changes\" or \"migration required\" - Changes to default values - Removed or renamed values</p>"},{"location":"operations/upgrades/#common-breaking-changes","title":"Common Breaking Changes","text":"<p>Renamed values: Helm will error if you pass unknown values. Update your values file.</p> <p>Changed defaults: Review the diff between your values and new defaults:</p> <pre><code>helm show values oci://ghcr.io/drengskapur/charts/ghostwire --version &lt;new&gt; &gt; new-defaults.yaml\nhelm show values oci://ghcr.io/drengskapur/charts/ghostwire --version &lt;old&gt; &gt; old-defaults.yaml\ndiff old-defaults.yaml new-defaults.yaml\n</code></pre> <p>Schema changes: The chart includes a JSON schema. Validate your values:</p> <pre><code>helm template ghostwire oci://ghcr.io/drengskapur/charts/ghostwire \\\n  -f values-production.yaml \\\n  --version &lt;new&gt;\n</code></pre>"},{"location":"operations/upgrades/#signal-desktop-updates","title":"Signal Desktop Updates","text":"<p>Signal Desktop updates are delivered through the container image, not the Helm chart. Kasm rebuilds images when new Signal Desktop versions are released.</p> <p>To get the latest Signal Desktop: 1. Pull the latest image tag 2. Restart the pod</p> <pre><code>kubectl rollout restart statefulset ghostwire -n ghostwire\n</code></pre> <p>Signal Desktop also has in-app update notifications, but those may not work in the container environment depending on permissions.</p>"},{"location":"operations/upgrades/#maintenance-windows","title":"Maintenance Windows","text":"<p>For production deployments, schedule upgrades during low-usage periods:</p> <ul> <li>The pod restarts, terminating any active VNC session</li> <li>Users will need to reconnect after the upgrade</li> <li>Message delivery continues through Signal servers during the brief downtime</li> </ul> <p>Communicate planned maintenance to users if the service is shared.</p>"},{"location":"reference/changelog/","title":"Changelog","text":"<p>All notable changes to the Ghostwire Helm chart.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p> <p>For the full changelog, see CHANGELOG.md in the repository root.</p>"},{"location":"reference/changelog/#summary-of-changes","title":"Summary of Changes","text":"<p>This page provides an overview of changes. For detailed commit history and release notes, see the GitHub Releases page.</p>"},{"location":"reference/changelog/#upgrade-notes","title":"Upgrade Notes","text":"<p>When upgrading between versions, review:</p> <ol> <li>Breaking changes \u2014 Look for major version bumps or explicit breaking change notes</li> <li>Value changes \u2014 Compare your custom values against new defaults</li> <li>Deprecations \u2014 Update deprecated values before they're removed</li> </ol>"},{"location":"reference/changelog/#version-history","title":"Version History","text":"<p>Version history is maintained in the repository's CHANGELOG.md file, generated using git-cliff with conventional commits.</p>"},{"location":"reference/changelog/#recent-releases","title":"Recent Releases","text":"<p>See GitHub Releases for: - Release notes - Assets (chart packages) - Commit history since last release</p>"},{"location":"reference/changelog/#checking-installed-version","title":"Checking Installed Version","text":"<pre><code>helm list -n ghostwire\n</code></pre>"},{"location":"reference/changelog/#comparing-versions","title":"Comparing Versions","text":"<pre><code># Show available versions\nhelm search repo ghostwire --versions\n\n# Compare values between versions\nhelm show values ghostwire/ghostwire --version 1.0.0 &gt; v1.yaml\nhelm show values ghostwire/ghostwire --version 2.0.0 &gt; v2.yaml\ndiff v1.yaml v2.yaml\n</code></pre>"},{"location":"reference/values/","title":"Helm Values Reference","text":"<p>Complete reference for Ghostwire Helm chart values.</p>"},{"location":"reference/values/#global","title":"Global","text":"Value Type Default Description <code>nameOverride</code> string <code>\"\"</code> Override chart name <code>fullnameOverride</code> string <code>\"\"</code> Override fully qualified app name <code>global.imagePullSecrets</code> list <code>[]</code> Global Docker registry secret names"},{"location":"reference/values/#image","title":"Image","text":"Value Type Default Description <code>image.repository</code> string <code>kasmweb/signal</code> Container image repository <code>image.tag</code> string <code>1.18.0-rolling-daily</code> Image tag <code>image.pullPolicy</code> string <code>Always</code> Image pull policy <code>imagePullSecrets</code> list <code>[]</code> Pod-level image pull secrets"},{"location":"reference/values/#deployment","title":"Deployment","text":"Value Type Default Description <code>replicaCount</code> int <code>1</code> Number of replicas (must be 1)"},{"location":"reference/values/#service","title":"Service","text":"Value Type Default Description <code>service.type</code> string <code>ClusterIP</code> Service type <code>service.port</code> int <code>6901</code> Service port <code>service.targetPort</code> int <code>6901</code> Container target port <code>service.loadBalancerIP</code> string <code>\"\"</code> LoadBalancer IP (if type: LoadBalancer)"},{"location":"reference/values/#persistence","title":"Persistence","text":"Value Type Default Description <code>persistence.enabled</code> bool <code>true</code> Enable persistent storage <code>persistence.storageClass</code> string <code>\"\"</code> Storage class (empty = default) <code>persistence.accessMode</code> string <code>ReadWriteOnce</code> PVC access mode <code>persistence.size</code> string <code>10Gi</code> PVC size <code>persistence.mountPath</code> string <code>/home/kasm-user</code> Mount path in container"},{"location":"reference/values/#resources","title":"Resources","text":"Value Type Default Description <code>resources.requests.memory</code> string <code>2Gi</code> Memory request <code>resources.requests.cpu</code> string <code>500m</code> CPU request <code>resources.limits.memory</code> string <code>4Gi</code> Memory limit <code>resources.limits.cpu</code> string <code>2</code> CPU limit"},{"location":"reference/values/#probes","title":"Probes","text":"Value Type Default Description <code>livenessProbe.tcpSocket.port</code> int <code>6901</code> Liveness probe port <code>livenessProbe.initialDelaySeconds</code> int <code>60</code> Liveness initial delay <code>livenessProbe.periodSeconds</code> int <code>30</code> Liveness check period <code>livenessProbe.failureThreshold</code> int <code>3</code> Liveness failure threshold <code>readinessProbe.tcpSocket.port</code> int <code>6901</code> Readiness probe port <code>readinessProbe.initialDelaySeconds</code> int <code>30</code> Readiness initial delay <code>readinessProbe.periodSeconds</code> int <code>10</code> Readiness check period <code>readinessProbe.failureThreshold</code> int <code>5</code> Readiness failure threshold"},{"location":"reference/values/#security-context","title":"Security Context","text":"Value Type Default Description <code>securityContext.runAsNonRoot</code> bool <code>true</code> Run as non-root user <code>securityContext.runAsUser</code> int <code>1000</code> User ID <code>securityContext.runAsGroup</code> int <code>1000</code> Group ID"},{"location":"reference/values/#node-selection","title":"Node Selection","text":"Value Type Default Description <code>nodeSelector</code> object <code>{}</code> Node selector labels <code>tolerations</code> list <code>[]</code> Pod tolerations <code>affinity</code> object <code>{}</code> Pod affinity rules"},{"location":"reference/values/#environment","title":"Environment","text":"Value Type Default Description <code>env</code> list <code>[]</code> Additional environment variables <p>Example:</p> <pre><code>env:\n  - name: TZ\n    value: \"America/Los_Angeles\"\n  - name: VNC_RESOLUTION\n    value: \"1920x1080\"\n</code></pre>"},{"location":"reference/values/#pod-annotations","title":"Pod Annotations","text":"Value Type Default Description <code>podAnnotations</code> object <code>{}</code> Annotations for pods <p>Example:</p> <pre><code>podAnnotations:\n  linkerd.io/inject: enabled\n</code></pre>"},{"location":"reference/values/#service-account","title":"Service Account","text":"Value Type Default Description <code>serviceAccount.create</code> bool <code>true</code> Create service account <code>serviceAccount.name</code> string <code>\"\"</code> Service account name <code>serviceAccount.annotations</code> object <code>{}</code> Service account annotations"},{"location":"reference/values/#example-values-files","title":"Example Values Files","text":""},{"location":"reference/values/#minimal-production","title":"Minimal Production","text":"<pre><code>image:\n  tag: \"1.18.0\"\n  pullPolicy: IfNotPresent\n\npersistence:\n  size: 20Gi\n\nresources:\n  limits:\n    memory: 6Gi\n</code></pre>"},{"location":"reference/values/#with-oauth2-annotations","title":"With OAuth2 Annotations","text":"<pre><code>image:\n  tag: \"1.18.0\"\n  pullPolicy: IfNotPresent\n\npersistence:\n  size: 20Gi\n  storageClass: ssd-retain\n\nresources:\n  limits:\n    memory: 6Gi\n    cpu: 4\n\npodAnnotations:\n  prometheus.io/scrape: \"true\"\n\nenv:\n  - name: TZ\n    value: \"UTC\"\n</code></pre>"},{"location":"reference/values/#air-gapped-environment","title":"Air-Gapped Environment","text":"<pre><code>image:\n  repository: registry.internal/ghostwire/signal\n  tag: \"1.18.0\"\n  pullPolicy: IfNotPresent\n\nimagePullSecrets:\n  - name: registry-credentials\n\npersistence:\n  storageClass: local-path\n  size: 50Gi\n\nresources:\n  limits:\n    memory: 8Gi\n</code></pre>"},{"location":"reference/values/#json-schema","title":"JSON Schema","text":"<p>The chart includes <code>values.schema.json</code> for IDE autocompletion and validation. Compatible editors will provide inline documentation and error highlighting for invalid values.</p>"}]}