# Trivy Secret Scanning Configuration
# https://trivy.dev/latest/docs/scanner/secret/
#
# NOTE: This project primarily uses TruffleHog for secret scanning.
# This config is provided as a fallback/supplement for Trivy-specific secret detection.

# Global allow rules - patterns to exclude across all secret types
allow-rules:
  - id: global-allow
    description: "Allow example/test values in documentation"
    paths:
      - "**/*.md"              # Markdown files
      - "**/README*"            # README files
      - "**/docs/**"            # Documentation
      - "**/*.example"          # Example files
      - "**/*.template"         # Template files
      - "**/test/**"            # Test files
      - "**/tests/**"           # Test directories
      - "**/.example*"          # Example configs

# Enable only specific built-in rules (optional - remove to enable all)
# Uncomment and customize if you want to enable only specific checks
# enable-builtin-rules:
#   - aws-access-key-id
#   - aws-secret-access-key
#   - github-pat
#   - github-fine-grained-pat
#   - gitlab-pat
#   - docker-config-secret

# Disable specific built-in rules (optional)
# Uncomment to disable specific rules that cause false positives
# disable-rules:
#   - generic-api-key   # May be too broad

# Custom secret detection rules
# Add project-specific patterns here
rules:
  # Example: Detect custom API tokens
  # - id: custom-api-token
  #   category: general
  #   title: Custom API Token
  #   severity: HIGH
  #   regex: 'custom-api-[0-9a-f]{32}'
  #   keywords:
  #     - custom-api
  #   allow-rules:
  #     - id: test-tokens
  #       description: Allow test tokens
  #       regex: 'custom-api-test.*'

  # Example: Detect internal service keys
  # - id: internal-service-key
  #   category: general
  #   title: Internal Service Key
  #   severity: CRITICAL
  #   regex: 'INTERNAL_KEY_[A-Z0-9]{40}'
  #   path: ^(?!.*test).*$  # Exclude test files
